VYTAH/ORI                                                                                                     PAGE 1

                       1    $MOD51
                       2    $DEBUG
                       3    
                =1     4    $include (lift.inc)
                =1     5    ; adresy I/O portov, ktore pridu na port P2 89C52-ky
  0080          =1     6    i8255INA        equ     080h
  0081          =1     7    i8255INB        equ     081h
  0082          =1     8    i8255INC        equ     082h
  0083          =1     9    i8255INCW       equ     083h
  00C0          =1    10    i8255OUTA       equ     0c0h
  00C1          =1    11    i8255OUTB       equ     0c1h
  00C2          =1    12    i8255OUTC       equ     0c2h
  00C3          =1    13    i8255OUTCW      equ     0c3h
                =1    14    
  0028          =1    15    INPORTA         data    28h         ; nutne kvoli emulatoru!!!
  0021          =1    16    INPORTB         data    21h
  0022          =1    17    INPORTC         data    22h
  0023          =1    18    OUTPORTA        data    23h
  0024          =1    19    OUTPORTB        data    24h
  0025          =1    20    OUTPORTC        data    25h
  0026          =1    21    INPORTBold      data    26h
  0027          =1    22    CTRLREG         data    27h
                =1    23    
  0030          =1    24    POSITION        data    30h
  0031          =1    25    LOWEST          data    31h
  0032          =1    26    HIGHEST         data    32h
  0033          =1    27    STOPTIMER       data    33h
  0034          =1    28    OUTPORTBold     data    34h
                =1    29    
  0040          =1    30    STOPNOT         bit     INPORTA.0
  0041          =1    31    PKI1            bit     INPORTA.1
  0042          =1    32    PKI2            bit     INPORTA.2
  0043          =1    33    PKI3            bit     INPORTA.3
  0044          =1    34    PKI4            bit     INPORTA.4
  0045          =1    35    DOORCLSD        bit     INPORTA.5 
                =1    36    
  0009          =1    37    MB1             bit     INPORTB.1       ; clonky maju invertovanu logiku
  000A          =1    38    MB2             bit     INPORTB.2
  000B          =1    39    SKRH            bit     INPORTB.3
  000C          =1    40    SKRD            bit     INPORTB.4
  000D          =1    41    DP              bit     INPORTB.5
  000E          =1    42    DPZK            bit     INPORTB.6
  000F          =1    43    DPK             bit     INPORTB.7
                =1    44    
  0031          =1    45    MB1old          bit     INPORTBold.1
  0032          =1    46    MB2old          bit     INPORTBold.2
  0033          =1    47    SKRHold         bit     INPORTBold.3
  0034          =1    48    SKRDold         bit     INPORTBold.4
                =1    49    
  0010          =1    50    PI1             bit     INPORTC.0
  0011          =1    51    PI2D            bit     INPORTC.1
  0012          =1    52    PI2U            bit     INPORTC.2
  0013          =1    53    PI3D            bit     INPORTC.3
  0014          =1    54    PI3U            bit     INPORTC.4
  0015          =1    55    PI4             bit     INPORTC.5
                =1    56    
  0018          =1    57    KS              bit     OUTPORTA.0
  0019          =1    58    PKO1            bit     OUTPORTA.1
VYTAH/ORI/D                                                                                                  PAGE 2

  001A          =1    59    PKO2            bit     OUTPORTA.2
  001B          =1    60    PKO3            bit     OUTPORTA.3
  001C          =1    61    PKO4            bit     OUTPORTA.4
                =1    62    
  0020          =1    63    UP              bit     OUTPORTB.0
  0021          =1    64    DOWN            bit     OUTPORTB.1
  0022          =1    65    FAST            bit     OUTPORTB.2
  0023          =1    66    SLOW            bit     OUTPORTB.3
  0024          =1    67    FLED1           bit     OUTPORTB.4
  0025          =1    68    FLED2           bit     OUTPORTB.5
  0026          =1    69    FLED3           bit     OUTPORTB.6
  0027          =1    70    FLED4           bit     OUTPORTB.7
                =1    71    
  0028          =1    72    PO1             bit     OUTPORTC.0
  0029          =1    73    PO2D            bit     OUTPORTC.1
  002A          =1    74    PO2U            bit     OUTPORTC.2
  002B          =1    75    PO3D            bit     OUTPORTC.3
  002C          =1    76    PO3U            bit     OUTPORTC.4
  002D          =1    77    PO4             bit     OUTPORTC.5
  002E          =1    78    LEDD            bit     OUTPORTC.6
  002F          =1    79    LEDU            bit     OUTPORTC.7
                =1    80    
  0038          =1    81    CANGO           bit     CTRLREG.0
  0039          =1    82    DOORCLSDold     bit     CTRLREG.1
  003A          =1    83    UPold           bit     CTRLREG.2
  003B          =1    84    DOWNold         bit     CTRLREG.3
  003C          =1    85    FASTold         bit     CTRLREG.4
  003D          =1    86    SLOWold         bit     CTRLREG.5
                =1    87    
  00B6          =1    88    WRNOT           bit     0b6h        ; p3.6
  00B7          =1    89    RDNOT           bit     0b7h        ; p3.7
                =1    90    
                =1    91    ; bitove masky
                =1    92    ; 8255OUT 
                =1    93    ; port A
  0001          =1    94    bmKS              equ    00000001b
  0002          =1    95    bmPKO1            equ    00000010b
  0004          =1    96    bmPKO2            equ    00000100b
  0008          =1    97    bmPKO3            equ    00001000b
  0010          =1    98    bmPKO4            equ    00010000b
                =1    99    
                =1   100    ; port B
  0001          =1   101    bmUP              equ    00000001b
  0002          =1   102    bmDOWN            equ    00000010b
  0004          =1   103    bmFAST            equ    00000100b
  0008          =1   104    bmSLOW            equ    00001000b
  0010          =1   105    bmFLED1           equ    00010000b
  0020          =1   106    bmFLED2           equ    00100000b
  0040          =1   107    bmFLED3           equ    01000000b
  0080          =1   108    bmFLED4           equ    10000000b
                =1   109    
                =1   110    ; port C
  0001          =1   111    bmPO1             equ    00000001b
  0002          =1   112    bmPO2D            equ    00000010b
  0004          =1   113    bmPO2U            equ    00000100b
  0008          =1   114    bmPO3D            equ    00001000b
  0010          =1   115    bmPO3U            equ    00010000b
  0020          =1   116    bmPO4             equ    00100000b
VYTAH/ORI/D                                                                                                  PAGE 3

  0040          =1   117    bmLEDD            equ    01000000b
  0080          =1   118    bmLEDU            equ    10000000b
                =1   119    
                =1   120    ; 8255IN
                =1   121    ; port A
  0001          =1   122    bmSTOP            equ    00000001b
  0002          =1   123    bmPKI1            equ    00000010b
  0004          =1   124    bmPKI2            equ    00000100b
  0008          =1   125    bmPKI3            equ    00001000b
  0010          =1   126    bmPKI4            equ    00010000b
  0020          =1   127    bmDOORCLSD        equ    00100000b
                =1   128    
                =1   129    ; port B
  0002          =1   130    bmMB1I            equ    00000010b
  0004          =1   131    bmMB2I            equ    00000100b
  0008          =1   132    bmSKRHI           equ    00001000b
  0010          =1   133    bmSKRHD           equ    00010000b
  0020          =1   134    bmDPI             equ    00100000b
  0040          =1   135    bmDPZKI           equ    01000000b
  0080          =1   136    bmDPKI            equ    10000000b
                =1   137    
                =1   138    ; port C
  0001          =1   139    bmPI1             equ    00000001b
  0002          =1   140    bmPI2D            equ    00000010b
  0004          =1   141    bmPI2U            equ    00000100b
  0008          =1   142    bmPI3D            equ    00001000b
  0010          =1   143    bmPI3U            equ    00010000b
  0020          =1   144    bmPI4             equ    00100000b
                =1   145    
                     146    
                     147    _BP_    MACRO 
                     148            clr     P3.3
                     149            setb    EX1
                     150            nop
                     151            nop
                     152    ENDM
                     153    
                     154    LJZ     MACRO   NAVESTIE
                     155            jnz     $+5
                     156            ljmp    NAVESTIE
                     157            nop
                     158    ENDM
                     159    
                     160    LJNZ    MACRO   NAVESTIE
                     161            jz      $+5
                     162            ljmp    NAVESTIE
                     163            nop
                     164    ENDM
                     165    
                     166    LJB     MACRO   TESTBIT, NAVESTIE
                     167            jnb     TESTBIT, $+5
                     168            ljmp    NAVESTIE
                     169            nop
                     170    ENDM
                     171    
                     172    LJNB    MACRO   TESTBIT, NAVESTIE
                     173            jb      TESTBIT, $+5
                     174            ljmp    NAVESTIE
VYTAH/ORI/D                                                                                                  PAGE 4

                     175            nop
                     176    ENDM
                     177    
                     178    POLOHA_LED  MACRO  POLOHA
                     179            clr     LEDU            
                     180            clr     LEDD 
                     181            clr     FLED1             
                     182            clr     FLED2                
                     183            clr     FLED3           
                     184            clr     FLED4           
                     185            setb    FLED&POLOHA
                     186            lcall   WRITEPORTS
                     187    ENDM
                     188    
  0036               189    FLOORREQ        data    36h
                     190    
                     191    ; hodiny oscilatora v emulatore treba dat na ext a nastavit 11.0592MHz
  00FA               192    TIMERCONST      equ     250     ; udaj pre nastavenie casovaca pre potreby seriovej komunika
                                                                               cie
                     193                                    ; hodnota 250 znamena prenosovu rychlost 4800 baud pri oscil
                                                                               atore 11.0592MHz
                     194                                    ; nastavenie terminalu je 4800 8-N-1, no flow control
                     195    ;osetrenie vektorov preruseni
0000                 196            org     0000h           ; adresa odkial startuje program po resete
0000 020033          197            ljmp    START           ; skok na zaciatok kodu programu
                     198                  
0033                 199            org     0033h           ; od tejto adresy sa zacina kod programu
0033                 200    START:
0033                 201    RESET:  
                     202            ; riadiace signaly do pasivnej urovne 
0033 D2B6            203            setb    WRNOT
0035 D2B7            204            setb    RDNOT
0037 753300          205            mov     STOPTIMER, #0
003A 758140          206            mov     SP, #STACK
                     207    
                     208            ; pockame si na inicializaciu obvodov 8255  
003D 7900            209            mov     R1, #0 
003F 7AFF            210            mov     R2, #0ffh
0041 D9FE            211            djnz    R1, $
0043 DAFC            212            djnz    R2, $-2
                     213            
                     214            ; teraz ich mozeme nastavit
0045 75809B          215            mov     p0, #10011011b      ; nastavenie i8255IN - vsetky porty dnu
0048 75A083          216            mov     p2, #i8255INCW
004B C2B6            217            clr     WRNOT
004D 00              218            nop
004E 00              219            nop
004F 00              220            nop
0050 00              221            nop
0051 D2B6            222            setb    WRNOT
0053 758080          223            mov     p0, #10000000b      ; nastavenie i8255OUT - vsetky porty von
0056 75A0C3          224            mov     p2, #i8255OUTCW
0059 C2B6            225            clr     WRNOT
005B 00              226            nop
005C 00              227            nop
005D 00              228            nop
005E 00              229            nop
005F D2B6            230            setb    WRNOT
VYTAH/ORI.D                                                                                                  PAGE 5

                     231            
                     232 +1         _BP_
0061 C2B3            233 +1         clr     P3.3
0063 D2AA            234 +1         setb    EX1
0065 00              235 +1         nop
0066 00              236 +1         nop
                     238    
                     239            ; pociatocna inicializacia - vynuluj vstupne registre a rozsviet vsetky diody 
0067 752800          240            mov     INPORTA, #0
006A 75211E          241            mov     INPORTB, #01eh      ; vsetky clonky pasivne
006D 752200          242            mov     INPORTC, #0
0070 75231E          243            mov     OUTPORTA, #(bmPKO1 or bmPKO2 or bmPKO3 or bmPKO4)
0073 7524F0          244            mov     OUTPORTB, #(bmFLED1 or bmFLED2 or bmFLED3 or bmFLED4)
0076 7525FF          245            mov     OUTPORTC, #(bmPO1 or bmPO2D or bmPO2U or bmPO3D or bmPO3U or bmPO4 or bmLEDD
                                                                                or bmLEDU)
0079 D218            246            setb    KS
007B 120589          247            call    WRITEPORTS          ; zapis novu informaciu
                     248    ;;;;;;;;
                     249    
007E 752300          250            mov     OUTPORTA, #0
0081 752400          251            mov     OUTPORTB, #0
0084 752500          252            mov     OUTPORTC, #0
0087 120589          253            call    WRITEPORTS          ; zapis novu informaciu
                     254    
008A 752800          255            mov     INPORTA, #0
008D 752100          256            mov     INPORTB, #0         
0090 752200          257            mov     INPORTC, #0
0093 120544          258            call    READPORTS           ; prvotne nacitanie udajov
                     259    
0096                 260    CALIB:
                     261            ;kalibracia vytahu podla dolnej porovnavacej clonky
0096 120544          262            lcall   READPORTS                   ; precitaj, co je na portoch
0099 300C11          263            jnb     SKRD, CALIBEND              ; ak sme na dolnej porovnavacej clonke, tak koni
                                                                               ec
009C D221            264            setb    DOWN                        ; inak pod dole
009E D222            265            setb    FAST                        ; a rychlo
00A0 C223            266            clr     SLOW                        ;
00A2 120589          267            lcall   WRITEPORTS                  ; zapis informaciu 
00A5                 268    CALIBLOOP:
00A5 120544          269            lcall   READPORTS                   ; 
00A8 300C02          270            jnb     SKRD, CALIBEND              ; ak sme dole, konci
                     271            ;jnb     MB2, CALIBEND               ; ak sme na poschodi, konci
00AB 80F8            272            jmp     CALIBLOOP
00AD                 273    CALIBEND:
00AD 753600          274            mov     FLOORREQ, #0                                
00B0 C222            275            clr     FAST                        ; stojime
00B2 C221            276            clr     DOWN                        ;
00B4 D224            277            setb    FLED1
00B6 120589          278            lcall   WRITEPORTS                  ; zapis informaciu
                     279 +1         _BP_
00B9 C2B3            280 +1         clr     P3.3
00BB D2AA            281 +1         setb    EX1
00BD 00              282 +1         nop
00BE 00              283 +1         nop
00BF                 285    MAIN:
                     286    
                     287    ;            |  7    |  6    |  5    |  4    |  3    |  2    |  1    |  0    |
                     288    ; ****************************************************************************
VYTAH/ORI                                                                                                     PAGE 6

                     289    ; INPORTA >  |       |       |DOORCLS| PKI4  | PKI3  | PKI2  | PKI1  |STOPNOT|
                     290    ; ----------------------------------------------------------------------------
                     291    ; INPORTB >  | DPK   | DPZK  | DP    | SKRD  | SKRH  | MB2   | MB1   |       |
                     292    ; ----------------------------------------------------------------------------
                     293    ; INPORTC >  |       |       | PI4   | PI3D  | PI3U  | PI2D  | PI2U  | PI1   |
                     294    ; ****************************************************************************
                     295    ; OUTPORTA > |       |       |       | PKO4  | PKO3  | PKO2  | PKO1  | KS    |
                     296    ; ----------------------------------------------------------------------------
                     297    ; OUTPORTB > | FLED4 | FLED3 | FLED2 | FLED1 | SLOW  | FAST  | DOWN  | UP    |
                     298    ; ----------------------------------------------------------------------------
                     299    ; OUTPORTC > | LEDU  | LEDD  | PO4   | PO3D  | PO3U  | PO2D  | PO2U  | PO1   |
                     300    ; ****************************************************************************
                     301    ; POSITION
                     302    ; ****************************************************************************
                     303    
                     304    
                     305    ;------------------------------------------------------------------------------- << 1. posch
                                                                               odie >>
                     306    
00BF                 307    FLOOR1:
                     308 +1                 POLOHA_LED 1  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
00BF C22F            309 +1         clr     LEDU            
00C1 C22E            310 +1         clr     LEDD 
00C3 C224            311 +1         clr     FLED1             
00C5 C225            312 +1         clr     FLED2                
00C7 C226            313 +1         clr     FLED3           
00C9 C227            314 +1         clr     FLED4           
00CB D224            315 +1         setb    FLED1
00CD 120589          316 +1         lcall   WRITEPORTS
00D0 120533          318            lcall   WAITFORTIMER    ; simulacia TIMERu
00D3 120544          319    F1S:    lcall   READPORTS     ;-; nacitanie dat
00D6 C219            320            clr     PKO1          ;-; vynulovanie volby poschodia na ktorom stojim
00D8 120589          321            lcall   WRITEPORTS      ;
00DB E528            322            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
00DD 541C            323            anl     A, #00011100b ;-;
00DF 60F2            324            jz      F1S           ;-; ak nie, opakuj
00E1 D220            325            setb    UP              ; rychly pohyb hore
00E3 D222            326            setb    FAST            ; 
00E5 C223            327            clr     SLOW            ;
00E7 120589          328            lcall   WRITEPORTS      ; 
00EA 0200ED          329            jmp     UP1           ;-; prejdi do stavu UP1
00ED                 330    UP1:
                     331 +1                 POLOHA_LED 1  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
00ED C22F            332 +1         clr     LEDU            
00EF C22E            333 +1         clr     LEDD 
00F1 C224            334 +1         clr     FLED1             
00F3 C225            335 +1         clr     FLED2                
00F5 C226            336 +1         clr     FLED3           
00F7 C227            337 +1         clr     FLED4           
00F9 D224            338 +1         setb    FLED1
00FB 120589          339 +1         lcall   WRITEPORTS
00FE 120544          341            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0101 3009FA          342            jnb     MB1, $-3        ;  |
0104 120544          343    UP1A:   lcall   READPORTS       ; nacitanie dat
                     344 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
VYTAH/ORIWDò&©4ú&©4                                                                                          PAGE 7

0107 200B02          345 +1         jb      SKRH, $+5
010A 02050F          346 +1         ljmp    ERR_SKRH
010D 00              347 +1         nop
                     349    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
010E 200AF3          350            jb      MB2, UP1A     ;-; mame uz 1. spomalovaciu clonku?
0111 120544          351            lcall   READPORTS       ; ak ano, sme z nej uz prec?
0114 300AFA          352            jnb     MB2, $-3        ;       
0117 D22E            353            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0119 120589          354            lcall   WRITEPORTS      ;
011C 02011F          355            jmp     UP1_MB2       ;-; a prejdi do stavu UP1_MB2
011F                 356    UP1_MB2:
011F 120544          357            lcall   READPORTS       ; nacitanie dat
                     358 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0122 200B02          359 +1         jb      SKRH, $+5
0125 02050F          360 +1         ljmp    ERR_SKRH
0128 00              361 +1         nop
                     363 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
0129 200902          364 +1         jb      MB1, $+5
012C 0204D3          365 +1         ljmp    ERR_1SPOM_C
012F 00              366 +1         nop
0130 200AEC          368            jb      MB2, UP1_MB2  ;-; mame uz aj druhu spomalovaciu clonku?     
0133 D22F            369            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
0135 120589          370            lcall   WRITEPORTS      ;   
0138 E528            371            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
013A 5404            372            anl     A, #00000100b ;-;
013C 600A            373            jz      UP1_MB1       ;-;       Ak nie, chod do stavu UP1_MB1
013E D223            374            setb    SLOW            ;       Ak ano, spomalme
0140 C222            375            clr     FAST            ; 
0142 120589          376            lcall   WRITEPORTS      ;         
0145 020148          377            jmp     UP1_MB1       ;-; a prejdi do stavu UP1_MB1 
0148                 378    UP1_MB1:
0148 120544          379            lcall   READPORTS       ; nacitanie dat
                     380 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
014B 200B02          381 +1         jb      SKRH, $+5
014E 02050F          382 +1         ljmp    ERR_SKRH
0151 00              383 +1         nop
                     385 +1         ljnb    MB2, ERR_ZAST_C ; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na spo
                                                                               malovaciu) <<<
0152 200A02          386 +1         jb      MB2, $+5
0155 0204F1          387 +1         ljmp    ERR_ZAST_C
0158 00              388 +1         nop
0159 2009EC          390            jb      MB1, UP1_MB1  ;-; Sme na zastavovacej clonke?
015C E528            391            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
015E 5404            392            anl     A, #00000100b ;-;
0160 606D            393            jz      UP2           ;-; Ak nie, chod do stavu UP2
0162 C220            394            clr     UP              ; zastav motor
0164 D23A            395            setb    UPOld           ;       (a zalohuj) 
0166 C23B            396            clr     DOWNOld         ;       (a zalohuj)
0168 C222            397            clr     FAST            ; 
016A 120589          398            lcall   WRITEPORTS      ; 
016D 020170          399            jmp     FLOOR2        ;-; a prejdi do stavu FLOOR2
                     400    
                     401    ;------------------------------------------------------------------------------- << 2. posch
                                                                               odie >>
                     402    
0170                 403    FLOOR2:
VYTAH/ORI=D¾(©4                                                                                              PAGE 8

                     404 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0170 C22F            405 +1         clr     LEDU            
0172 C22E            406 +1         clr     LEDD 
0174 C224            407 +1         clr     FLED1             
0176 C225            408 +1         clr     FLED2                
0178 C226            409 +1         clr     FLED3           
017A C227            410 +1         clr     FLED4           
017C D225            411 +1         setb    FLED2
017E 120589          412 +1         lcall   WRITEPORTS
0181 120533          414            lcall   WAITFORTIMER    ; simulacia TIMERu
0184 120544          415    F2S:    lcall   READPORTS     ;-; nacitanie dat
0187 C21A            416            clr     PKO2          ;-; vynulovanie volby poschodia na ktorom stojim
0189 120589          417            lcall   WRITEPORTS      ;
                     418            
018C 7418            419            mov     A, #00011000b ;-; Default predpokladam, ze mam namierene hore (na 3. a 4.)
018E 203A01          420            jb      UPOld, F2OK     ;   Je to pravda? Naozaj som doteraz isiel hore?
0191 F4              421            cpl     A               ;       Ak nie, znegujeme
0192 F5F0            422    F2OK:   mov     B, A            ; Masku dame do Bcka
                     423            
                     424            ; Pohyb v jednom smere (nevieme v ktorom)
0194 53F01A          425            anl     B, #00011010b  ;-; este ju kozmeticky upravime
0197 E528            426            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
0199 55F0            427            anl     A, B            ; tu ju pouzijeme       
019B 7014            428            jnz     F2              ; nasli sme poschodie v tomto smere
                     429            ; Pohyb v opacnom smere (nevieme v ktorom)
019D B23A            430            cpl     UPOld           ;  Znegujem stary posun
019F B23B            431            cpl     DOWNOld         ;  |
01A1 E5F0            432            mov     A, B            ;  Znegujeme masku
01A3 F4              433            cpl     A               ;  |
01A4 F5F0            434            mov     B, A            ;  |
01A6 53F01A          435            anl     B, #00011010b  ;-; este ju kozmeticky upravime
01A9 E528            436            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
01AB 55F0            437            anl     A, B            ; tu ju pouzijeme       
01AD 7002            438            jnz     F2              ; nasli sme poschodie v tomto smere
                     439            
01AF 80D3            440            jmp     F2S           ;-; nemame sa kde hybat, tak opakujeme zistovanie
01B1 203A03          441    F2:     jb      UPOld, F2UP     ;   
01B4 0201C3          442            jmp     F2DOWN          ;
01B7 D220            443    F2UP:   setb    UP              ; rychly pohyb hore
01B9 D222            444            setb    FAST            ; 
01BB C223            445            clr     SLOW            ;
01BD 120589          446            lcall   WRITEPORTS      ; 
01C0 0201CF          447            jmp     UP2           ;-; prejdi do stavu UP2    
01C3 D221            448    F2DOWN: setb    DOWN            ; rychly pohyb hore
01C5 D222            449            setb    FAST            ; 
01C7 C223            450            clr     SLOW            ;
01C9 120589          451            lcall   WRITEPORTS      ; 
01CC 020255          452            jmp     DOWN2         ;-; prejdi do stavu UP2    
                     453            
                     454                
01CF                 455    UP2:
                     456 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
01CF C22F            457 +1         clr     LEDU            
01D1 C22E            458 +1         clr     LEDD 
VYTAH/ORI""D
)©4                                                                                              PAGE 9

01D3 C224            459 +1         clr     FLED1             
01D5 C225            460 +1         clr     FLED2                
01D7 C226            461 +1         clr     FLED3           
01D9 C227            462 +1         clr     FLED4           
01DB D225            463 +1         setb    FLED2
01DD 120589          464 +1         lcall   WRITEPORTS
01E0 120544          466            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
01E3 3009FA          467            jnb     MB1, $-3        ;  |
01E6 120544          468    UP2A:   lcall   READPORTS       ; nacitanie dat
                     469 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
01E9 200B02          470 +1         jb      SKRH, $+5
01EC 02050F          471 +1         ljmp    ERR_SKRH
01EF 00              472 +1         nop
                     474    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
01F0 200AF3          475            jb      MB2, UP2A     ;-; mame uz 1. spomalovaciu clonku?
01F3 120544          476            lcall   READPORTS       ; ak ano, sme z nej uz prec?
01F6 300AFA          477            jnb     MB2, $-3        ;       
01F9 D22E            478            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
01FB 120589          479            lcall   WRITEPORTS      ;
01FE 020201          480            jmp     UP2_MB2       ;-; a prejdi do stavu UP2_MB2
0201                 481    UP2_MB2:
0201 120544          482            lcall   READPORTS       ; nacitanie dat
                     483 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0204 200B02          484 +1         jb      SKRH, $+5
0207 02050F          485 +1         ljmp    ERR_SKRH
020A 00              486 +1         nop
                     488 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
020B 200902          489 +1         jb      MB1, $+5
020E 0204D3          490 +1         ljmp    ERR_1SPOM_C
0211 00              491 +1         nop
0212 200AEC          493            jb      MB2, UP2_MB2  ;-; mame uz aj druhu spomalovaciu clonku?          
0215 D22F            494            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
0217 120589          495            lcall   WRITEPORTS      ;
021A E528            496            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
021C 5408            497            anl     A, #00001000b ;-;
021E 600A            498            jz      UP2_MB1       ;-;       Ak nie, chod do stavu UP2_MB1
0220 D223            499            setb    SLOW            ;       Ak ano, spomalme
0222 C222            500            clr     FAST            ; 
0224 120589          501            lcall   WRITEPORTS      ;
0227 02022A          502            jmp     UP2_MB1       ;-; a prejdi do stavu UP2_MB1 
022A                 503    UP2_MB1:
022A 120544          504            lcall   READPORTS       ; nacitanie dat
                     505 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
022D 200B02          506 +1         jb      SKRH, $+5
0230 02050F          507 +1         ljmp    ERR_SKRH
0233 00              508 +1         nop
                     510 +1         ljnb    MB2, ERR_ZAST_C ; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na spo
                                                                               malovaciu) <<<
0234 200A02          511 +1         jb      MB2, $+5
0237 0204F1          512 +1         ljmp    ERR_ZAST_C
023A 00              513 +1         nop
023B 2009EC          515            jb      MB1, UP2_MB1  ;-; Sme na zastavovacej clonke?
023E E528            516            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
0240 5408            517            anl     A, #00001000b ;-;
0242 7003            518            jnz     U2_MB1C       ;-; Ak nie, chod do stavu UP3
0244 020327          519            ljmp    UP3             ; |
VYTAH/ORI DÆ*©4Ì*©4                                                                                          PAGE 10

0247 C220            520    U2_MB1C:clr     UP              ; zastav motor
0249 D23A            521            setb    UPOld           ;       (a zalohuj)
024B C23B            522            clr     DOWNOld         ;       (a zalohuj)
024D C222            523            clr     FAST            ; 
024F 120589          524            lcall   WRITEPORTS      ; 
0252 0202C8          525            jmp     FLOOR3        ;-; a prejdi do stavu FLOOR3
0255                 526    DOWN2:
                     527 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0255 C22F            528 +1         clr     LEDU            
0257 C22E            529 +1         clr     LEDD 
0259 C224            530 +1         clr     FLED1             
025B C225            531 +1         clr     FLED2                
025D C226            532 +1         clr     FLED3           
025F C227            533 +1         clr     FLED4           
0261 D225            534 +1         setb    FLED2
0263 120589          535 +1         lcall   WRITEPORTS
0266 120544          537            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0269 3009FA          538            jnb     MB1, $-3        ;  |
026C 120544          539            lcall   READPORTS       ; nacitanie dat
                     540 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
026F 200C02          541 +1         jb      SKRD, $+5
0272 020500          542 +1         ljmp    ERR_SKRD
0275 00              543 +1         nop
                     545    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
0276 200ADC          546            jb      MB2, DOWN2    ;-; mame uz 1. spomalovaciu clonku?
0279 120544          547            lcall   READPORTS       ; ak ano, sme z nej uz prec?
027C 300AFA          548            jnb     MB2, $-3        ;       
027F D22F            549            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0281 120589          550            lcall   WRITEPORTS      ;
0284 020287          551            jmp     DOWN2_MB2     ;-; a prejdi do stavu DOWN2_MB2
0287                 552    DOWN2_MB2:
0287 120544          553            lcall   READPORTS       ; nacitanie dat
                     554 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
028A 200C02          555 +1         jb      SKRD, $+5
028D 020500          556 +1         ljmp    ERR_SKRD
0290 00              557 +1         nop
                     559 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
0291 200902          560 +1         jb      MB1, $+5
0294 0204D3          561 +1         ljmp    ERR_1SPOM_C
0297 00              562 +1         nop
0298 200AEC          564            jb      MB2, DOWN2_MB2;-; mame uz aj druhu spomalovaciu clonku?          
029B D22E            565            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
029D 120589          566            lcall   WRITEPORTS      ;
02A0 E528            567            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
02A2 5402            568            anl     A, #00000010b ;-;
02A4 600A            569            jz      DOWN2_MB1     ;-;       Ak nie, chod do stavu DOWN2_MB1
02A6 D223            570            setb    SLOW            ;       Ak ano, spomalme
02A8 C222            571            clr     FAST            ; 
02AA 120589          572            lcall   WRITEPORTS      ;
02AD 0202B0          573            jmp     DOWN2_MB1     ;-; a prejdi do stavu DOWN2_MB1
02B0                 574    DOWN2_MB1:    
02B0 120544          575            lcall   READPORTS       ; nacitanie dat
02B3 300C05          576            jnb     SKRD, D2_MB1C   ; Sme na hornej porovnavacej clonke?
02B6 300902          577            jnb     MB1, D2_MB1C  ;-; Sme na zastavovacej clonke?
02B9 80F5            578            jmp     DOWN2_MB1       ; Ak sme nechytili ani jednu clonku, opakujeme
VYTAH/ORI 
D&,©4,,©4                                                                                          PAGE 11

02BB C221            579    D2_MB1C:clr     DOWN            ; zastav motor
02BD D23B            580            setb    DOWNOld         ;       (a zalohuj)
02BF C23A            581            clr     UPOld           ;       (a zalohuj)
02C1 C222            582            clr     FAST            ; 
02C3 120589          583            lcall   WRITEPORTS      ; 
02C6 01BF            584            jmp     FLOOR1        ;-; a prejdi do stavu FLOOR2      
                     585    
                     586    
                     587    ;------------------------------------------------------------------------------- << 3. posch
                                                                               odie >>
                     588    
02C8                 589    FLOOR3:
                     590 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
02C8 C22F            591 +1         clr     LEDU            
02CA C22E            592 +1         clr     LEDD 
02CC C224            593 +1         clr     FLED1             
02CE C225            594 +1         clr     FLED2                
02D0 C226            595 +1         clr     FLED3           
02D2 C227            596 +1         clr     FLED4           
02D4 D226            597 +1         setb    FLED3
02D6 120589          598 +1         lcall   WRITEPORTS
02D9 120533          600            lcall   WAITFORTIMER    ; simulacia TIMERu
02DC 120544          601    F3S:    lcall   READPORTS     ;-; nacitanie dat
02DF C21B            602            clr     PKO3          ;-; vynulovanie volby poschodia na ktorom stojim
02E1 120589          603            lcall   WRITEPORTS      ;
                     604    
02E4 7410            605            mov     A, #00010000b ;-; Default predpokladam, ze idem hore (na 4.)
02E6 203A01          606            jb      UPOld, F3OK   ;-;   Je to pravda? Naozaj idem hore?
02E9 F4              607            cpl     A               ;       Ak nie, znegujeme
02EA F5F0            608    F3OK:   mov     B, A            ; Masku dame do Bcka
                     609            
                     610            ; Pohyb v jednom smere (nevieme v ktorom)
02EC 53F016          611            anl     B, #00010110b  ;-; este ju kozmeticky upravime
02EF E528            612            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
02F1 55F0            613            anl     A, B            ; tu ju pouzijeme       
02F3 7014            614            jnz     F3              ; nasli sme poschodie v tomto smere
                     615            ; Pohyb v opacnom smere (nevieme v ktorom)
02F5 B23A            616            cpl     UPOld           ;  Znegujem stary posun
02F7 B23B            617            cpl     DOWNOld         ;  |
02F9 E5F0            618            mov     A, B            ;  Znegujeme masku
02FB F4              619            cpl     A               ;  |
02FC F5F0            620            mov     B, A            ;  |
02FE 53F016          621            anl     B, #00010110b  ;-; este ju kozmeticky upravime
0301 E528            622            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
0303 55F0            623            anl     A, B            ; tu ju pouzijeme       
0305 7002            624            jnz     F3              ; nasli sme poschodie v tomto smere
                     625            
0307 80D3            626            jmp     F3S           ;-; nemame sa kde hybat, tak opakujeme zistovanie
0309 203A03          627    F3:     jb      UPOld, F3UP     ;   
030C 02031B          628            jmp     F3DOWN          ;
030F D220            629    F3UP:   setb    UP              ; rychly pohyb hore
0311 D222            630            setb    FAST            ; 
0313 C223            631            clr     SLOW            ;
0315 120589          632            lcall   WRITEPORTS      ; 
0318 020327          633            jmp     UP3           ;-; prejdi do stavu UP2    
VYTAH/ORI jD‚,©4                                                                                              PAGE 12

031B D221            634    F3DOWN: setb    DOWN            ; rychly pohyb hore
031D D222            635            setb    FAST            ; 
031F C223            636            clr     SLOW            ;
0321 120589          637            lcall   WRITEPORTS      ; 
0324 02039B          638            jmp     DOWN3         ;-; prejdi do stavu UP2    
                     639    
                     640            
                     641            
                     642            
                     643    ;        mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na kto
                                                                               rom stojim
                     644    ;        anl     A, #00010000b ;-;
                     645    ;        jz      F3S           ;-; ak nie, opakuj
                     646    ;        setb    UP              ; rychly pohyb hore
                     647    ;        setb    FAST            ; 
                     648    ;        lcall   WRITEPORTS      ; 
                     649    ;        jmp     UP3           ;-; prejdi do stavu UP3        
0327                 650    UP3:
                     651 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0327 C22F            652 +1         clr     LEDU            
0329 C22E            653 +1         clr     LEDD 
032B C224            654 +1         clr     FLED1             
032D C225            655 +1         clr     FLED2                
032F C226            656 +1         clr     FLED3           
0331 C227            657 +1         clr     FLED4           
0333 D226            658 +1         setb    FLED3
0335 120589          659 +1         lcall   WRITEPORTS
0338 120544          661            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
033B 3009FA          662            jnb     MB1, $-3        ;  |
033E 120544          663    UP3A:   lcall   READPORTS       ; nacitanie dat
                     664 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0341 200B02          665 +1         jb      SKRH, $+5
0344 02050F          666 +1         ljmp    ERR_SKRH
0347 00              667 +1         nop
                     669    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
0348 200AF3          670            jb      MB2, UP3A     ;-; mame uz 1. spomalovaciu clonku?
034B 120544          671            lcall   READPORTS       ; ak ano, sme z nej uz prec?
034E 300AFA          672            jnb     MB2, $-3        ;       
0351 D22E            673            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0353 120589          674            lcall   WRITEPORTS      ;
0356 020359          675            jmp     UP3_MB2       ;-; a prejdi do stavu UP3_MB2
0359                 676    UP3_MB2:
0359 120544          677            lcall   READPORTS       ; nacitanie dat
                     678 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
035C 200B02          679 +1         jb      SKRH, $+5
035F 02050F          680 +1         ljmp    ERR_SKRH
0362 00              681 +1         nop
                     683 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
0363 200902          684 +1         jb      MB1, $+5
0366 0204D3          685 +1         ljmp    ERR_1SPOM_C
0369 00              686 +1         nop
036A 200AEC          688            jb      MB2, UP3_MB2  ;-; mame uz aj druhu spomalovaciu clonku?          
036D D22F            689            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
036F 120589          690            lcall   WRITEPORTS      ;
0372 E528            691            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
VYTAH/ORICDÒ-©4Ø-©4                                                                                          PAGE 13

0374 5410            692            anl     A, #00010000b ;-;
0376 600A            693            jz      UP3_MB1       ;-;       Ak nie, chod do stavu UP3_MB1
0378 D223            694            setb    SLOW            ;       Ak ano, spomalme
037A C222            695            clr     FAST            ; 
037C 120589          696            lcall   WRITEPORTS      ;
037F 020382          697            jmp     UP3_MB1       ;-; a prejdi do stavu UP3_MB1 
0382                 698    UP3_MB1:
0382 120544          699            lcall   READPORTS       ; nacitanie dat
                     700    ;        ljnb    MB2, ERR_ZAST_C; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na spo
                                                                               malovaciu) <<<
0385 300B05          701            jnb     SKRH, U3_MB1C  ;  Sme na hornej porovnavacej clonke? (tu zastavujeme v kazdo
                                                                               m pripade)
0388 300902          702            jnb     MB1, U3_MB1C  ;-; Sme na zastavovacej clonke? (tu zastavujeme v kazdom pripa
                                                                               de)
038B 80F5            703            jmp     UP3_MB1         ; Ak sme nechytili ani jednu clonku, opakujeme. 
038D C220            704    U3_MB1C:clr     UP              ; zastav motor
038F D23A            705            setb    UPOld           ;       (a zalohuj)
0391 C23B            706            clr     DOWNOld         ;       (a zalohuj)
0393 C222            707            clr     FAST            ; 
0395 120589          708            lcall   WRITEPORTS      ; 
0398 020420          709            jmp     FLOOR4        ;-; a prejdi do stavu FLOOR4   
039B                 710    DOWN3:
                     711 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
039B C22F            712 +1         clr     LEDU            
039D C22E            713 +1         clr     LEDD 
039F C224            714 +1         clr     FLED1             
03A1 C225            715 +1         clr     FLED2                
03A3 C226            716 +1         clr     FLED3           
03A5 C227            717 +1         clr     FLED4           
03A7 D226            718 +1         setb    FLED3
03A9 120589          719 +1         lcall   WRITEPORTS
03AC 120544          721            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
03AF 3009FA          722            jnb     MB1, $-3        ;  |
03B2 120544          723            lcall   READPORTS       ; nacitanie dat
                     724 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
03B5 200C02          725 +1         jb      SKRD, $+5
03B8 020500          726 +1         ljmp    ERR_SKRD
03BB 00              727 +1         nop
                     729    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
03BC 200ADC          730            jb      MB2, DOWN3    ;-; mame uz 1. spomalovaciu clonku?
03BF 120544          731            lcall   READPORTS       ; ak ano, sme z nej uz prec?
03C2 300AFA          732            jnb     MB2, $-3        ;       
03C5 D22F            733            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
03C7 120589          734            lcall   WRITEPORTS      ;
03CA 0203CD          735            jmp     DOWN3_MB2     ;-; a prejdi do stavu DOWN3_MB2
03CD                 736    DOWN3_MB2:
03CD 120544          737            lcall   READPORTS       ; nacitanie dat
                     738 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
03D0 200C02          739 +1         jb      SKRD, $+5
03D3 020500          740 +1         ljmp    ERR_SKRD
03D6 00              741 +1         nop
                     743 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
03D7 200902          744 +1         jb      MB1, $+5
03DA 0204D3          745 +1         ljmp    ERR_1SPOM_C
03DD 00              746 +1         nop
VYTAH/ORI.D2/©48/©4                                                                                          PAGE 14

03DE 200AEC          748            jb      MB2, DOWN3_MB2;-; mame uz aj druhu spomalovaciu clonku?          
03E1 D22E            749            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
03E3 120589          750            lcall   WRITEPORTS      ;
03E6 E528            751            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
03E8 5404            752            anl     A, #00000100b ;-;
03EA 600A            753            jz      DOWN3_MB1     ;-;       Ak nie, chod do stavu DOWN3_MB1
03EC D223            754            setb    SLOW            ;       Ak ano, spomalme
03EE C222            755            clr     FAST            ; 
03F0 120589          756            lcall   WRITEPORTS      ;
03F3 0203F6          757            jmp     DOWN3_MB1     ;-; a prejdi do stavu DOWN3_MB1
03F6                 758    DOWN3_MB1:    
03F6 120544          759            lcall   READPORTS       ; nacitanie dat
                     760 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
03F9 200C02          761 +1         jb      SKRD, $+5
03FC 020500          762 +1         ljmp    ERR_SKRD
03FF 00              763 +1         nop
                     765 +1         ljnb    MB2, ERR_ZAST_C ; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na spo
                                                                               malovaciu) <<<
0400 200A02          766 +1         jb      MB2, $+5
0403 0204F1          767 +1         ljmp    ERR_ZAST_C
0406 00              768 +1         nop
0407 2009EC          770            jb      MB1, DOWN3_MB1;-; Sme na zastavovacej clonke?
040A E528            771            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
040C 5404            772            anl     A, #00000100b ;-;
040E 7003            773            jnz     D3_MB1C         ; Ak nie, chod do stavu DOWN2
0410 020255          774            ljmp    DOWN2         ;-; |
0413 C221            775    D3_MB1C:clr     DOWN            ; zastav motor
0415 D23B            776            setb    DOWNOld         ;       (a zalohuj)
0417 C23A            777            clr     UPOld           ;       (a zalohuj)
0419 C222            778            clr     FAST            ; 
041B 120589          779            lcall   WRITEPORTS      ; 
041E 2170            780            jmp     FLOOR2        ;-; a prejdi do stavu FLOOR2      
                     781          
                     782            
                     783    ;------------------------------------------------------------------------------- << 4. posch
                                                                               odie >>
                     784    
0420                 785    FLOOR4:
                     786 +1                 POLOHA_LED 4  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0420 C22F            787 +1         clr     LEDU            
0422 C22E            788 +1         clr     LEDD 
0424 C224            789 +1         clr     FLED1             
0426 C225            790 +1         clr     FLED2                
0428 C226            791 +1         clr     FLED3           
042A C227            792 +1         clr     FLED4           
042C D227            793 +1         setb    FLED4
042E 120589          794 +1         lcall   WRITEPORTS
0431 120533          796            lcall   WAITFORTIMER    ; simulacia TIMERu
0434 120544          797    F4S:    lcall   READPORTS     ;-; nacitanie dat
0437 C21C            798            clr     PKO4          ;-; vynulovanie volby poschodia na ktorom stojim
0439 120589          799            lcall   WRITEPORTS      ;
043C E528            800            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco menej ako poschodie na kto
                                                                               rom stojim
043E 540E            801            anl     A, #00001110b ;-;
0440 60F2            802            jz      F4S           ;-; ak nie, opakuj
0442 D221            803            setb    DOWN            ; rychly pohyb dole
0444 D222            804            setb    FAST            ;
VYTAH/ORI DF0©4                                                                                              PAGE 15

0446 C223            805            clr     SLOW            ; 
0448 120589          806            lcall   WRITEPORTS      ; 
044B 02044E          807            jmp     DOWN4         ;-; prejdi do stavu DOWN4 
044E                 808    DOWN4:
                     809 +1                 POLOHA_LED 4  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
044E C22F            810 +1         clr     LEDU            
0450 C22E            811 +1         clr     LEDD 
0452 C224            812 +1         clr     FLED1             
0454 C225            813 +1         clr     FLED2                
0456 C226            814 +1         clr     FLED3           
0458 C227            815 +1         clr     FLED4           
045A D227            816 +1         setb    FLED4
045C 120589          817 +1         lcall   WRITEPORTS
045F 120544          819            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0462 3009FA          820            jnb     MB1, $-3        ;  |
                     821            
0465 120544          822            lcall   READPORTS       ; nacitanie dat
                     823 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
0468 200C02          824 +1         jb      SKRD, $+5
046B 020500          825 +1         ljmp    ERR_SKRD
046E 00              826 +1         nop
                     828    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
046F 200ADC          829            jb      MB2, DOWN4    ;-; mame uz 1. spomalovaciu clonku?
0472 120544          830            lcall   READPORTS       ; ak ano, sme z nej uz prec?
0475 300AFA          831            jnb     MB2, $-3        ;       
0478 D22F            832            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
047A 120589          833            lcall   WRITEPORTS      ;
047D 020480          834            jmp     DOWN4_MB2     ;-; a prejdi do stavu DOWN4_MB2
0480                 835    DOWN4_MB2:
0480 120544          836            lcall   READPORTS       ; nacitanie dat
                     837 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
0483 200C02          838 +1         jb      SKRD, $+5
0486 020500          839 +1         ljmp    ERR_SKRD
0489 00              840 +1         nop
                     842 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
048A 200902          843 +1         jb      MB1, $+5
048D 0204D3          844 +1         ljmp    ERR_1SPOM_C
0490 00              845 +1         nop
0491 200AEC          847            jb      MB2, DOWN4_MB2;-; mame uz aj druhu spomalovaciu clonku?          
0494 D22E            848            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
0496 120589          849            lcall   WRITEPORTS      ;
0499 E528            850            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
049B 5408            851            anl     A, #00001000b ;-;
049D 600A            852            jz      DOWN4_MB1     ;-;       Ak nie, chod do stavu DOWN4_MB1
049F D223            853            setb    SLOW            ;       Ak ano, spomalme
04A1 C222            854            clr     FAST            ; 
04A3 120589          855            lcall   WRITEPORTS      ;
04A6 0204A9          856            jmp     DOWN4_MB1     ;-; a prejdi do stavu DOWN4_MB1
04A9                 857    DOWN4_MB1:    
04A9 120544          858            lcall   READPORTS       ; nacitanie dat
                     859 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
04AC 200C02          860 +1         jb      SKRD, $+5
04AF 020500          861 +1         ljmp    ERR_SKRD
04B2 00              862 +1         nop
                     864 +1         ljnb    MB2, ERR_ZAST_C; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na spom
VYTAH/ORI                                                                                                    PAGE 16

                                                                               alovaciu) <<<
04B3 200A02          865 +1         jb      MB2, $+5
04B6 0204F1          866 +1         ljmp    ERR_ZAST_C
04B9 00              867 +1         nop
04BA 2009EC          869            jb      MB1, DOWN4_MB1 ;-; Sme na zastavovacej clonke?
04BD E528            870            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
04BF 5408            871            anl     A, #00001000b ;-;
04C1 7003            872            jnz     D4_MB1C         ; Ak nie, chod do stavu DOWN3
04C3 02039B          873            ljmp    DOWN3         ;-; |
04C6 C221            874    D4_MB1C:clr     DOWN            ; zastav motor
04C8 D23B            875            setb    DOWNOld         ;       (a zalohuj)
04CA C23A            876            clr     UPOld           ;       (a zalohuj)
04CC C222            877            clr     FAST            ; 
04CE 120589          878            lcall   WRITEPORTS      ; 
04D1 41C8            879            jmp     FLOOR3        ;-; a prejdi do stavu FLOOR3                 
                     880                    
                     881      
04D3                 882    ERR_1SPOM_C: 
04D3 C220            883            clr     UP              ; zastav motor
04D5 C221            884            clr     DOWN            ; 
04D7 120589          885            lcall   WRITEPORTS      ; 
                     886 +1         _BP_
04DA C2B3            887 +1         clr     P3.3
04DC D2AA            888 +1         setb    EX1
04DE 00              889 +1         nop
04DF 00              890 +1         nop
04E0 00              892            nop
04E1 00              893            nop 
                     894            
04E2                 895    ERR_2SPOM_C: 
04E2 C220            896            clr     UP              ; zastav motor
04E4 C221            897            clr     DOWN            ; 
04E6 120589          898            lcall   WRITEPORTS      ; 
                     899 +1         _BP_
04E9 C2B3            900 +1         clr     P3.3
04EB D2AA            901 +1         setb    EX1
04ED 00              902 +1         nop
04EE 00              903 +1         nop
04EF 00              905            nop
04F0 00              906            nop 
                     907            
04F1                 908    ERR_ZAST_C: 
04F1 C220            909            clr     UP              ; zastav motor
04F3 C221            910            clr     DOWN            ; 
04F5 120589          911            lcall   WRITEPORTS      ; 
                     912 +1         _BP_
04F8 C2B3            913 +1         clr     P3.3
04FA D2AA            914 +1         setb    EX1
04FC 00              915 +1         nop
04FD 00              916 +1         nop
04FE 00              918            nop
04FF 00              919            nop 
                     920            
0500                 921    ERR_SKRD: 
0500 C220            922            clr     UP              ; zastav motor
0502 C221            923            clr     DOWN            ; 
0504 120589          924            lcall   WRITEPORTS      ; 
                     925 +1         _BP_
VYTAH/ORIVD                                                                                                  PAGE 17

0507 C2B3            926 +1         clr     P3.3
0509 D2AA            927 +1         setb    EX1
050B 00              928 +1         nop
050C 00              929 +1         nop
050D 00              931            nop
050E 00              932            nop    
                     933            
050F                 934    ERR_SKRH: 
050F C220            935            clr     UP              ; zastav motor
0511 C221            936            clr     DOWN            ; 
0513 120589          937            lcall   WRITEPORTS      ; 
                     938 +1         _BP_
0516 C2B3            939 +1         clr     P3.3
0518 D2AA            940 +1         setb    EX1
051A 00              941 +1         nop
051B 00              942 +1         nop
051C 00              944            nop
051D 00              945            nop             
                     946                    
                     947                    
051E                 948    ENDPROG:
051E D218            949            setb    KS
0520 120589          950            call    WRITEPORTS                ; zapis novu informaciu
                     951 +1         _BP_
0523 C2B3            952 +1         clr     P3.3
0525 D2AA            953 +1         setb    EX1
0527 00              954 +1         nop
0528 00              955 +1         nop
0529 22              957            ret
                     958            
                     959            
                     960    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     961    ; DELAY
                     962    ; Pocka na stlacenie tlacidla na 1. poschodi  - signal PO1 (v buducnosti to 
                     963    ; bude timer)
                     964    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
052A                 965    DELAY:
052A 7900            966            mov     R1, #0 
052C 7AFF            967            mov     R2, #0ffh
052E D9FE            968            djnz    R1, $
0530 DAFC            969            djnz    R2, $-2
0532 22              970            ret
                     971    
                     972    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     973    ; WAITFORTIMER
                     974    ; Pocka na stlacenie tlacidla na 1. poschodi  - signal PO1 (v buducnosti to 
                     975    ; bude timer)
                     976    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0533                 977    WAITFORTIMER:
0533 D22C            978            setb    PO3U                        ; rozsvieti indikator cakania (poschodie 4)
0535 120589          979            lcall   WRITEPORTS                  ;
0538 120544          980    WAIT:   lcall   READPORTS                   ; 
053B 3013F5          981            jnb     PI3D, WAITFORTIMER          ; ak nebolo stlacene tlacidlo PO1, cakaj 
053E C22C            982            clr     PO3U                         ; zhasne indikator cakania (poschodie 4)
0540 120589          983            lcall   WRITEPORTS
0543 22              984            ret
                     985    
                     986    
VYTAH/ORI                                                                                                     PAGE 18

                     987    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     988    ; READPORTS
                     989    ; precita nove hodnoty na portoch
                     990    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0544                 991    READPORTS:
0544 75A080          992            mov     p2, #i8255INA       ; citaj data z portu A
0547 75803F          993            mov     p0, #(bmSTOP or bmPKI1 or bmPKI2 or bmPKI3 or bmPKI4 or bmDOORCLSD)
054A C2B7            994            clr     RDNOT
054C 00              995            nop
054D 00              996            nop
054E 00              997            nop
054F 00              998            nop
0550 858028          999            mov     INPORTA, p0         ; uloz informaciu z datovej zbernice 
0553 D2B7           1000            setb    RDNOT
                    1001            
0555 75A081         1002            mov     p2, #i8255INB       ; citaj data z portu B
0558 7580FE         1003            mov     p0, #(bmMB1I or bmMB2I or bmSKRHI or bmSKRHD or bmDPI or bmDPKI or bmDPZKI)
                                                                               
055B C2B7           1004            clr     RDNOT
055D 00             1005            nop
055E 00             1006            nop
055F 00             1007            nop
0560 00             1008            nop
0561 858021         1009            mov     INPORTB, p0         ; uloz informaciu z datovej zbernice 
0564 D2B7           1010            setb    RDNOT
                    1011    
0566 75A082         1012            mov     p2, #i8255INC       ; citaj data z portu C
0569 75803F         1013            mov     p0, #(bmPI1 or bmPI2D or bmPI2U or bmPI3D or bmPI3U or bmPI4)
056C C2B7           1014            clr     RDNOT
056E 00             1015            nop
056F 00             1016            nop
0570 00             1017            nop
0571 00             1018            nop
0572 858022         1019            mov     INPORTC, p0         ; uloz informaciu z datovej zbernice 
0575 D2B7           1020            setb    RDNOT
0577 00             1021            nop
0578 00             1022            nop
0579 00             1023            nop
057A 00             1024            nop
057B 00             1025            nop
057C 00             1026            nop
057D 00             1027            nop
057E 00             1028            nop
057F E528           1029            mov     A, INPORTA
0581 541E           1030            anl     A, #00011110b
0583 4223           1031            orl     OUTPORTA, A
0585 120589         1032            call    WRITEPORTS              ; aktualizuj signalizaciu na ovladacom paneli
                    1033            
0588 22             1034            ret
                    1035            
                    1036    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1037    ; WRITEPORTS
                    1038    ; spravi zalohu vystupnych registrov a posle data von
                    1039    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0589                1040    WRITEPORTS:
0589 852380         1041            mov     p0, OUTPORTA        ; teraz postupne posli data najprv na port A,
058C 75A0C0         1042            mov     p2, #i8255OUTA
058F C2B6           1043            clr     WRNOT
VYTAH/ORI_D                                                                                                  PAGE 19

0591 00             1044            nop
0592 00             1045            nop
0593 00             1046            nop
0594 00             1047            nop
0595 D2B6           1048            setb    WRNOT
                    1049            
0597 852480         1050            mov     p0, OUTPORTB        ; potom port B
059A 75A0C1         1051            mov     p2, #i8255OUTB
059D C2B6           1052            clr     WRNOT
059F 00             1053            nop
05A0 00             1054            nop
05A1 00             1055            nop
05A2 00             1056            nop
05A3 D2B6           1057            setb    WRNOT
                    1058    
05A5 852580         1059            mov     p0, OUTPORTC        ; a nakoniec port C
05A8 75A0C2         1060            mov     p2, #i8255OUTC
05AB C2B6           1061            clr     WRNOT
05AD 00             1062            nop
05AE 00             1063            nop
05AF 00             1064            nop
05B0 00             1065            nop
05B1 D2B6           1066            setb    WRNOT
05B3 00             1067            nop
05B4 00             1068            nop
05B5 00             1069            nop
05B6 00             1070            nop
05B7 00             1071            nop
05B8 00             1072            nop
05B9 00             1073            nop
05BA 00             1074            nop
05BB 22             1075            ret
                    1076    
                    1077    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1078    
05BC 0D0A5269       1079    STR_INIT:   db  0dh, 0ah, 'Riadiaci system je inicializovany.', 0dh, 0ah, 00h
05C0 61646961   
05C4 63692073   
05C8 79737465   
05CC 6D206A65   
05D0 20696E69   
05D4 6369616C   
05D8 697A6F76   
05DC 616E792E   
05E0 0D0A00     
05E3 52696164       1080    STR_STOP:   db  'Riadiaci system je reinicializovany po stlaceni tlacidla STOP.', 0dh, 0ah, 
                                                                               00h
05E7 69616369   
05EB 20737973   
05EF 74656D20   
05F3 6A652072   
05F7 65696E69   
05FB 6369616C   
05FF 697A6F76   
0603 616E7920   
0607 706F2073   
060B 746C6163   
060F 656E6920   
VYTAH/ORI[D                                                                                                  PAGE 20

0613 746C6163   
0617 69646C61   
061B 2053544F   
061F 502E0D0A   
0623 00         
0624 4B616C69       1081    STR_CALIB:  db  'Kalibracia vytahu je ukoncena.', 0dh, 0ah, 00h
0628 62726163   
062C 69612076   
0630 79746168   
0634 75206A65   
0638 20756B6F   
063C 6E63656E   
0640 612E0D0A   
0644 00         
                    1082    
----                1083            DSEG
0040                1084            org     40h
0040                1085    STACK:  DS      10h
                    1086    
                    1087    end

VERSION 1.2h ASSEMBLY COMPLETE, 0 ERRORS FOUND
VYTAH/ORI                                                                                                     PAGE 21

B. . . . . . . . . . . . . . . .  D ADDR  00F0H  PREDEFINED  
BMDOORCLSD . . . . . . . . . . .    NUMB  0020H  
BMDOWN . . . . . . . . . . . . .    NUMB  0002H  NOT USED  
BMDPI. . . . . . . . . . . . . .    NUMB  0020H  
BMDPKI . . . . . . . . . . . . .    NUMB  0080H  
BMDPZKI. . . . . . . . . . . . .    NUMB  0040H  
BMFAST . . . . . . . . . . . . .    NUMB  0004H  NOT USED  
BMFLED1. . . . . . . . . . . . .    NUMB  0010H  
BMFLED2. . . . . . . . . . . . .    NUMB  0020H  
BMFLED3. . . . . . . . . . . . .    NUMB  0040H  
BMFLED4. . . . . . . . . . . . .    NUMB  0080H  
BMKS . . . . . . . . . . . . . .    NUMB  0001H  NOT USED  
BMLEDD . . . . . . . . . . . . .    NUMB  0040H  
BMLEDU . . . . . . . . . . . . .    NUMB  0080H  
BMMB1I . . . . . . . . . . . . .    NUMB  0002H  
BMMB2I . . . . . . . . . . . . .    NUMB  0004H  
BMPI1. . . . . . . . . . . . . .    NUMB  0001H  
BMPI2D . . . . . . . . . . . . .    NUMB  0002H  
BMPI2U . . . . . . . . . . . . .    NUMB  0004H  
BMPI3D . . . . . . . . . . . . .    NUMB  0008H  
BMPI3U . . . . . . . . . . . . .    NUMB  0010H  
BMPI4. . . . . . . . . . . . . .    NUMB  0020H  
BMPKI1 . . . . . . . . . . . . .    NUMB  0002H  
BMPKI2 . . . . . . . . . . . . .    NUMB  0004H  
BMPKI3 . . . . . . . . . . . . .    NUMB  0008H  
BMPKI4 . . . . . . . . . . . . .    NUMB  0010H  
BMPKO1 . . . . . . . . . . . . .    NUMB  0002H  
BMPKO2 . . . . . . . . . . . . .    NUMB  0004H  
BMPKO3 . . . . . . . . . . . . .    NUMB  0008H  
BMPKO4 . . . . . . . . . . . . .    NUMB  0010H  
BMPO1. . . . . . . . . . . . . .    NUMB  0001H  
BMPO2D . . . . . . . . . . . . .    NUMB  0002H  
BMPO2U . . . . . . . . . . . . .    NUMB  0004H  
BMPO3D . . . . . . . . . . . . .    NUMB  0008H  
BMPO3U . . . . . . . . . . . . .    NUMB  0010H  
BMPO4. . . . . . . . . . . . . .    NUMB  0020H  
BMSKRHD. . . . . . . . . . . . .    NUMB  0010H  
BMSKRHI. . . . . . . . . . . . .    NUMB  0008H  
BMSLOW . . . . . . . . . . . . .    NUMB  0008H  NOT USED  
BMSTOP . . . . . . . . . . . . .    NUMB  0001H  
BMUP . . . . . . . . . . . . . .    NUMB  0001H  NOT USED  
CALIB. . . . . . . . . . . . . .  C ADDR  0096H  NOT USED  
CALIBEND . . . . . . . . . . . .  C ADDR  00ADH  
CALIBLOOP. . . . . . . . . . . .  C ADDR  00A5H  
CANGO. . . . . . . . . . . . . .  B ADDR  0038H  NOT USED  
CTRLREG. . . . . . . . . . . . .  D ADDR  0027H  
D2_MB1C. . . . . . . . . . . . .  C ADDR  02BBH  
D3_MB1C. . . . . . . . . . . . .  C ADDR  0413H  
D4_MB1C. . . . . . . . . . . . .  C ADDR  04C6H  
DELAY. . . . . . . . . . . . . .  C ADDR  052AH  NOT USED  
DOORCLSD . . . . . . . . . . . .  B ADDR  0045H  NOT USED  
DOORCLSDOLD. . . . . . . . . . .  B ADDR  0039H  NOT USED  
DOWN . . . . . . . . . . . . . .  B ADDR  0021H  
DOWN2. . . . . . . . . . . . . .  C ADDR  0255H  
DOWN2_MB1. . . . . . . . . . . .  C ADDR  02B0H  
DOWN2_MB2. . . . . . . . . . . .  C ADDR  0287H  
DOWN3. . . . . . . . . . . . . .  C ADDR  039BH  
DOWN3_MB1. . . . . . . . . . . .  C ADDR  03F6H  
VYTAH/ORI                                                                                                     PAGE 22

DOWN3_MB2. . . . . . . . . . . .  C ADDR  03CDH  
DOWN4. . . . . . . . . . . . . .  C ADDR  044EH  
DOWN4_MB1. . . . . . . . . . . .  C ADDR  04A9H  
DOWN4_MB2. . . . . . . . . . . .  C ADDR  0480H  
DOWNOLD. . . . . . . . . . . . .  B ADDR  003BH  
DP . . . . . . . . . . . . . . .  B ADDR  000DH  NOT USED  
DPK. . . . . . . . . . . . . . .  B ADDR  000FH  NOT USED  
DPZK . . . . . . . . . . . . . .  B ADDR  000EH  NOT USED  
ENDPROG. . . . . . . . . . . . .  C ADDR  051EH  NOT USED  
ERR_1SPOM_C. . . . . . . . . . .  C ADDR  04D3H  
ERR_2SPOM_C. . . . . . . . . . .  C ADDR  04E2H  NOT USED  
ERR_SKRD . . . . . . . . . . . .  C ADDR  0500H  
ERR_SKRH . . . . . . . . . . . .  C ADDR  050FH  
ERR_ZAST_C . . . . . . . . . . .  C ADDR  04F1H  
EX1. . . . . . . . . . . . . . .  B ADDR  00AAH  PREDEFINED  
F1S. . . . . . . . . . . . . . .  C ADDR  00D3H  
F2 . . . . . . . . . . . . . . .  C ADDR  01B1H  
F2DOWN . . . . . . . . . . . . .  C ADDR  01C3H  
F2OK . . . . . . . . . . . . . .  C ADDR  0192H  
F2S. . . . . . . . . . . . . . .  C ADDR  0184H  
F2UP . . . . . . . . . . . . . .  C ADDR  01B7H  
F3 . . . . . . . . . . . . . . .  C ADDR  0309H  
F3DOWN . . . . . . . . . . . . .  C ADDR  031BH  
F3OK . . . . . . . . . . . . . .  C ADDR  02EAH  
F3S. . . . . . . . . . . . . . .  C ADDR  02DCH  
F3UP . . . . . . . . . . . . . .  C ADDR  030FH  
F4S. . . . . . . . . . . . . . .  C ADDR  0434H  
FAST . . . . . . . . . . . . . .  B ADDR  0022H  
FASTOLD. . . . . . . . . . . . .  B ADDR  003CH  NOT USED  
FLED1. . . . . . . . . . . . . .  B ADDR  0024H  
FLED2. . . . . . . . . . . . . .  B ADDR  0025H  
FLED3. . . . . . . . . . . . . .  B ADDR  0026H  
FLED4. . . . . . . . . . . . . .  B ADDR  0027H  
FLOOR1 . . . . . . . . . . . . .  C ADDR  00BFH  
FLOOR2 . . . . . . . . . . . . .  C ADDR  0170H  
FLOOR3 . . . . . . . . . . . . .  C ADDR  02C8H  
FLOOR4 . . . . . . . . . . . . .  C ADDR  0420H  
FLOORREQ . . . . . . . . . . . .  D ADDR  0036H  
HIGHEST. . . . . . . . . . . . .  D ADDR  0032H  NOT USED  
I8255INA . . . . . . . . . . . .    NUMB  0080H  
I8255INB . . . . . . . . . . . .    NUMB  0081H  
I8255INC . . . . . . . . . . . .    NUMB  0082H  
I8255INCW. . . . . . . . . . . .    NUMB  0083H  
I8255OUTA. . . . . . . . . . . .    NUMB  00C0H  
I8255OUTB. . . . . . . . . . . .    NUMB  00C1H  
I8255OUTC. . . . . . . . . . . .    NUMB  00C2H  
I8255OUTCW . . . . . . . . . . .    NUMB  00C3H  
INPORTA. . . . . . . . . . . . .  D ADDR  0028H  
INPORTB. . . . . . . . . . . . .  D ADDR  0021H  
INPORTBOLD . . . . . . . . . . .  D ADDR  0026H  
INPORTC. . . . . . . . . . . . .  D ADDR  0022H  
KS . . . . . . . . . . . . . . .  B ADDR  0018H  
LEDD . . . . . . . . . . . . . .  B ADDR  002EH  
LEDU . . . . . . . . . . . . . .  B ADDR  002FH  
LOWEST . . . . . . . . . . . . .  D ADDR  0031H  NOT USED  
MAIN . . . . . . . . . . . . . .  C ADDR  00BFH  NOT USED  
MB1. . . . . . . . . . . . . . .  B ADDR  0009H  
MB1OLD . . . . . . . . . . . . .  B ADDR  0031H  NOT USED  
VYTAH/ORI                                                                                                     PAGE 23

MB2. . . . . . . . . . . . . . .  B ADDR  000AH  
MB2OLD . . . . . . . . . . . . .  B ADDR  0032H  NOT USED  
OUTPORTA . . . . . . . . . . . .  D ADDR  0023H  
OUTPORTB . . . . . . . . . . . .  D ADDR  0024H  
OUTPORTBOLD. . . . . . . . . . .  D ADDR  0034H  NOT USED  
OUTPORTC . . . . . . . . . . . .  D ADDR  0025H  
P0 . . . . . . . . . . . . . . .  D ADDR  0080H  PREDEFINED  
P2 . . . . . . . . . . . . . . .  D ADDR  00A0H  PREDEFINED  
P3 . . . . . . . . . . . . . . .  D ADDR  00B0H  PREDEFINED  
PI1. . . . . . . . . . . . . . .  B ADDR  0010H  NOT USED  
PI2D . . . . . . . . . . . . . .  B ADDR  0011H  NOT USED  
PI2U . . . . . . . . . . . . . .  B ADDR  0012H  NOT USED  
PI3D . . . . . . . . . . . . . .  B ADDR  0013H  
PI3U . . . . . . . . . . . . . .  B ADDR  0014H  NOT USED  
PI4. . . . . . . . . . . . . . .  B ADDR  0015H  NOT USED  
PKI1 . . . . . . . . . . . . . .  B ADDR  0041H  NOT USED  
PKI2 . . . . . . . . . . . . . .  B ADDR  0042H  NOT USED  
PKI3 . . . . . . . . . . . . . .  B ADDR  0043H  NOT USED  
PKI4 . . . . . . . . . . . . . .  B ADDR  0044H  NOT USED  
PKO1 . . . . . . . . . . . . . .  B ADDR  0019H  
PKO2 . . . . . . . . . . . . . .  B ADDR  001AH  
PKO3 . . . . . . . . . . . . . .  B ADDR  001BH  
PKO4 . . . . . . . . . . . . . .  B ADDR  001CH  
PO1. . . . . . . . . . . . . . .  B ADDR  0028H  NOT USED  
PO2D . . . . . . . . . . . . . .  B ADDR  0029H  NOT USED  
PO2U . . . . . . . . . . . . . .  B ADDR  002AH  NOT USED  
PO3D . . . . . . . . . . . . . .  B ADDR  002BH  NOT USED  
PO3U . . . . . . . . . . . . . .  B ADDR  002CH  
PO4. . . . . . . . . . . . . . .  B ADDR  002DH  NOT USED  
POSITION . . . . . . . . . . . .  D ADDR  0030H  NOT USED  
RDNOT. . . . . . . . . . . . . .  B ADDR  00B7H  
READPORTS. . . . . . . . . . . .  C ADDR  0544H  
RESET. . . . . . . . . . . . . .  C ADDR  0033H  NOT USED  
SKRD . . . . . . . . . . . . . .  B ADDR  000CH  
SKRDOLD. . . . . . . . . . . . .  B ADDR  0034H  NOT USED  
SKRH . . . . . . . . . . . . . .  B ADDR  000BH  
SKRHOLD. . . . . . . . . . . . .  B ADDR  0033H  NOT USED  
SLOW . . . . . . . . . . . . . .  B ADDR  0023H  
SLOWOLD. . . . . . . . . . . . .  B ADDR  003DH  NOT USED  
SP . . . . . . . . . . . . . . .  D ADDR  0081H  PREDEFINED  
STACK. . . . . . . . . . . . . .  D ADDR  0040H  
START. . . . . . . . . . . . . .  C ADDR  0033H  
STOPNOT. . . . . . . . . . . . .  B ADDR  0040H  NOT USED  
STOPTIMER. . . . . . . . . . . .  D ADDR  0033H  
STR_CALIB. . . . . . . . . . . .  C ADDR  0624H  NOT USED  
STR_INIT . . . . . . . . . . . .  C ADDR  05BCH  NOT USED  
STR_STOP . . . . . . . . . . . .  C ADDR  05E3H  NOT USED  
TIMERCONST . . . . . . . . . . .    NUMB  00FAH  NOT USED  
U2_MB1C. . . . . . . . . . . . .  C ADDR  0247H  
U3_MB1C. . . . . . . . . . . . .  C ADDR  038DH  
UP . . . . . . . . . . . . . . .  B ADDR  0020H  
UP1. . . . . . . . . . . . . . .  C ADDR  00EDH  
UP1A . . . . . . . . . . . . . .  C ADDR  0104H  
UP1_MB1. . . . . . . . . . . . .  C ADDR  0148H  
UP1_MB2. . . . . . . . . . . . .  C ADDR  011FH  
UP2. . . . . . . . . . . . . . .  C ADDR  01CFH  
UP2A . . . . . . . . . . . . . .  C ADDR  01E6H  
UP2_MB1. . . . . . . . . . . . .  C ADDR  022AH  
VYTAH/ORI                                                                                                     PAGE 24

UP2_MB2. . . . . . . . . . . . .  C ADDR  0201H  
UP3. . . . . . . . . . . . . . .  C ADDR  0327H  
UP3A . . . . . . . . . . . . . .  C ADDR  033EH  
UP3_MB1. . . . . . . . . . . . .  C ADDR  0382H  
UP3_MB2. . . . . . . . . . . . .  C ADDR  0359H  
UPOLD. . . . . . . . . . . . . .  B ADDR  003AH  
WAIT . . . . . . . . . . . . . .  C ADDR  0538H  NOT USED  
WAITFORTIMER . . . . . . . . . .  C ADDR  0533H  
WRITEPORTS . . . . . . . . . . .  C ADDR  0589H  
WRNOT. . . . . . . . . . . . . .  B ADDR  00B6H  
