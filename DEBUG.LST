VYTAH/ORI                                                                                                     PAGE 1

                       1    $MOD51
                       2    $DEBUG
                       3    
                =1     4    $include (lift.inc)
                =1     5    ; adresy I/O portov, ktore pridu na port P2 89C52-ky
  0080          =1     6    i8255INA        equ     080h
  0081          =1     7    i8255INB        equ     081h
  0082          =1     8    i8255INC        equ     082h
  0083          =1     9    i8255INCW       equ     083h
  00C0          =1    10    i8255OUTA       equ     0c0h
  00C1          =1    11    i8255OUTB       equ     0c1h
  00C2          =1    12    i8255OUTC       equ     0c2h
  00C3          =1    13    i8255OUTCW      equ     0c3h
                =1    14    
  0028          =1    15    INPORTA         data    28h         ; nutne kvoli emulatoru!!!
  0021          =1    16    INPORTB         data    21h
  0022          =1    17    INPORTC         data    22h
  0023          =1    18    OUTPORTA        data    23h
  0024          =1    19    OUTPORTB        data    24h
  0025          =1    20    OUTPORTC        data    25h
  0026          =1    21    INPORTBold      data    26h
  0027          =1    22    CTRLREG         data    27h
                =1    23    
  0030          =1    24    POSITION        data    30h
  0031          =1    25    LOWEST          data    31h
  0032          =1    26    HIGHEST         data    32h
  0033          =1    27    STOPTIMER       data    33h
  0034          =1    28    OUTPORTBold     data    34h
                =1    29    
  0040          =1    30    STOPNOT         bit     INPORTA.0
  0041          =1    31    PKI1            bit     INPORTA.1
  0042          =1    32    PKI2            bit     INPORTA.2
  0043          =1    33    PKI3            bit     INPORTA.3
  0044          =1    34    PKI4            bit     INPORTA.4
  0045          =1    35    DOORCLSD        bit     INPORTA.5 
                =1    36    
  0009          =1    37    MB1             bit     INPORTB.1       ; clonky maju invertovanu logiku
  000A          =1    38    MB2             bit     INPORTB.2
  000B          =1    39    SKRH            bit     INPORTB.3
  000C          =1    40    SKRD            bit     INPORTB.4
  000D          =1    41    DP              bit     INPORTB.5
  000E          =1    42    DPZK            bit     INPORTB.6
  000F          =1    43    DPK             bit     INPORTB.7
                =1    44    
  0031          =1    45    MB1old          bit     INPORTBold.1
  0032          =1    46    MB2old          bit     INPORTBold.2
  0033          =1    47    SKRHold         bit     INPORTBold.3
  0034          =1    48    SKRDold         bit     INPORTBold.4
                =1    49    
  0010          =1    50    PI1             bit     INPORTC.0
  0011          =1    51    PI2D            bit     INPORTC.1
  0012          =1    52    PI2U            bit     INPORTC.2
  0013          =1    53    PI3D            bit     INPORTC.3
  0014          =1    54    PI3U            bit     INPORTC.4
  0015          =1    55    PI4             bit     INPORTC.5
                =1    56    
  0018          =1    57    KS              bit     OUTPORTA.0
  0019          =1    58    PKO1            bit     OUTPORTA.1
VYTAH/ORI/D                                                                                                  PAGE 2

  001A          =1    59    PKO2            bit     OUTPORTA.2
  001B          =1    60    PKO3            bit     OUTPORTA.3
  001C          =1    61    PKO4            bit     OUTPORTA.4
                =1    62    
  0020          =1    63    UP              bit     OUTPORTB.0
  0021          =1    64    DOWN            bit     OUTPORTB.1
  0022          =1    65    FAST            bit     OUTPORTB.2
  0023          =1    66    SLOW            bit     OUTPORTB.3
  0024          =1    67    FLED1           bit     OUTPORTB.4
  0025          =1    68    FLED2           bit     OUTPORTB.5
  0026          =1    69    FLED3           bit     OUTPORTB.6
  0027          =1    70    FLED4           bit     OUTPORTB.7
                =1    71    
  0028          =1    72    PO1             bit     OUTPORTC.0
  0029          =1    73    PO2D            bit     OUTPORTC.1
  002A          =1    74    PO2U            bit     OUTPORTC.2
  002B          =1    75    PO3D            bit     OUTPORTC.3
  002C          =1    76    PO3U            bit     OUTPORTC.4
  002D          =1    77    PO4             bit     OUTPORTC.5
  002E          =1    78    LEDD            bit     OUTPORTC.6
  002F          =1    79    LEDU            bit     OUTPORTC.7
                =1    80    
  0038          =1    81    CANGO           bit     CTRLREG.0
  0039          =1    82    DOORCLSDold     bit     CTRLREG.1
  003A          =1    83    UPold           bit     CTRLREG.2
  003B          =1    84    DOWNold         bit     CTRLREG.3
  003C          =1    85    FASTold         bit     CTRLREG.4
  003D          =1    86    SLOWold         bit     CTRLREG.5
                =1    87    
  00B6          =1    88    WRNOT           bit     0b6h        ; p3.6
  00B7          =1    89    RDNOT           bit     0b7h        ; p3.7
                =1    90    
                =1    91    ; bitove masky
                =1    92    ; 8255OUT 
                =1    93    ; port A
  0001          =1    94    bmKS              equ    00000001b
  0002          =1    95    bmPKO1            equ    00000010b
  0004          =1    96    bmPKO2            equ    00000100b
  0008          =1    97    bmPKO3            equ    00001000b
  0010          =1    98    bmPKO4            equ    00010000b
                =1    99    
                =1   100    ; port B
  0001          =1   101    bmUP              equ    00000001b
  0002          =1   102    bmDOWN            equ    00000010b
  0004          =1   103    bmFAST            equ    00000100b
  0008          =1   104    bmSLOW            equ    00001000b
  0010          =1   105    bmFLED1           equ    00010000b
  0020          =1   106    bmFLED2           equ    00100000b
  0040          =1   107    bmFLED3           equ    01000000b
  0080          =1   108    bmFLED4           equ    10000000b
                =1   109    
                =1   110    ; port C
  0001          =1   111    bmPO1             equ    00000001b
  0002          =1   112    bmPO2D            equ    00000010b
  0004          =1   113    bmPO2U            equ    00000100b
  0008          =1   114    bmPO3D            equ    00001000b
  0010          =1   115    bmPO3U            equ    00010000b
  0020          =1   116    bmPO4             equ    00100000b
VYTAH/ORI/D                                                                                                  PAGE 3

  0040          =1   117    bmLEDD            equ    01000000b
  0080          =1   118    bmLEDU            equ    10000000b
                =1   119    
                =1   120    ; 8255IN
                =1   121    ; port A
  0001          =1   122    bmSTOP            equ    00000001b
  0002          =1   123    bmPKI1            equ    00000010b
  0004          =1   124    bmPKI2            equ    00000100b
  0008          =1   125    bmPKI3            equ    00001000b
  0010          =1   126    bmPKI4            equ    00010000b
  0020          =1   127    bmDOORCLSD        equ    00100000b
                =1   128    
                =1   129    ; port B
  0002          =1   130    bmMB1I            equ    00000010b
  0004          =1   131    bmMB2I            equ    00000100b
  0008          =1   132    bmSKRHI           equ    00001000b
  0010          =1   133    bmSKRHD           equ    00010000b
  0020          =1   134    bmDPI             equ    00100000b
  0040          =1   135    bmDPZKI           equ    01000000b
  0080          =1   136    bmDPKI            equ    10000000b
                =1   137    
                =1   138    ; port C
  0001          =1   139    bmPI1             equ    00000001b
  0002          =1   140    bmPI2D            equ    00000010b
  0004          =1   141    bmPI2U            equ    00000100b
  0008          =1   142    bmPI3D            equ    00001000b
  0010          =1   143    bmPI3U            equ    00010000b
  0020          =1   144    bmPI4             equ    00100000b
                =1   145    
                     146    
                     147    _BP_    MACRO 
                     148            clr     P3.3
                     149            setb    EX1
                     150            nop
                     151            nop
                     152    ENDM
                     153    
                     154    LJZ     MACRO   NAVESTIE
                     155            jnz     $+5
                     156            ljmp    NAVESTIE
                     157            nop
                     158    ENDM
                     159    
                     160    LJNZ    MACRO   NAVESTIE
                     161            jz      $+5
                     162            ljmp    NAVESTIE
                     163            nop
                     164    ENDM
                     165    
                     166    LJB     MACRO   TESTBIT, NAVESTIE
                     167            jnb     TESTBIT, $+5
                     168            ljmp    NAVESTIE
                     169            nop
                     170    ENDM
                     171    
                     172    LJNB    MACRO   TESTBIT, NAVESTIE
                     173            jb      TESTBIT, $+5
                     174            ljmp    NAVESTIE
VYTAH/ORI/D                                                                                                  PAGE 4

                     175            nop
                     176    ENDM
                     177    
                     178    POLOHA_LED  MACRO  POLOHA
                     179            clr     LEDU            
                     180            clr     LEDD 
                     181            clr     FLED1             
                     182            clr     FLED2                
                     183            clr     FLED3           
                     184            clr     FLED4           
                     185            setb    FLED&POLOHA
                     186            lcall   WRITEPORTS
                     187    ENDM
                     188    
  0036               189    FLOORREQ        data    36h
                     190    
                     191    ; hodiny oscilatora v emulatore treba dat na ext a nastavit 11.0592MHz
  00FA               192    TIMERCONST      equ     250     ; udaj pre nastavenie casovaca pre potreby seriovej komunika
                                                                               cie
                     193                                    ; hodnota 250 znamena prenosovu rychlost 4800 baud pri oscil
                                                                               atore 11.0592MHz
                     194                                    ; nastavenie terminalu je 4800 8-N-1, no flow control
                     195    ;osetrenie vektorov preruseni
0000                 196            org     0000h           ; adresa odkial startuje program po resete
0000 020033          197            ljmp    START           ; skok na zaciatok kodu programu
                     198                  
0033                 199            org     0033h           ; od tejto adresy sa zacina kod programu
0033                 200    START:
0033                 201    RESET:  
                     202            ; riadiace signaly do pasivnej urovne 
0033 D2B6            203            setb    WRNOT
0035 D2B7            204            setb    RDNOT
0037 753300          205            mov     STOPTIMER, #0
003A 758140          206            mov     SP, #STACK
                     207    
                     208            ; pockame si na inicializaciu obvodov 8255  
003D 7900            209            mov     R1, #0 
003F 7AFF            210            mov     R2, #0ffh
0041 D9FE            211            djnz    R1, $
0043 DAFC            212            djnz    R2, $-2
                     213            
                     214            ; teraz ich mozeme nastavit
0045 75809B          215            mov     p0, #10011011b      ; nastavenie i8255IN - vsetky porty dnu
0048 75A083          216            mov     p2, #i8255INCW
004B C2B6            217            clr     WRNOT
004D 00              218            nop
004E 00              219            nop
004F 00              220            nop
0050 00              221            nop
0051 D2B6            222            setb    WRNOT
0053 758080          223            mov     p0, #10000000b      ; nastavenie i8255OUT - vsetky porty von
0056 75A0C3          224            mov     p2, #i8255OUTCW
0059 C2B6            225            clr     WRNOT
005B 00              226            nop
005C 00              227            nop
005D 00              228            nop
005E 00              229            nop
005F D2B6            230            setb    WRNOT
VYTAH/ORI.D                                                                                                  PAGE 5

                     231            
                     232 +1         _BP_
0061 C2B3            233 +1         clr     P3.3
0063 D2AA            234 +1         setb    EX1
0065 00              235 +1         nop
0066 00              236 +1         nop
                     238    
                     239            ; pociatocna inicializacia - vynuluj vstupne registre a rozsviet vsetky diody 
0067 752800          240            mov     INPORTA, #0
006A 75211E          241            mov     INPORTB, #01eh      ; vsetky clonky pasivne
006D 752200          242            mov     INPORTC, #0
0070 75231E          243            mov     OUTPORTA, #(bmPKO1 or bmPKO2 or bmPKO3 or bmPKO4)
0073 7524F0          244            mov     OUTPORTB, #(bmFLED1 or bmFLED2 or bmFLED3 or bmFLED4)
0076 7525FF          245            mov     OUTPORTC, #(bmPO1 or bmPO2D or bmPO2U or bmPO3D or bmPO3U or bmPO4 or bmLEDD
                                                                                or bmLEDU)
0079 D218            246            setb    KS
007B 1205A2          247            call    WRITEPORTS          ; zapis novu informaciu
                     248    ;;;;;;;;
                     249    
007E 752300          250            mov     OUTPORTA, #0
0081 752400          251            mov     OUTPORTB, #0
0084 752500          252            mov     OUTPORTC, #0
0087 1205A2          253            call    WRITEPORTS          ; zapis novu informaciu
                     254    
008A 752800          255            mov     INPORTA, #0
008D 752100          256            mov     INPORTB, #0         
0090 752200          257            mov     INPORTC, #0
0093 12055D          258            call    READPORTS           ; prvotne nacitanie udajov
                     259    
0096                 260    CALIB:
                     261            ;kalibracia vytahu podla dolnej porovnavacej clonky
0096 12055D          262            lcall   READPORTS                   ; precitaj, co je na portoch
0099 300C11          263            jnb     SKRD, CALIBEND              ; ak sme na dolnej porovnavacej clonke, tak koni
                                                                               ec
009C D221            264            setb    DOWN                        ; inak pod dole
009E D222            265            setb    FAST                        ; a rychlo
00A0 C223            266            clr     SLOW                        ;
00A2 1205A2          267            lcall   WRITEPORTS                  ; zapis informaciu 
00A5                 268    CALIBLOOP:
00A5 12055D          269            lcall   READPORTS                   ; 
00A8 300C02          270            jnb     SKRD, CALIBEND              ; ak sme dole, konci
                     271            ;jnb     MB2, CALIBEND               ; ak sme na poschodi, konci
00AB 80F8            272            jmp     CALIBLOOP
00AD                 273    CALIBEND:
00AD 753600          274            mov     FLOORREQ, #0                                
00B0 C222            275            clr     FAST                        ; stojime
00B2 C221            276            clr     DOWN                        ;
00B4 D224            277            setb    FLED1
00B6 1205A2          278            lcall   WRITEPORTS                  ; zapis informaciu
                     279 +1         _BP_
00B9 C2B3            280 +1         clr     P3.3
00BB D2AA            281 +1         setb    EX1
00BD 00              282 +1         nop
00BE 00              283 +1         nop
00BF                 285    MAIN:
                     286    
                     287    ;            |  7    |  6    |  5    |  4    |  3    |  2    |  1    |  0    |
                     288    ; ****************************************************************************
VYTAH/ORI                                                                                                     PAGE 6

                     289    ; INPORTA >  |       |       |DOORCLS| PKI4  | PKI3  | PKI2  | PKI1  |STOPNOT|
                     290    ; ----------------------------------------------------------------------------
                     291    ; INPORTB >  | DPK   | DPZK  | DP    | SKRD  | SKRH  | MB2   | MB1   |       |
                     292    ; ----------------------------------------------------------------------------
                     293    ; INPORTC >  |       |       | PI4   | PI3D  | PI3U  | PI2D  | PI2U  | PI1   |
                     294    ; ****************************************************************************
                     295    ; OUTPORTA > |       |       |       | PKO4  | PKO3  | PKO2  | PKO1  | KS    |
                     296    ; ----------------------------------------------------------------------------
                     297    ; OUTPORTB > | FLED4 | FLED3 | FLED2 | FLED1 | SLOW  | FAST  | DOWN  | UP    |
                     298    ; ----------------------------------------------------------------------------
                     299    ; OUTPORTC > | LEDU  | LEDD  | PO4   | PO3D  | PO3U  | PO2D  | PO2U  | PO1   |
                     300    ; ****************************************************************************
                     301    ; POSITION
                     302    ; ****************************************************************************
                     303    
                     304    
                     305    ;------------------------------------------------------------------------------- << 1. posch
                                                                               odie >>
                     306    
00BF                 307    FLOOR1:
                     308 +1                 POLOHA_LED 1  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
00BF C22F            309 +1         clr     LEDU            
00C1 C22E            310 +1         clr     LEDD 
00C3 C224            311 +1         clr     FLED1             
00C5 C225            312 +1         clr     FLED2                
00C7 C226            313 +1         clr     FLED3           
00C9 C227            314 +1         clr     FLED4           
00CB D224            315 +1         setb    FLED1
00CD 1205A2          316 +1         lcall   WRITEPORTS
00D0 12054C          318            lcall   WAITFORTIMER    ; simulacia TIMERu
00D3 12055D          319    F1S:    lcall   READPORTS     ;-; nacitanie dat
00D6 C219            320            clr     PKO1          ;-; vynulovanie volby poschodia na ktorom stojim
00D8 1205A2          321            lcall   WRITEPORTS      ;
00DB E528            322            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
00DD 541C            323            anl     A, #00011100b ;-;
00DF 60F2            324            jz      F1S           ;-; ak nie, opakuj
00E1 D220            325            setb    UP              ; rychly pohyb hore
00E3 D222            326            setb    FAST            ; 
00E5 C223            327            clr     SLOW            ;
00E7 1205A2          328            lcall   WRITEPORTS      ; 
00EA 0200ED          329            jmp     UP1           ;-; prejdi do stavu UP1
00ED                 330    UP1:
                     331 +1                 POLOHA_LED 1  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
00ED C22F            332 +1         clr     LEDU            
00EF C22E            333 +1         clr     LEDD 
00F1 C224            334 +1         clr     FLED1             
00F3 C225            335 +1         clr     FLED2                
00F5 C226            336 +1         clr     FLED3           
00F7 C227            337 +1         clr     FLED4           
00F9 D224            338 +1         setb    FLED1
00FB 1205A2          339 +1         lcall   WRITEPORTS
00FE 12055D          341            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0101 3009FA          342            jnb     MB1, $-3        ;  |
0104 12055D          343    UP1A:   lcall   READPORTS       ; nacitanie dat
                     344 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
VYTAH/ORIWD&'©4.'©4                                                                                          PAGE 7

0107 200B02          345 +1         jb      SKRH, $+5
010A 02051E          346 +1         ljmp    ERR_SKRH
010D 00              347 +1         nop
                     349    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
010E 200AF3          350            jb      MB2, UP1A     ;-; mame uz 1. spomalovaciu clonku?
0111 12055D          351            lcall   READPORTS       ; ak ano, sme z nej uz prec?
0114 300AFA          352            jnb     MB2, $-3        ;       
0117 D22E            353            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0119 1205A2          354            lcall   WRITEPORTS      ;
011C 02011F          355            jmp     UP1_MB2       ;-; a prejdi do stavu UP1_MB2
011F                 356    UP1_MB2:
011F 12055D          357            lcall   READPORTS       ; nacitanie dat
                     358 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0122 200B02          359 +1         jb      SKRH, $+5
0125 02051E          360 +1         ljmp    ERR_SKRH
0128 00              361 +1         nop
                     363 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
0129 200902          364 +1         jb      MB1, $+5
012C 0204E2          365 +1         ljmp    ERR_1SPOM_C
012F 00              366 +1         nop
0130 200AEC          368            jb      MB2, UP1_MB2  ;-; mame uz aj druhu spomalovaciu clonku?     
0133 D22F            369            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
0135 1205A2          370            lcall   WRITEPORTS      ;   
                     371            
0138 12055D          372            lcall   READPORTS       ; Uz sme z tej clonky prec?
013B 300AFA          373            jnb     MB2, $-3        ; 
013E 120539          374            lcall   TIME1MS        ; pockame 10? ms 
0141 120539          375            lcall   TIME1MS        ; pockame 10? ms 
0144 120539          376            lcall   TIME1MS        ; pockame 10? ms 
0147 120539          377            lcall   TIME1MS        ; pockame 10? ms 
014A 120539          378            lcall   TIME1MS        ; pockame 10? ms 
014D 120539          379            lcall   TIME1MS        ; pockame 10? ms 
0150 120539          380            lcall   TIME1MS        ; pockame 10? ms 
0153 120539          381            lcall   TIME1MS        ; pockame 10? ms 
0156 120539          382            lcall   TIME1MS        ; pockame 10? ms 
0159 120539          383            lcall   TIME1MS        ; pockame 10? ms 
                     384            
015C E528            385            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
015E 5404            386            anl     A, #00000100b ;-;
0160 600A            387            jz      UP1_MB1       ;-;       Ak nie, chod do stavu UP1_MB1
0162 D223            388            setb    SLOW            ;       Ak ano, spomalme
0164 C222            389            clr     FAST            ; 
0166 1205A2          390            lcall   WRITEPORTS      ;         
0169 02016C          391            jmp     UP1_MB1       ;-; a prejdi do stavu UP1_MB1 
016C                 392    UP1_MB1:
016C 12055D          393            lcall   READPORTS       ; nacitanie dat
                     394 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
016F 200B02          395 +1         jb      SKRH, $+5
0172 02051E          396 +1         ljmp    ERR_SKRH
0175 00              397 +1         nop
                     399 +1         ljnb    MB2, ERR_ZAST_C ; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na spo
                                                                               malovaciu) <<<
0176 200A02          400 +1         jb      MB2, $+5
0179 020500          401 +1         ljmp    ERR_ZAST_C
017C 00              402 +1         nop
017D 2009EC          404            jb      MB1, UP1_MB1  ;-; Sme na zastavovacej clonke?
VYTAH/ORI OD–(©4œ(©4                                                                                          PAGE 8

0180 E528            405            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
0182 5404            406            anl     A, #00000100b ;-;
0184 606D            407            jz      UP2           ;-; Ak nie, chod do stavu UP2
0186 C220            408            clr     UP              ; zastav motor
0188 D23A            409            setb    UPOld           ;       (a zalohuj) 
018A C23B            410            clr     DOWNOld         ;       (a zalohuj)
018C C222            411            clr     FAST            ; 
018E 1205A2          412            lcall   WRITEPORTS      ; 
0191 020194          413            jmp     FLOOR2        ;-; a prejdi do stavu FLOOR2
                     414    
                     415    ;------------------------------------------------------------------------------- << 2. posch
                                                                               odie >>
                     416    
0194                 417    FLOOR2:
                     418 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0194 C22F            419 +1         clr     LEDU            
0196 C22E            420 +1         clr     LEDD 
0198 C224            421 +1         clr     FLED1             
019A C225            422 +1         clr     FLED2                
019C C226            423 +1         clr     FLED3           
019E C227            424 +1         clr     FLED4           
01A0 D225            425 +1         setb    FLED2
01A2 1205A2          426 +1         lcall   WRITEPORTS
01A5 12054C          428            lcall   WAITFORTIMER    ; simulacia TIMERu
01A8 12055D          429    F2S:    lcall   READPORTS     ;-; nacitanie dat
01AB C21A            430            clr     PKO2          ;-; vynulovanie volby poschodia na ktorom stojim
01AD 1205A2          431            lcall   WRITEPORTS      ;
                     432            
01B0 7418            433            mov     A, #00011000b ;-; Default predpokladam, ze mam namierene hore (na 3. a 4.)
01B2 203A01          434            jb      UPOld, F2OK     ;   Je to pravda? Naozaj som doteraz isiel hore?
01B5 F4              435            cpl     A               ;       Ak nie, znegujeme
01B6 F5F0            436    F2OK:   mov     B, A            ; Masku dame do Bcka
                     437            
                     438            ; Pohyb v jednom smere (nevieme v ktorom)
01B8 53F01A          439            anl     B, #00011010b  ;-; este ju kozmeticky upravime
01BB E528            440            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
01BD 55F0            441            anl     A, B            ; tu ju pouzijeme       
01BF 7014            442            jnz     F2              ; nasli sme poschodie v tomto smere
                     443            ; Pohyb v opacnom smere (nevieme v ktorom)
01C1 B23A            444            cpl     UPOld           ;  Znegujem stary posun
01C3 B23B            445            cpl     DOWNOld         ;  |
01C5 E5F0            446            mov     A, B            ;  Znegujeme masku
01C7 F4              447            cpl     A               ;  |
01C8 F5F0            448            mov     B, A            ;  |
01CA 53F01A          449            anl     B, #00011010b  ;-; este ju kozmeticky upravime
01CD E528            450            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
01CF 55F0            451            anl     A, B            ; tu ju pouzijeme       
01D1 7002            452            jnz     F2              ; nasli sme poschodie v tomto smere
                     453            
01D3 80D3            454            jmp     F2S           ;-; nemame sa kde hybat, tak opakujeme zistovanie
01D5 203A03          455    F2:     jb      UPOld, F2UP     ;   
01D8 0201E7          456            jmp     F2DOWN          ;
01DB D220            457    F2UP:   setb    UP              ; rychly pohyb hore
01DD D222            458            setb    FAST            ; 
01DF C223            459            clr     SLOW            ;
VYTAH/ORI 1Dò(©4                                                                                              PAGE 9

01E1 1205A2          460            lcall   WRITEPORTS      ; 
01E4 0201F3          461            jmp     UP2           ;-; prejdi do stavu UP2    
01E7 D221            462    F2DOWN: setb    DOWN            ; rychly pohyb hore
01E9 D222            463            setb    FAST            ; 
01EB C223            464            clr     SLOW            ;
01ED 1205A2          465            lcall   WRITEPORTS      ; 
01F0 020272          466            jmp     DOWN2         ;-; prejdi do stavu UP2    
                     467            
                     468                
01F3                 469    UP2:
                     470 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
01F3 C22F            471 +1         clr     LEDU            
01F5 C22E            472 +1         clr     LEDD 
01F7 C224            473 +1         clr     FLED1             
01F9 C225            474 +1         clr     FLED2                
01FB C226            475 +1         clr     FLED3           
01FD C227            476 +1         clr     FLED4           
01FF D225            477 +1         setb    FLED2
0201 1205A2          478 +1         lcall   WRITEPORTS
0204 12055D          480            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0207 3009FA          481            jnb     MB1, $-3        ;  |
020A 12055D          482    UP2A:   lcall   READPORTS       ; nacitanie dat
                     483 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
020D 200B02          484 +1         jb      SKRH, $+5
0210 02051E          485 +1         ljmp    ERR_SKRH
0213 00              486 +1         nop
                     488    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
0214 200AF3          489            jb      MB2, UP2A     ;-; mame uz 1. spomalovaciu clonku?
0217 12055D          490            lcall   READPORTS       ; ak ano, sme z nej uz prec?
021A 300AFA          491            jnb     MB2, $-3        ;       
021D D22E            492            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
021F 1205A2          493            lcall   WRITEPORTS      ;
0222 020225          494            jmp     UP2_MB2       ;-; a prejdi do stavu UP2_MB2
0225                 495    UP2_MB2:
0225 12055D          496            lcall   READPORTS       ; nacitanie dat
                     497 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0228 200B02          498 +1         jb      SKRH, $+5
022B 02051E          499 +1         ljmp    ERR_SKRH
022E 00              500 +1         nop
                     502 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
022F 200902          503 +1         jb      MB1, $+5
0232 0204E2          504 +1         ljmp    ERR_1SPOM_C
0235 00              505 +1         nop
0236 200AEC          507            jb      MB2, UP2_MB2  ;-; mame uz aj druhu spomalovaciu clonku?          
0239 D22F            508            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
023B 1205A2          509            lcall   WRITEPORTS      ;
023E E528            510            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
0240 5408            511            anl     A, #00001000b ;-;
0242 600A            512            jz      UP2_MB1       ;-;       Ak nie, chod do stavu UP2_MB1
0244 D223            513            setb    SLOW            ;       Ak ano, spomalme
0246 C222            514            clr     FAST            ; 
0248 1205A2          515            lcall   WRITEPORTS      ;
024B 02024E          516            jmp     UP2_MB1       ;-; a prejdi do stavu UP2_MB1 
024E                 517    UP2_MB1:
024E 12055D          518            lcall   READPORTS       ; nacitanie dat
VYTAH/ORIDž*©4¦*©4                                                                                          PAGE 10

                     519 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0251 200B02          520 +1         jb      SKRH, $+5
0254 02051E          521 +1         ljmp    ERR_SKRH
0257 00              522 +1         nop
                     524    ;        ljnb    MB2, ERR_ZAST_C ; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na sp
                                                                               omalovaciu) <<<
0258 2009F3          525            jb      MB1, UP2_MB1  ;-; Sme na zastavovacej clonke?
025B E528            526            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
025D 5408            527            anl     A, #00001000b ;-;
025F 7003            528            jnz     U2_MB1C       ;-; Ak nie, chod do stavu UP3
0261 020344          529            ljmp    UP3             ; |
0264 C220            530    U2_MB1C:clr     UP              ; zastav motor
0266 D23A            531            setb    UPOld           ;       (a zalohuj)
0268 C23B            532            clr     DOWNOld         ;       (a zalohuj)
026A C222            533            clr     FAST            ; 
026C 1205A2          534            lcall   WRITEPORTS      ; 
026F 0202E5          535            jmp     FLOOR3        ;-; a prejdi do stavu FLOOR3
0272                 536    DOWN2:
                     537 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0272 C22F            538 +1         clr     LEDU            
0274 C22E            539 +1         clr     LEDD 
0276 C224            540 +1         clr     FLED1             
0278 C225            541 +1         clr     FLED2                
027A C226            542 +1         clr     FLED3           
027C C227            543 +1         clr     FLED4           
027E D225            544 +1         setb    FLED2
0280 1205A2          545 +1         lcall   WRITEPORTS
0283 12055D          547            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0286 3009FA          548            jnb     MB1, $-3        ;  |
0289 12055D          549            lcall   READPORTS       ; nacitanie dat
                     550 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
028C 200C02          551 +1         jb      SKRD, $+5
028F 02050F          552 +1         ljmp    ERR_SKRD
0292 00              553 +1         nop
                     555    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
0293 200ADC          556            jb      MB2, DOWN2    ;-; mame uz 1. spomalovaciu clonku?
0296 12055D          557            lcall   READPORTS       ; ak ano, sme z nej uz prec?
0299 300AFA          558            jnb     MB2, $-3        ;       
029C D22F            559            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
029E 1205A2          560            lcall   WRITEPORTS      ;
02A1 0202A4          561            jmp     DOWN2_MB2     ;-; a prejdi do stavu DOWN2_MB2
02A4                 562    DOWN2_MB2:
02A4 12055D          563            lcall   READPORTS       ; nacitanie dat
                     564 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
02A7 200C02          565 +1         jb      SKRD, $+5
02AA 02050F          566 +1         ljmp    ERR_SKRD
02AD 00              567 +1         nop
                     569 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
02AE 200902          570 +1         jb      MB1, $+5
02B1 0204E2          571 +1         ljmp    ERR_1SPOM_C
02B4 00              572 +1         nop
02B5 200AEC          574            jb      MB2, DOWN2_MB2;-; mame uz aj druhu spomalovaciu clonku?          
02B8 D22E            575            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
02BA 1205A2          576            lcall   WRITEPORTS      ;
02BD E528            577            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
VYTAH/ORIDþ+©4,©4                                                                                          PAGE 11

02BF 5402            578            anl     A, #00000010b ;-;
02C1 600A            579            jz      DOWN2_MB1     ;-;       Ak nie, chod do stavu DOWN2_MB1
02C3 D223            580            setb    SLOW            ;       Ak ano, spomalme
02C5 C222            581            clr     FAST            ; 
02C7 1205A2          582            lcall   WRITEPORTS      ;
02CA 0202CD          583            jmp     DOWN2_MB1     ;-; a prejdi do stavu DOWN2_MB1
02CD                 584    DOWN2_MB1:    
02CD 12055D          585            lcall   READPORTS       ; nacitanie dat
02D0 300C05          586            jnb     SKRD, D2_MB1C   ; Sme na hornej porovnavacej clonke?
02D3 300902          587            jnb     MB1, D2_MB1C  ;-; Sme na zastavovacej clonke?
02D6 80F5            588            jmp     DOWN2_MB1       ; Ak sme nechytili ani jednu clonku, opakujeme
02D8 C221            589    D2_MB1C:clr     DOWN            ; zastav motor
02DA D23B            590            setb    DOWNOld         ;       (a zalohuj)
02DC C23A            591            clr     UPOld           ;       (a zalohuj)
02DE C222            592            clr     FAST            ; 
02E0 1205A2          593            lcall   WRITEPORTS      ; 
02E3 01BF            594            jmp     FLOOR1        ;-; a prejdi do stavu FLOOR2      
                     595    
                     596    
                     597    ;------------------------------------------------------------------------------- << 3. posch
                                                                               odie >>
                     598    
02E5                 599    FLOOR3:
                     600 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
02E5 C22F            601 +1         clr     LEDU            
02E7 C22E            602 +1         clr     LEDD 
02E9 C224            603 +1         clr     FLED1             
02EB C225            604 +1         clr     FLED2                
02ED C226            605 +1         clr     FLED3           
02EF C227            606 +1         clr     FLED4           
02F1 D226            607 +1         setb    FLED3
02F3 1205A2          608 +1         lcall   WRITEPORTS
02F6 12054C          610            lcall   WAITFORTIMER    ; simulacia TIMERu
02F9 12055D          611    F3S:    lcall   READPORTS     ;-; nacitanie dat
02FC C21B            612            clr     PKO3          ;-; vynulovanie volby poschodia na ktorom stojim
02FE 1205A2          613            lcall   WRITEPORTS      ;
                     614    
0301 7410            615            mov     A, #00010000b ;-; Default predpokladam, ze idem hore (na 4.)
0303 203A01          616            jb      UPOld, F3OK   ;-;   Je to pravda? Naozaj idem hore?
0306 F4              617            cpl     A               ;       Ak nie, znegujeme
0307 F5F0            618    F3OK:   mov     B, A            ; Masku dame do Bcka
                     619            
                     620            ; Pohyb v jednom smere (nevieme v ktorom)
0309 53F016          621            anl     B, #00010110b  ;-; este ju kozmeticky upravime
030C E528            622            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
030E 55F0            623            anl     A, B            ; tu ju pouzijeme       
0310 7014            624            jnz     F3              ; nasli sme poschodie v tomto smere
                     625            ; Pohyb v opacnom smere (nevieme v ktorom)
0312 B23A            626            cpl     UPOld           ;  Znegujem stary posun
0314 B23B            627            cpl     DOWNOld         ;  |
0316 E5F0            628            mov     A, B            ;  Znegujeme masku
0318 F4              629            cpl     A               ;  |
0319 F5F0            630            mov     B, A            ;  |
031B 53F016          631            anl     B, #00010110b  ;-; este ju kozmeticky upravime
031E E528            632            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
VYTAH/ORI oDZ,©4                                                                                              PAGE 12

0320 55F0            633            anl     A, B            ; tu ju pouzijeme       
0322 7002            634            jnz     F3              ; nasli sme poschodie v tomto smere
                     635            
0324 80D3            636            jmp     F3S           ;-; nemame sa kde hybat, tak opakujeme zistovanie
0326 203A03          637    F3:     jb      UPOld, F3UP     ;   
0329 020338          638            jmp     F3DOWN          ;
032C D220            639    F3UP:   setb    UP              ; rychly pohyb hore
032E D222            640            setb    FAST            ; 
0330 C223            641            clr     SLOW            ;
0332 1205A2          642            lcall   WRITEPORTS      ; 
0335 020344          643            jmp     UP3           ;-; prejdi do stavu UP2    
0338 D221            644    F3DOWN: setb    DOWN            ; rychly pohyb hore
033A D222            645            setb    FAST            ; 
033C C223            646            clr     SLOW            ;
033E 1205A2          647            lcall   WRITEPORTS      ; 
0341 0203B8          648            jmp     DOWN3         ;-; prejdi do stavu UP2    
                     649    
                     650            
                     651            
                     652            
                     653    ;        mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na kto
                                                                               rom stojim
                     654    ;        anl     A, #00010000b ;-;
                     655    ;        jz      F3S           ;-; ak nie, opakuj
                     656    ;        setb    UP              ; rychly pohyb hore
                     657    ;        setb    FAST            ; 
                     658    ;        lcall   WRITEPORTS      ; 
                     659    ;        jmp     UP3           ;-; prejdi do stavu UP3        
0344                 660    UP3:
                     661 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0344 C22F            662 +1         clr     LEDU            
0346 C22E            663 +1         clr     LEDD 
0348 C224            664 +1         clr     FLED1             
034A C225            665 +1         clr     FLED2                
034C C226            666 +1         clr     FLED3           
034E C227            667 +1         clr     FLED4           
0350 D226            668 +1         setb    FLED3
0352 1205A2          669 +1         lcall   WRITEPORTS
0355 12055D          671            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0358 3009FA          672            jnb     MB1, $-3        ;  |
035B 12055D          673    UP3A:   lcall   READPORTS       ; nacitanie dat
                     674 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
035E 200B02          675 +1         jb      SKRH, $+5
0361 02051E          676 +1         ljmp    ERR_SKRH
0364 00              677 +1         nop
                     679    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
0365 200AF3          680            jb      MB2, UP3A     ;-; mame uz 1. spomalovaciu clonku?
0368 12055D          681            lcall   READPORTS       ; ak ano, sme z nej uz prec?
036B 300AFA          682            jnb     MB2, $-3        ;       
036E D22E            683            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0370 1205A2          684            lcall   WRITEPORTS      ;
0373 020376          685            jmp     UP3_MB2       ;-; a prejdi do stavu UP3_MB2
0376                 686    UP3_MB2:
0376 12055D          687            lcall   READPORTS       ; nacitanie dat
                     688 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0379 200B02          689 +1         jb      SKRH, $+5
VYTAH/ORILDN-©4V-©4                                                                                          PAGE 13

037C 02051E          690 +1         ljmp    ERR_SKRH
037F 00              691 +1         nop
                     693 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
0380 200902          694 +1         jb      MB1, $+5
0383 0204E2          695 +1         ljmp    ERR_1SPOM_C
0386 00              696 +1         nop
0387 200AEC          698            jb      MB2, UP3_MB2  ;-; mame uz aj druhu spomalovaciu clonku?          
038A D22F            699            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
038C 1205A2          700            lcall   WRITEPORTS      ;
038F E528            701            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
0391 5410            702            anl     A, #00010000b ;-;
0393 600A            703            jz      UP3_MB1       ;-;       Ak nie, chod do stavu UP3_MB1
0395 D223            704            setb    SLOW            ;       Ak ano, spomalme
0397 C222            705            clr     FAST            ; 
0399 1205A2          706            lcall   WRITEPORTS      ;
039C 02039F          707            jmp     UP3_MB1       ;-; a prejdi do stavu UP3_MB1 
039F                 708    UP3_MB1:
039F 12055D          709            lcall   READPORTS       ; nacitanie dat
03A2 300B05          710            jnb     SKRH, U3_MB1C  ;  Sme na hornej porovnavacej clonke? (tu zastavujeme v kazdo
                                                                               m pripade)
03A5 300902          711            jnb     MB1, U3_MB1C  ;-; Sme na zastavovacej clonke? (tu zastavujeme v kazdom pripa
                                                                               de)
03A8 80F5            712            jmp     UP3_MB1         ; Ak sme nechytili ani jednu clonku, opakujeme. 
03AA C220            713    U3_MB1C:clr     UP              ; zastav motor
03AC D23A            714            setb    UPOld           ;       (a zalohuj)
03AE C23B            715            clr     DOWNOld         ;       (a zalohuj)
03B0 C222            716            clr     FAST            ; 
03B2 1205A2          717            lcall   WRITEPORTS      ; 
03B5 020436          718            jmp     FLOOR4        ;-; a prejdi do stavu FLOOR4   
03B8                 719    DOWN3:
                     720 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
03B8 C22F            721 +1         clr     LEDU            
03BA C22E            722 +1         clr     LEDD 
03BC C224            723 +1         clr     FLED1             
03BE C225            724 +1         clr     FLED2                
03C0 C226            725 +1         clr     FLED3           
03C2 C227            726 +1         clr     FLED4           
03C4 D226            727 +1         setb    FLED3
03C6 1205A2          728 +1         lcall   WRITEPORTS
03C9 12055D          730            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
03CC 3009FA          731            jnb     MB1, $-3        ;  |
03CF 12055D          732            lcall   READPORTS       ; nacitanie dat
                     733 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
03D2 200C02          734 +1         jb      SKRD, $+5
03D5 02050F          735 +1         ljmp    ERR_SKRD
03D8 00              736 +1         nop
                     738    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
03D9 200ADC          739            jb      MB2, DOWN3    ;-; mame uz 1. spomalovaciu clonku?
03DC 12055D          740            lcall   READPORTS       ; ak ano, sme z nej uz prec?
03DF 300AFA          741            jnb     MB2, $-3        ;       
03E2 D22F            742            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
03E4 1205A2          743            lcall   WRITEPORTS      ;
03E7 0203EA          744            jmp     DOWN3_MB2     ;-; a prejdi do stavu DOWN3_MB2
03EA                 745    DOWN3_MB2:
03EA 12055D          746            lcall   READPORTS       ; nacitanie dat
VYTAH/ORI:D®.©4¶.©4                                                                                          PAGE 14

                     747 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
03ED 200C02          748 +1         jb      SKRD, $+5
03F0 02050F          749 +1         ljmp    ERR_SKRD
03F3 00              750 +1         nop
                     752 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
03F4 200902          753 +1         jb      MB1, $+5
03F7 0204E2          754 +1         ljmp    ERR_1SPOM_C
03FA 00              755 +1         nop
03FB 200AEC          757            jb      MB2, DOWN3_MB2;-; mame uz aj druhu spomalovaciu clonku?          
03FE D22E            758            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
0400 1205A2          759            lcall   WRITEPORTS      ;
0403 E528            760            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
0405 5404            761            anl     A, #00000100b ;-;
0407 600A            762            jz      DOWN3_MB1     ;-;       Ak nie, chod do stavu DOWN3_MB1
0409 D223            763            setb    SLOW            ;       Ak ano, spomalme
040B C222            764            clr     FAST            ; 
040D 1205A2          765            lcall   WRITEPORTS      ;
0410 020413          766            jmp     DOWN3_MB1     ;-; a prejdi do stavu DOWN3_MB1
0413                 767    DOWN3_MB1:    
0413 12055D          768            lcall   READPORTS       ; nacitanie dat
                     769 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
0416 200C02          770 +1         jb      SKRD, $+5
0419 02050F          771 +1         ljmp    ERR_SKRD
041C 00              772 +1         nop
                     774    ;        ljnb    MB2, ERR_ZAST_C ; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na sp
                                                                               omalovaciu) <<<
041D 2009F3          775            jb      MB1, DOWN3_MB1;-; Sme na zastavovacej clonke?
0420 E528            776            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
0422 5404            777            anl     A, #00000100b ;-;
0424 7003            778            jnz     D3_MB1C         ; Ak nie, chod do stavu DOWN2
0426 020272          779            ljmp    DOWN2         ;-; |
0429 C221            780    D3_MB1C:clr     DOWN            ; zastav motor
042B D23B            781            setb    DOWNOld         ;       (a zalohuj)
042D C23A            782            clr     UPOld           ;       (a zalohuj)
042F C222            783            clr     FAST            ; 
0431 1205A2          784            lcall   WRITEPORTS      ; 
0434 2194            785            jmp     FLOOR2        ;-; a prejdi do stavu FLOOR2      
                     786          
                     787            
                     788    ;------------------------------------------------------------------------------- << 4. posch
                                                                               odie >>
                     789    
0436                 790    FLOOR4:
                     791 +1                 POLOHA_LED 4  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0436 C22F            792 +1         clr     LEDU            
0438 C22E            793 +1         clr     LEDD 
043A C224            794 +1         clr     FLED1             
043C C225            795 +1         clr     FLED2                
043E C226            796 +1         clr     FLED3           
0440 C227            797 +1         clr     FLED4           
0442 D227            798 +1         setb    FLED4
0444 1205A2          799 +1         lcall   WRITEPORTS
0447 12054C          801            lcall   WAITFORTIMER    ; simulacia TIMERu
044A 12055D          802    F4S:    lcall   READPORTS     ;-; nacitanie dat
044D C21C            803            clr     PKO4          ;-; vynulovanie volby poschodia na ktorom stojim
044F 1205A2          804            lcall   WRITEPORTS      ;
VYTAH/ORI !DÂ/©4                                                                                              PAGE 15

0452 E528            805            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco menej ako poschodie na kto
                                                                               rom stojim
0454 540E            806            anl     A, #00001110b ;-;
0456 60F2            807            jz      F4S           ;-; ak nie, opakuj
0458 D221            808            setb    DOWN            ; rychly pohyb dole
045A D222            809            setb    FAST            ;
045C C223            810            clr     SLOW            ; 
045E 1205A2          811            lcall   WRITEPORTS      ; 
0461 020464          812            jmp     DOWN4         ;-; prejdi do stavu DOWN4 
0464                 813    DOWN4:
                     814 +1                 POLOHA_LED 4  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0464 C22F            815 +1         clr     LEDU            
0466 C22E            816 +1         clr     LEDD 
0468 C224            817 +1         clr     FLED1             
046A C225            818 +1         clr     FLED2                
046C C226            819 +1         clr     FLED3           
046E C227            820 +1         clr     FLED4           
0470 D227            821 +1         setb    FLED4
0472 1205A2          822 +1         lcall   WRITEPORTS
0475 12055D          824            lcall   READPORTS       ;  | Odisli sme uz zo zastavovacej clonky nasho poschodia?
0478 3009FA          825            jnb     MB1, $-3        ;  |
                     826            
047B 12055D          827            lcall   READPORTS       ; nacitanie dat
                     828 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
047E 200C02          829 +1         jb      SKRD, $+5
0481 02050F          830 +1         ljmp    ERR_SKRD
0484 00              831 +1         nop
                     833    ;        ljnb    MB1, ERR_2SPOM_C; >>> CHYBA, Vypadli 2 spomalovacie clonky (narazil som na 
                                                                               zastavovaciu) <<<
0485 200ADC          834            jb      MB2, DOWN4    ;-; mame uz 1. spomalovaciu clonku?
0488 12055D          835            lcall   READPORTS       ; ak ano, sme z nej uz prec?
048B 300AFA          836            jnb     MB2, $-3        ;       
048E D22F            837            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0490 1205A2          838            lcall   WRITEPORTS      ;
0493 020496          839            jmp     DOWN4_MB2     ;-; a prejdi do stavu DOWN4_MB2
0496                 840    DOWN4_MB2:
0496 12055D          841            lcall   READPORTS       ; nacitanie dat
                     842 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
0499 200C02          843 +1         jb      SKRD, $+5
049C 02050F          844 +1         ljmp    ERR_SKRD
049F 00              845 +1         nop
                     847 +1         ljnb    MB1, ERR_1SPOM_C; >>> CHYBA, Vypadla spomalovacia clonka (narazil som na zas
                                                                               tavovaciu) <<<
04A0 200902          848 +1         jb      MB1, $+5
04A3 0204E2          849 +1         ljmp    ERR_1SPOM_C
04A6 00              850 +1         nop
04A7 200AEC          852            jb      MB2, DOWN4_MB2;-; mame uz aj druhu spomalovaciu clonku?          
04AA D22E            853            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
04AC 1205A2          854            lcall   WRITEPORTS      ;
04AF E528            855            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
04B1 5408            856            anl     A, #00001000b ;-;
04B3 600A            857            jz      DOWN4_MB1     ;-;       Ak nie, chod do stavu DOWN4_MB1
04B5 D223            858            setb    SLOW            ;       Ak ano, spomalme
04B7 C222            859            clr     FAST            ; 
04B9 1205A2          860            lcall   WRITEPORTS      ;
04BC 0204BF          861            jmp     DOWN4_MB1     ;-; a prejdi do stavu DOWN4_MB1
04BF                 862    DOWN4_MB1:    
VYTAH/ORI D1©41©4                                                                                          PAGE 16

04BF 12055D          863            lcall   READPORTS       ; nacitanie dat
                     864 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
04C2 200C02          865 +1         jb      SKRD, $+5
04C5 02050F          866 +1         ljmp    ERR_SKRD
04C8 00              867 +1         nop
                     869    ;        ljnb    MB2, ERR_ZAST_C; >>> CHYBA, Vypadla zastavovacia clonka (narazil som na spo
                                                                               malovaciu) <<<
04C9 2009F3          870            jb      MB1, DOWN4_MB1 ;-; Sme na zastavovacej clonke?
04CC E528            871            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
04CE 5408            872            anl     A, #00001000b ;-;
04D0 7003            873            jnz     D4_MB1C         ; Ak nie, chod do stavu DOWN3
04D2 0203B8          874            ljmp    DOWN3         ;-; |
04D5 C221            875    D4_MB1C:clr     DOWN            ; zastav motor
04D7 D23B            876            setb    DOWNOld         ;       (a zalohuj)
04D9 C23A            877            clr     UPOld           ;       (a zalohuj)
04DB C222            878            clr     FAST            ; 
04DD 1205A2          879            lcall   WRITEPORTS      ; 
04E0 41E5            880            jmp     FLOOR3        ;-; a prejdi do stavu FLOOR3                 
                     881                    
                     882      
04E2                 883    ERR_1SPOM_C: 
04E2 C220            884            clr     UP              ; zastav motor
04E4 C221            885            clr     DOWN            ; 
04E6 1205A2          886            lcall   WRITEPORTS      ; 
                     887 +1         _BP_
04E9 C2B3            888 +1         clr     P3.3
04EB D2AA            889 +1         setb    EX1
04ED 00              890 +1         nop
04EE 00              891 +1         nop
04EF 00              893            nop
04F0 00              894            nop 
                     895            
04F1                 896    ERR_2SPOM_C: 
04F1 C220            897            clr     UP              ; zastav motor
04F3 C221            898            clr     DOWN            ; 
04F5 1205A2          899            lcall   WRITEPORTS      ; 
                     900 +1         _BP_
04F8 C2B3            901 +1         clr     P3.3
04FA D2AA            902 +1         setb    EX1
04FC 00              903 +1         nop
04FD 00              904 +1         nop
04FE 00              906            nop
04FF 00              907            nop 
                     908            
0500                 909    ERR_ZAST_C: 
0500 C220            910            clr     UP              ; zastav motor
0502 C221            911            clr     DOWN            ; 
0504 1205A2          912            lcall   WRITEPORTS      ; 
                     913 +1         _BP_
0507 C2B3            914 +1         clr     P3.3
0509 D2AA            915 +1         setb    EX1
050B 00              916 +1         nop
050C 00              917 +1         nop
050D 00              919            nop
050E 00              920            nop 
                     921            
050F                 922    ERR_SKRD: 
050F C220            923            clr     UP              ; zastav motor
VYTAH/ORI `D                                                                                                  PAGE 17

0511 C221            924            clr     DOWN            ; 
0513 1205A2          925            lcall   WRITEPORTS      ; 
                     926 +1         _BP_
0516 C2B3            927 +1         clr     P3.3
0518 D2AA            928 +1         setb    EX1
051A 00              929 +1         nop
051B 00              930 +1         nop
051C 00              932            nop
051D 00              933            nop    
                     934            
051E                 935    ERR_SKRH: 
051E C220            936            clr     UP              ; zastav motor
0520 C221            937            clr     DOWN            ; 
0522 1205A2          938            lcall   WRITEPORTS      ; 
                     939 +1         _BP_
0525 C2B3            940 +1         clr     P3.3
0527 D2AA            941 +1         setb    EX1
0529 00              942 +1         nop
052A 00              943 +1         nop
052B 00              945            nop
052C 00              946            nop             
                     947                    
                     948                    
052D                 949    ENDPROG:
052D D218            950            setb    KS
052F 1205A2          951            call    WRITEPORTS                ; zapis novu informaciu
                     952 +1         _BP_
0532 C2B3            953 +1         clr     P3.3
0534 D2AA            954 +1         setb    EX1
0536 00              955 +1         nop
0537 00              956 +1         nop
0538 22              958            ret
                     959            
                     960    ; rutina time delay 1 ms pre oscilator s frekvenciou 11.0592 MHz
                     961    ; 1 instrukcia 2 takty? => 11.0592/2 = pocet instrukcii potrebnych na 1 sekundu
                     962    ; 11.0592MHz/2000 = zdrzanie 1 ms
0539                 963    TIME1MS:
0539 7BFF            964            mov     R3,#0FFh        ; prva cast slucky pre time delay
053B DBFE            965    TIME1:  djnz    R3,TIME1        ; prvy cyklus
053D 00              966            nop                     ; jeden prazdny takt
053E 7BCB            967            mov     R3,#0CBh        ; druha cast slucky pre time delay
0540 DBFE            968    TIME2:  djnz    R3,TIME2        ; druhy cyklus
0542 22              969            ret                     ; koniec
                     970            
                     971            
                     972    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     973    ; DELAY
                     974    ; Pocka na stlacenie tlacidla na 1. poschodi  - signal PO1 (v buducnosti to 
                     975    ; bude timer)
                     976    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
0543                 977    DELAY:
0543 7900            978            mov     R1, #0 
0545 7AFF            979            mov     R2, #0ffh
0547 D9FE            980            djnz    R1, $
0549 DAFC            981            djnz    R2, $-2
054B 22              982            ret
                     983    
                     984    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
VYTAH/ORI                                                                                                     PAGE 18

                     985    ; WAITFORTIMER
                     986    ; Pocka na stlacenie tlacidla na 1. poschodi  - signal PO1 (v buducnosti to 
                     987    ; bude timer)
                     988    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
054C                 989    WAITFORTIMER:
054C D22C            990            setb    PO3U                        ; rozsvieti indikator cakania (poschodie 4)
054E 1205A2          991            lcall   WRITEPORTS                  ;
0551 12055D          992    WAIT:   lcall   READPORTS                   ; 
0554 3013F5          993            jnb     PI3D, WAITFORTIMER          ; ak nebolo stlacene tlacidlo PO1, cakaj 
0557 C22C            994            clr     PO3U                         ; zhasne indikator cakania (poschodie 4)
0559 1205A2          995            lcall   WRITEPORTS
055C 22              996            ret
                     997    
                     998    
                     999    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1000    ; READPORTS
                    1001    ; precita nove hodnoty na portoch
                    1002    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
055D                1003    READPORTS:
055D 75A080         1004            mov     p2, #i8255INA       ; citaj data z portu A
0560 75803F         1005            mov     p0, #(bmSTOP or bmPKI1 or bmPKI2 or bmPKI3 or bmPKI4 or bmDOORCLSD)
0563 C2B7           1006            clr     RDNOT
0565 00             1007            nop
0566 00             1008            nop
0567 00             1009            nop
0568 00             1010            nop
0569 858028         1011            mov     INPORTA, p0         ; uloz informaciu z datovej zbernice 
056C D2B7           1012            setb    RDNOT
                    1013            
056E 75A081         1014            mov     p2, #i8255INB       ; citaj data z portu B
0571 7580FE         1015            mov     p0, #(bmMB1I or bmMB2I or bmSKRHI or bmSKRHD or bmDPI or bmDPKI or bmDPZKI)
                                                                               
0574 C2B7           1016            clr     RDNOT
0576 00             1017            nop
0577 00             1018            nop
0578 00             1019            nop
0579 00             1020            nop
057A 858021         1021            mov     INPORTB, p0         ; uloz informaciu z datovej zbernice 
057D D2B7           1022            setb    RDNOT
                    1023    
057F 75A082         1024            mov     p2, #i8255INC       ; citaj data z portu C
0582 75803F         1025            mov     p0, #(bmPI1 or bmPI2D or bmPI2U or bmPI3D or bmPI3U or bmPI4)
0585 C2B7           1026            clr     RDNOT
0587 00             1027            nop
0588 00             1028            nop
0589 00             1029            nop
058A 00             1030            nop
058B 858022         1031            mov     INPORTC, p0         ; uloz informaciu z datovej zbernice 
058E D2B7           1032            setb    RDNOT
0590 00             1033            nop
0591 00             1034            nop
0592 00             1035            nop
0593 00             1036            nop
0594 00             1037            nop
0595 00             1038            nop
0596 00             1039            nop
0597 00             1040            nop
0598 E528           1041            mov     A, INPORTA
VYTAH/ORIiD                                                                                                  PAGE 19

059A 541E           1042            anl     A, #00011110b
059C 4223           1043            orl     OUTPORTA, A
059E 1205A2         1044            call    WRITEPORTS              ; aktualizuj signalizaciu na ovladacom paneli
                    1045            
05A1 22             1046            ret
                    1047            
                    1048    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1049    ; WRITEPORTS
                    1050    ; spravi zalohu vystupnych registrov a posle data von
                    1051    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
05A2                1052    WRITEPORTS:
05A2 852380         1053            mov     p0, OUTPORTA        ; teraz postupne posli data najprv na port A,
05A5 75A0C0         1054            mov     p2, #i8255OUTA
05A8 C2B6           1055            clr     WRNOT
05AA 00             1056            nop
05AB 00             1057            nop
05AC 00             1058            nop
05AD 00             1059            nop
05AE D2B6           1060            setb    WRNOT
                    1061            
05B0 852480         1062            mov     p0, OUTPORTB        ; potom port B
05B3 75A0C1         1063            mov     p2, #i8255OUTB
05B6 C2B6           1064            clr     WRNOT
05B8 00             1065            nop
05B9 00             1066            nop
05BA 00             1067            nop
05BB 00             1068            nop
05BC D2B6           1069            setb    WRNOT
                    1070    
05BE 852580         1071            mov     p0, OUTPORTC        ; a nakoniec port C
05C1 75A0C2         1072            mov     p2, #i8255OUTC
05C4 C2B6           1073            clr     WRNOT
05C6 00             1074            nop
05C7 00             1075            nop
05C8 00             1076            nop
05C9 00             1077            nop
05CA D2B6           1078            setb    WRNOT
05CC 00             1079            nop
05CD 00             1080            nop
05CE 00             1081            nop
05CF 00             1082            nop
05D0 00             1083            nop
05D1 00             1084            nop
05D2 00             1085            nop
05D3 00             1086            nop
05D4 22             1087            ret
                    1088    
                    1089    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1090    
05D5 0D0A5269       1091    STR_INIT:   db  0dh, 0ah, 'Riadiaci system je inicializovany.', 0dh, 0ah, 00h
05D9 61646961   
05DD 63692073   
05E1 79737465   
05E5 6D206A65   
05E9 20696E69   
05ED 6369616C   
05F1 697A6F76   
05F5 616E792E   
VYTAH/ORIM'D                                                                                                  PAGE 20

05F9 0D0A00     
05FC 52696164       1092    STR_STOP:   db  'Riadiaci system je reinicializovany po stlaceni tlacidla STOP.', 0dh, 0ah, 
                                                                               00h
0600 69616369   
0604 20737973   
0608 74656D20   
060C 6A652072   
0610 65696E69   
0614 6369616C   
0618 697A6F76   
061C 616E7920   
0620 706F2073   
0624 746C6163   
0628 656E6920   
062C 746C6163   
0630 69646C61   
0634 2053544F   
0638 502E0D0A   
063C 00         
063D 4B616C69       1093    STR_CALIB:  db  'Kalibracia vytahu je ukoncena.', 0dh, 0ah, 00h
0641 62726163   
0645 69612076   
0649 79746168   
064D 75206A65   
0651 20756B6F   
0655 6E63656E   
0659 612E0D0A   
065D 00         
                    1094    
----                1095            DSEG
0040                1096            org     40h
0040                1097    STACK:  DS      10h
                    1098    
                    1099    end

VERSION 1.2h ASSEMBLY COMPLETE, 0 ERRORS FOUND
VYTAH/ORI                                                                                                     PAGE 21

B. . . . . . . . . . . . . . . .  D ADDR  00F0H  PREDEFINED  
BMDOORCLSD . . . . . . . . . . .    NUMB  0020H  
BMDOWN . . . . . . . . . . . . .    NUMB  0002H  NOT USED  
BMDPI. . . . . . . . . . . . . .    NUMB  0020H  
BMDPKI . . . . . . . . . . . . .    NUMB  0080H  
BMDPZKI. . . . . . . . . . . . .    NUMB  0040H  
BMFAST . . . . . . . . . . . . .    NUMB  0004H  NOT USED  
BMFLED1. . . . . . . . . . . . .    NUMB  0010H  
BMFLED2. . . . . . . . . . . . .    NUMB  0020H  
BMFLED3. . . . . . . . . . . . .    NUMB  0040H  
BMFLED4. . . . . . . . . . . . .    NUMB  0080H  
BMKS . . . . . . . . . . . . . .    NUMB  0001H  NOT USED  
BMLEDD . . . . . . . . . . . . .    NUMB  0040H  
BMLEDU . . . . . . . . . . . . .    NUMB  0080H  
BMMB1I . . . . . . . . . . . . .    NUMB  0002H  
BMMB2I . . . . . . . . . . . . .    NUMB  0004H  
BMPI1. . . . . . . . . . . . . .    NUMB  0001H  
BMPI2D . . . . . . . . . . . . .    NUMB  0002H  
BMPI2U . . . . . . . . . . . . .    NUMB  0004H  
BMPI3D . . . . . . . . . . . . .    NUMB  0008H  
BMPI3U . . . . . . . . . . . . .    NUMB  0010H  
BMPI4. . . . . . . . . . . . . .    NUMB  0020H  
BMPKI1 . . . . . . . . . . . . .    NUMB  0002H  
BMPKI2 . . . . . . . . . . . . .    NUMB  0004H  
BMPKI3 . . . . . . . . . . . . .    NUMB  0008H  
BMPKI4 . . . . . . . . . . . . .    NUMB  0010H  
BMPKO1 . . . . . . . . . . . . .    NUMB  0002H  
BMPKO2 . . . . . . . . . . . . .    NUMB  0004H  
BMPKO3 . . . . . . . . . . . . .    NUMB  0008H  
BMPKO4 . . . . . . . . . . . . .    NUMB  0010H  
BMPO1. . . . . . . . . . . . . .    NUMB  0001H  
BMPO2D . . . . . . . . . . . . .    NUMB  0002H  
BMPO2U . . . . . . . . . . . . .    NUMB  0004H  
BMPO3D . . . . . . . . . . . . .    NUMB  0008H  
BMPO3U . . . . . . . . . . . . .    NUMB  0010H  
BMPO4. . . . . . . . . . . . . .    NUMB  0020H  
BMSKRHD. . . . . . . . . . . . .    NUMB  0010H  
BMSKRHI. . . . . . . . . . . . .    NUMB  0008H  
BMSLOW . . . . . . . . . . . . .    NUMB  0008H  NOT USED  
BMSTOP . . . . . . . . . . . . .    NUMB  0001H  
BMUP . . . . . . . . . . . . . .    NUMB  0001H  NOT USED  
CALIB. . . . . . . . . . . . . .  C ADDR  0096H  NOT USED  
CALIBEND . . . . . . . . . . . .  C ADDR  00ADH  
CALIBLOOP. . . . . . . . . . . .  C ADDR  00A5H  
CANGO. . . . . . . . . . . . . .  B ADDR  0038H  NOT USED  
CTRLREG. . . . . . . . . . . . .  D ADDR  0027H  
D2_MB1C. . . . . . . . . . . . .  C ADDR  02D8H  
D3_MB1C. . . . . . . . . . . . .  C ADDR  0429H  
D4_MB1C. . . . . . . . . . . . .  C ADDR  04D5H  
DELAY. . . . . . . . . . . . . .  C ADDR  0543H  NOT USED  
DOORCLSD . . . . . . . . . . . .  B ADDR  0045H  NOT USED  
DOORCLSDOLD. . . . . . . . . . .  B ADDR  0039H  NOT USED  
DOWN . . . . . . . . . . . . . .  B ADDR  0021H  
DOWN2. . . . . . . . . . . . . .  C ADDR  0272H  
DOWN2_MB1. . . . . . . . . . . .  C ADDR  02CDH  
DOWN2_MB2. . . . . . . . . . . .  C ADDR  02A4H  
DOWN3. . . . . . . . . . . . . .  C ADDR  03B8H  
DOWN3_MB1. . . . . . . . . . . .  C ADDR  0413H  
VYTAH/ORI                                                                                                     PAGE 22

DOWN3_MB2. . . . . . . . . . . .  C ADDR  03EAH  
DOWN4. . . . . . . . . . . . . .  C ADDR  0464H  
DOWN4_MB1. . . . . . . . . . . .  C ADDR  04BFH  
DOWN4_MB2. . . . . . . . . . . .  C ADDR  0496H  
DOWNOLD. . . . . . . . . . . . .  B ADDR  003BH  
DP . . . . . . . . . . . . . . .  B ADDR  000DH  NOT USED  
DPK. . . . . . . . . . . . . . .  B ADDR  000FH  NOT USED  
DPZK . . . . . . . . . . . . . .  B ADDR  000EH  NOT USED  
ENDPROG. . . . . . . . . . . . .  C ADDR  052DH  NOT USED  
ERR_1SPOM_C. . . . . . . . . . .  C ADDR  04E2H  
ERR_2SPOM_C. . . . . . . . . . .  C ADDR  04F1H  NOT USED  
ERR_SKRD . . . . . . . . . . . .  C ADDR  050FH  
ERR_SKRH . . . . . . . . . . . .  C ADDR  051EH  
ERR_ZAST_C . . . . . . . . . . .  C ADDR  0500H  
EX1. . . . . . . . . . . . . . .  B ADDR  00AAH  PREDEFINED  
F1S. . . . . . . . . . . . . . .  C ADDR  00D3H  
F2 . . . . . . . . . . . . . . .  C ADDR  01D5H  
F2DOWN . . . . . . . . . . . . .  C ADDR  01E7H  
F2OK . . . . . . . . . . . . . .  C ADDR  01B6H  
F2S. . . . . . . . . . . . . . .  C ADDR  01A8H  
F2UP . . . . . . . . . . . . . .  C ADDR  01DBH  
F3 . . . . . . . . . . . . . . .  C ADDR  0326H  
F3DOWN . . . . . . . . . . . . .  C ADDR  0338H  
F3OK . . . . . . . . . . . . . .  C ADDR  0307H  
F3S. . . . . . . . . . . . . . .  C ADDR  02F9H  
F3UP . . . . . . . . . . . . . .  C ADDR  032CH  
F4S. . . . . . . . . . . . . . .  C ADDR  044AH  
FAST . . . . . . . . . . . . . .  B ADDR  0022H  
FASTOLD. . . . . . . . . . . . .  B ADDR  003CH  NOT USED  
FLED1. . . . . . . . . . . . . .  B ADDR  0024H  
FLED2. . . . . . . . . . . . . .  B ADDR  0025H  
FLED3. . . . . . . . . . . . . .  B ADDR  0026H  
FLED4. . . . . . . . . . . . . .  B ADDR  0027H  
FLOOR1 . . . . . . . . . . . . .  C ADDR  00BFH  
FLOOR2 . . . . . . . . . . . . .  C ADDR  0194H  
FLOOR3 . . . . . . . . . . . . .  C ADDR  02E5H  
FLOOR4 . . . . . . . . . . . . .  C ADDR  0436H  
FLOORREQ . . . . . . . . . . . .  D ADDR  0036H  
HIGHEST. . . . . . . . . . . . .  D ADDR  0032H  NOT USED  
I8255INA . . . . . . . . . . . .    NUMB  0080H  
I8255INB . . . . . . . . . . . .    NUMB  0081H  
I8255INC . . . . . . . . . . . .    NUMB  0082H  
I8255INCW. . . . . . . . . . . .    NUMB  0083H  
I8255OUTA. . . . . . . . . . . .    NUMB  00C0H  
I8255OUTB. . . . . . . . . . . .    NUMB  00C1H  
I8255OUTC. . . . . . . . . . . .    NUMB  00C2H  
I8255OUTCW . . . . . . . . . . .    NUMB  00C3H  
INPORTA. . . . . . . . . . . . .  D ADDR  0028H  
INPORTB. . . . . . . . . . . . .  D ADDR  0021H  
INPORTBOLD . . . . . . . . . . .  D ADDR  0026H  
INPORTC. . . . . . . . . . . . .  D ADDR  0022H  
KS . . . . . . . . . . . . . . .  B ADDR  0018H  
LEDD . . . . . . . . . . . . . .  B ADDR  002EH  
LEDU . . . . . . . . . . . . . .  B ADDR  002FH  
LOWEST . . . . . . . . . . . . .  D ADDR  0031H  NOT USED  
MAIN . . . . . . . . . . . . . .  C ADDR  00BFH  NOT USED  
MB1. . . . . . . . . . . . . . .  B ADDR  0009H  
MB1OLD . . . . . . . . . . . . .  B ADDR  0031H  NOT USED  
VYTAH/ORI                                                                                                     PAGE 23

MB2. . . . . . . . . . . . . . .  B ADDR  000AH  
MB2OLD . . . . . . . . . . . . .  B ADDR  0032H  NOT USED  
OUTPORTA . . . . . . . . . . . .  D ADDR  0023H  
OUTPORTB . . . . . . . . . . . .  D ADDR  0024H  
OUTPORTBOLD. . . . . . . . . . .  D ADDR  0034H  NOT USED  
OUTPORTC . . . . . . . . . . . .  D ADDR  0025H  
P0 . . . . . . . . . . . . . . .  D ADDR  0080H  PREDEFINED  
P2 . . . . . . . . . . . . . . .  D ADDR  00A0H  PREDEFINED  
P3 . . . . . . . . . . . . . . .  D ADDR  00B0H  PREDEFINED  
PI1. . . . . . . . . . . . . . .  B ADDR  0010H  NOT USED  
PI2D . . . . . . . . . . . . . .  B ADDR  0011H  NOT USED  
PI2U . . . . . . . . . . . . . .  B ADDR  0012H  NOT USED  
PI3D . . . . . . . . . . . . . .  B ADDR  0013H  
PI3U . . . . . . . . . . . . . .  B ADDR  0014H  NOT USED  
PI4. . . . . . . . . . . . . . .  B ADDR  0015H  NOT USED  
PKI1 . . . . . . . . . . . . . .  B ADDR  0041H  NOT USED  
PKI2 . . . . . . . . . . . . . .  B ADDR  0042H  NOT USED  
PKI3 . . . . . . . . . . . . . .  B ADDR  0043H  NOT USED  
PKI4 . . . . . . . . . . . . . .  B ADDR  0044H  NOT USED  
PKO1 . . . . . . . . . . . . . .  B ADDR  0019H  
PKO2 . . . . . . . . . . . . . .  B ADDR  001AH  
PKO3 . . . . . . . . . . . . . .  B ADDR  001BH  
PKO4 . . . . . . . . . . . . . .  B ADDR  001CH  
PO1. . . . . . . . . . . . . . .  B ADDR  0028H  NOT USED  
PO2D . . . . . . . . . . . . . .  B ADDR  0029H  NOT USED  
PO2U . . . . . . . . . . . . . .  B ADDR  002AH  NOT USED  
PO3D . . . . . . . . . . . . . .  B ADDR  002BH  NOT USED  
PO3U . . . . . . . . . . . . . .  B ADDR  002CH  
PO4. . . . . . . . . . . . . . .  B ADDR  002DH  NOT USED  
POSITION . . . . . . . . . . . .  D ADDR  0030H  NOT USED  
RDNOT. . . . . . . . . . . . . .  B ADDR  00B7H  
READPORTS. . . . . . . . . . . .  C ADDR  055DH  
RESET. . . . . . . . . . . . . .  C ADDR  0033H  NOT USED  
SKRD . . . . . . . . . . . . . .  B ADDR  000CH  
SKRDOLD. . . . . . . . . . . . .  B ADDR  0034H  NOT USED  
SKRH . . . . . . . . . . . . . .  B ADDR  000BH  
SKRHOLD. . . . . . . . . . . . .  B ADDR  0033H  NOT USED  
SLOW . . . . . . . . . . . . . .  B ADDR  0023H  
SLOWOLD. . . . . . . . . . . . .  B ADDR  003DH  NOT USED  
SP . . . . . . . . . . . . . . .  D ADDR  0081H  PREDEFINED  
STACK. . . . . . . . . . . . . .  D ADDR  0040H  
START. . . . . . . . . . . . . .  C ADDR  0033H  
STOPNOT. . . . . . . . . . . . .  B ADDR  0040H  NOT USED  
STOPTIMER. . . . . . . . . . . .  D ADDR  0033H  
STR_CALIB. . . . . . . . . . . .  C ADDR  063DH  NOT USED  
STR_INIT . . . . . . . . . . . .  C ADDR  05D5H  NOT USED  
STR_STOP . . . . . . . . . . . .  C ADDR  05FCH  NOT USED  
TIME1. . . . . . . . . . . . . .  C ADDR  053BH  
TIME1MS. . . . . . . . . . . . .  C ADDR  0539H  
TIME2. . . . . . . . . . . . . .  C ADDR  0540H  
TIMERCONST . . . . . . . . . . .    NUMB  00FAH  NOT USED  
U2_MB1C. . . . . . . . . . . . .  C ADDR  0264H  
U3_MB1C. . . . . . . . . . . . .  C ADDR  03AAH  
UP . . . . . . . . . . . . . . .  B ADDR  0020H  
UP1. . . . . . . . . . . . . . .  C ADDR  00EDH  
UP1A . . . . . . . . . . . . . .  C ADDR  0104H  
UP1_MB1. . . . . . . . . . . . .  C ADDR  016CH  
UP1_MB2. . . . . . . . . . . . .  C ADDR  011FH  
VYTAH/ORI                                                                                                     PAGE 24

UP2. . . . . . . . . . . . . . .  C ADDR  01F3H  
UP2A . . . . . . . . . . . . . .  C ADDR  020AH  
UP2_MB1. . . . . . . . . . . . .  C ADDR  024EH  
UP2_MB2. . . . . . . . . . . . .  C ADDR  0225H  
UP3. . . . . . . . . . . . . . .  C ADDR  0344H  
UP3A . . . . . . . . . . . . . .  C ADDR  035BH  
UP3_MB1. . . . . . . . . . . . .  C ADDR  039FH  
UP3_MB2. . . . . . . . . . . . .  C ADDR  0376H  
UPOLD. . . . . . . . . . . . . .  B ADDR  003AH  
WAIT . . . . . . . . . . . . . .  C ADDR  0551H  NOT USED  
WAITFORTIMER . . . . . . . . . .  C ADDR  054CH  
WRITEPORTS . . . . . . . . . . .  C ADDR  05A2H  
WRNOT. . . . . . . . . . . . . .  B ADDR  00B6H  
