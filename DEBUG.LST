VYTAH/ORI                                                                                                     PAGE 1

                       1    $MOD51
                       2    $DEBUG
                       3    
                =1     4    $include (lift.inc)
                =1     5    ; adresy I/O portov, ktore pridu na port P2 89C52-ky
  0080          =1     6    i8255INA        equ     080h
  0081          =1     7    i8255INB        equ     081h
  0082          =1     8    i8255INC        equ     082h
  0083          =1     9    i8255INCW       equ     083h
  00C0          =1    10    i8255OUTA       equ     0c0h
  00C1          =1    11    i8255OUTB       equ     0c1h
  00C2          =1    12    i8255OUTC       equ     0c2h
  00C3          =1    13    i8255OUTCW      equ     0c3h
                =1    14    
  0028          =1    15    INPORTA         data    28h         ; nutne kvoli emulatoru!!!
  0021          =1    16    INPORTB         data    21h
  0022          =1    17    INPORTC         data    22h
  0023          =1    18    OUTPORTA        data    23h
  0024          =1    19    OUTPORTB        data    24h
  0025          =1    20    OUTPORTC        data    25h
  0026          =1    21    INPORTBold      data    26h
  0027          =1    22    CTRLREG         data    27h
                =1    23    
  0030          =1    24    POSITION        data    30h
  0031          =1    25    LOWEST          data    31h
  0032          =1    26    HIGHEST         data    32h
  0033          =1    27    STOPTIMER       data    33h
  0034          =1    28    OUTPORTBold     data    34h
                =1    29    
  0040          =1    30    STOPNOT         bit     INPORTA.0
  0041          =1    31    PKI1            bit     INPORTA.1
  0042          =1    32    PKI2            bit     INPORTA.2
  0043          =1    33    PKI3            bit     INPORTA.3
  0044          =1    34    PKI4            bit     INPORTA.4
  0045          =1    35    DOORCLSD        bit     INPORTA.5 
                =1    36    
  0009          =1    37    MB1             bit     INPORTB.1       ; clonky maju invertovanu logiku
  000A          =1    38    MB2             bit     INPORTB.2
  000B          =1    39    SKRH            bit     INPORTB.3
  000C          =1    40    SKRD            bit     INPORTB.4
  000D          =1    41    DP              bit     INPORTB.5
  000E          =1    42    DPZK            bit     INPORTB.6
  000F          =1    43    DPK             bit     INPORTB.7
                =1    44    
  0031          =1    45    MB1old          bit     INPORTBold.1
  0032          =1    46    MB2old          bit     INPORTBold.2
  0033          =1    47    SKRHold         bit     INPORTBold.3
  0034          =1    48    SKRDold         bit     INPORTBold.4
                =1    49    
  0010          =1    50    PI1             bit     INPORTC.0
  0011          =1    51    PI2D            bit     INPORTC.1
  0012          =1    52    PI2U            bit     INPORTC.2
  0013          =1    53    PI3D            bit     INPORTC.3
  0014          =1    54    PI3U            bit     INPORTC.4
  0015          =1    55    PI4             bit     INPORTC.5
                =1    56    
  0018          =1    57    KS              bit     OUTPORTA.0
  0019          =1    58    PKO1            bit     OUTPORTA.1
VYTAH/ORI/D                                                                                                  PAGE 2

  001A          =1    59    PKO2            bit     OUTPORTA.2
  001B          =1    60    PKO3            bit     OUTPORTA.3
  001C          =1    61    PKO4            bit     OUTPORTA.4
                =1    62    
  0020          =1    63    UP              bit     OUTPORTB.0
  0021          =1    64    DOWN            bit     OUTPORTB.1
  0022          =1    65    FAST            bit     OUTPORTB.2
  0023          =1    66    SLOW            bit     OUTPORTB.3
  0024          =1    67    FLED1           bit     OUTPORTB.4
  0025          =1    68    FLED2           bit     OUTPORTB.5
  0026          =1    69    FLED3           bit     OUTPORTB.6
  0027          =1    70    FLED4           bit     OUTPORTB.7
                =1    71    
  0028          =1    72    PO1             bit     OUTPORTC.0
  0029          =1    73    PO2D            bit     OUTPORTC.1
  002A          =1    74    PO2U            bit     OUTPORTC.2
  002B          =1    75    PO3D            bit     OUTPORTC.3
  002C          =1    76    PO3U            bit     OUTPORTC.4
  002D          =1    77    PO4             bit     OUTPORTC.5
  002E          =1    78    LEDD            bit     OUTPORTC.6
  002F          =1    79    LEDU            bit     OUTPORTC.7
                =1    80    
  0038          =1    81    CANGO           bit     CTRLREG.0
  0039          =1    82    DOORCLSDold     bit     CTRLREG.1
  003A          =1    83    UPold           bit     CTRLREG.2
  003B          =1    84    DOWNold         bit     CTRLREG.3
  003C          =1    85    FASTold         bit     CTRLREG.4
  003D          =1    86    SLOWold         bit     CTRLREG.5
                =1    87    
  00B6          =1    88    WRNOT           bit     0b6h        ; p3.6
  00B7          =1    89    RDNOT           bit     0b7h        ; p3.7
                =1    90    
                =1    91    ; bitove masky
                =1    92    ; 8255OUT 
                =1    93    ; port A
  0001          =1    94    bmKS              equ    00000001b
  0002          =1    95    bmPKO1            equ    00000010b
  0004          =1    96    bmPKO2            equ    00000100b
  0008          =1    97    bmPKO3            equ    00001000b
  0010          =1    98    bmPKO4            equ    00010000b
                =1    99    
                =1   100    ; port B
  0001          =1   101    bmUP              equ    00000001b
  0002          =1   102    bmDOWN            equ    00000010b
  0004          =1   103    bmFAST            equ    00000100b
  0008          =1   104    bmSLOW            equ    00001000b
  0010          =1   105    bmFLED1           equ    00010000b
  0020          =1   106    bmFLED2           equ    00100000b
  0040          =1   107    bmFLED3           equ    01000000b
  0080          =1   108    bmFLED4           equ    10000000b
                =1   109    
                =1   110    ; port C
  0001          =1   111    bmPO1             equ    00000001b
  0002          =1   112    bmPO2D            equ    00000010b
  0004          =1   113    bmPO2U            equ    00000100b
  0008          =1   114    bmPO3D            equ    00001000b
  0010          =1   115    bmPO3U            equ    00010000b
  0020          =1   116    bmPO4             equ    00100000b
VYTAH/ORI/D                                                                                                  PAGE 3

  0040          =1   117    bmLEDD            equ    01000000b
  0080          =1   118    bmLEDU            equ    10000000b
                =1   119    
                =1   120    ; 8255IN
                =1   121    ; port A
  0001          =1   122    bmSTOP            equ    00000001b
  0002          =1   123    bmPKI1            equ    00000010b
  0004          =1   124    bmPKI2            equ    00000100b
  0008          =1   125    bmPKI3            equ    00001000b
  0010          =1   126    bmPKI4            equ    00010000b
  0020          =1   127    bmDOORCLSD        equ    00100000b
                =1   128    
                =1   129    ; port B
  0002          =1   130    bmMB1I            equ    00000010b
  0004          =1   131    bmMB2I            equ    00000100b
  0008          =1   132    bmSKRHI           equ    00001000b
  0010          =1   133    bmSKRHD           equ    00010000b
  0020          =1   134    bmDPI             equ    00100000b
  0040          =1   135    bmDPZKI           equ    01000000b
  0080          =1   136    bmDPKI            equ    10000000b
                =1   137    
                =1   138    ; port C
  0001          =1   139    bmPI1             equ    00000001b
  0002          =1   140    bmPI2D            equ    00000010b
  0004          =1   141    bmPI2U            equ    00000100b
  0008          =1   142    bmPI3D            equ    00001000b
  0010          =1   143    bmPI3U            equ    00010000b
  0020          =1   144    bmPI4             equ    00100000b
                =1   145    
                     146    
                     147    _BP_    MACRO 
                     148            clr     P3.3
                     149            setb    EX1
                     150            nop
                     151            nop
                     152    ENDM
                     153    
                     154    LJZ     MACRO   NAVESTIE
                     155            jnz     $+5
                     156            ljmp    NAVESTIE
                     157            nop
                     158    ENDM
                     159    
                     160    LJNZ    MACRO   NAVESTIE
                     161            jz      $+5
                     162            ljmp    NAVESTIE
                     163            nop
                     164    ENDM
                     165    
                     166    LJB     MACRO   TESTBIT, NAVESTIE
                     167            jnb     TESTBIT, $+5
                     168            ljmp    NAVESTIE
                     169            nop
                     170    ENDM
                     171    
                     172    LJNB    MACRO   TESTBIT, NAVESTIE
                     173            jb      TESTBIT, $+5
                     174            ljmp    NAVESTIE
VYTAH/ORI/D                                                                                                  PAGE 4

                     175            nop
                     176    ENDM
                     177    
                     178    POLOHA_LED  MACRO  POLOHA
                     179            clr     LEDU            
                     180            clr     LEDD 
                     181            clr     FLED1             
                     182            clr     FLED2                
                     183            clr     FLED3           
                     184            clr     FLED4           
                     185            setb    FLED&POLOHA
                     186            lcall   WRITEPORTS
                     187    ENDM
                     188    
  0036               189    FLOORREQ        data    36h
                     190    
                     191    ; hodiny oscilatora v emulatore treba dat na ext a nastavit 11.0592MHz
  00FA               192    TIMERCONST      equ     250     ; udaj pre nastavenie casovaca pre potreby seriovej komunika
                                                                               cie
                     193                                    ; hodnota 250 znamena prenosovu rychlost 4800 baud pri oscil
                                                                               atore 11.0592MHz
                     194                                    ; nastavenie terminalu je 4800 8-N-1, no flow control
                     195    ;osetrenie vektorov preruseni
0000                 196            org     0000h           ; adresa odkial startuje program po resete
0000 020033          197            ljmp    START           ; skok na zaciatok kodu programu
                     198                  
0033                 199            org     0033h           ; od tejto adresy sa zacina kod programu
0033                 200    START:
0033                 201    RESET:  
                     202            ; riadiace signaly do pasivnej urovne 
0033 D2B6            203            setb    WRNOT
0035 D2B7            204            setb    RDNOT
0037 753300          205            mov     STOPTIMER, #0
003A 758140          206            mov     SP, #STACK
                     207    
                     208            ; pockame si na inicializaciu obvodov 8255  
003D 7900            209            mov     R1, #0 
003F 7AFF            210            mov     R2, #0ffh
0041 D9FE            211            djnz    R1, $
0043 DAFC            212            djnz    R2, $-2
                     213            
                     214            ; teraz ich mozeme nastavit
0045 75809B          215            mov     p0, #10011011b      ; nastavenie i8255IN - vsetky porty dnu
0048 75A083          216            mov     p2, #i8255INCW
004B C2B6            217            clr     WRNOT
004D 00              218            nop
004E 00              219            nop
004F 00              220            nop
0050 00              221            nop
0051 D2B6            222            setb    WRNOT
0053 758080          223            mov     p0, #10000000b      ; nastavenie i8255OUT - vsetky porty von
0056 75A0C3          224            mov     p2, #i8255OUTCW
0059 C2B6            225            clr     WRNOT
005B 00              226            nop
005C 00              227            nop
005D 00              228            nop
005E 00              229            nop
005F D2B6            230            setb    WRNOT
VYTAH/ORI.D                                                                                                  PAGE 5

                     231            
                     232 +1         _BP_
0061 C2B3            233 +1         clr     P3.3
0063 D2AA            234 +1         setb    EX1
0065 00              235 +1         nop
0066 00              236 +1         nop
                     238    
                     239            ; pociatocna inicializacia - vynuluj vstupne registre a rozsviet vsetky diody 
0067 752800          240            mov     INPORTA, #0
006A 75211E          241            mov     INPORTB, #01eh      ; vsetky clonky pasivne
006D 752200          242            mov     INPORTC, #0
0070 75231E          243            mov     OUTPORTA, #(bmPKO1 or bmPKO2 or bmPKO3 or bmPKO4)
0073 7524F0          244            mov     OUTPORTB, #(bmFLED1 or bmFLED2 or bmFLED3 or bmFLED4)
0076 7525FF          245            mov     OUTPORTC, #(bmPO1 or bmPO2D or bmPO2U or bmPO3D or bmPO3U or bmPO4 or bmLEDD
                                                                                or bmLEDU)
0079 D218            246            setb    KS
007B 12051A          247            call    WRITEPORTS          ; zapis novu informaciu
                     248    ;;;;;;;;
                     249    
007E 752300          250            mov     OUTPORTA, #0
0081 752400          251            mov     OUTPORTB, #0
0084 752500          252            mov     OUTPORTC, #0
0087 12051A          253            call    WRITEPORTS          ; zapis novu informaciu
                     254    
008A 752800          255            mov     INPORTA, #0
008D 752100          256            mov     INPORTB, #0         
0090 752200          257            mov     INPORTC, #0
0093 1204D5          258            call    READPORTS           ; prvotne nacitanie udajov
                     259    
0096                 260    CALIB:
                     261            ;kalibracia vytahu podla dolnej porovnavacej clonky
0096 1204D5          262            lcall   READPORTS                   ; precitaj, co je na portoch
0099 300C11          263            jnb     SKRD, CALIBEND              ; ak sme na dolnej porovnavacej clonke, tak koni
                                                                               ec
009C D221            264            setb    DOWN                        ; inak pod dole
009E D222            265            setb    FAST                        ; a rychlo
00A0 C223            266            clr     SLOW                        ;
00A2 12051A          267            lcall   WRITEPORTS                  ; zapis informaciu 
00A5                 268    CALIBLOOP:
00A5 1204D5          269            lcall   READPORTS                   ; 
00A8 300C02          270            jnb     SKRD, CALIBEND              ; ak sme dole, konci
                     271            ;jnb     MB2, CALIBEND               ; ak sme na poschodi, konci
00AB 80F8            272            jmp     CALIBLOOP
00AD                 273    CALIBEND:
00AD 753600          274            mov     FLOORREQ, #0                                
00B0 C222            275            clr     FAST                        ; stojime
00B2 C221            276            clr     DOWN                        ;
00B4 D224            277            setb    FLED1
00B6 12051A          278            lcall   WRITEPORTS                  ; zapis informaciu
                     279 +1         _BP_
00B9 C2B3            280 +1         clr     P3.3
00BB D2AA            281 +1         setb    EX1
00BD 00              282 +1         nop
00BE 00              283 +1         nop
00BF                 285    MAIN:
                     286    
                     287    ;            |  7    |  6    |  5    |  4    |  3    |  2    |  1    |  0    |
                     288    ; ****************************************************************************
VYTAH/ORI                                                                                                     PAGE 6

                     289    ; INPORTA >  |       |       |DOORCLS| PKI4  | PKI3  | PKI2  | PKI1  |STOPNOT|
                     290    ; ----------------------------------------------------------------------------
                     291    ; INPORTB >  | DPK   | DPZK  | DP    | SKRD  | SKRH  | MB2   | MB1   |       |
                     292    ; ----------------------------------------------------------------------------
                     293    ; INPORTC >  |       |       | PI4   | PI3D  | PI3U  | PI2D  | PI2U  | PI1   |
                     294    ; ****************************************************************************
                     295    ; OUTPORTA > |       |       |       | PKO4  | PKO3  | PKO2  | PKO1  | KS    |
                     296    ; ----------------------------------------------------------------------------
                     297    ; OUTPORTB > | FLED4 | FLED3 | FLED2 | FLED1 | SLOW  | FAST  | DOWN  | UP    |
                     298    ; ----------------------------------------------------------------------------
                     299    ; OUTPORTC > | LEDU  | LEDD  | PO4   | PO3D  | PO3U  | PO2D  | PO2U  | PO1   |
                     300    ; ****************************************************************************
                     301    ; POSITION
                     302    ; ****************************************************************************
                     303    
                     304    
                     305    ;------------------------------------------------------------------------------- << 1. posch
                                                                               odie >>
                     306    
00BF                 307    FLOOR1:
                     308 +1                 POLOHA_LED 1  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
00BF C22F            309 +1         clr     LEDU            
00C1 C22E            310 +1         clr     LEDD 
00C3 C224            311 +1         clr     FLED1             
00C5 C225            312 +1         clr     FLED2                
00C7 C226            313 +1         clr     FLED3           
00C9 C227            314 +1         clr     FLED4           
00CB D224            315 +1         setb    FLED1
00CD 12051A          316 +1         lcall   WRITEPORTS
00D0 1204C4          318            lcall   WAITFORTIMER    ; simulacia TIMERu
00D3 1204D5          319    F1S:    lcall   READPORTS     ;-; nacitanie dat
00D6 C219            320            clr     PKO1          ;-; vynulovanie volby poschodia na ktorom stojim
00D8 12051A          321            lcall   WRITEPORTS      ;
00DB E528            322            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
00DD 541C            323            anl     A, #00011100b ;-;
00DF 60F2            324            jz      F1S           ;-; ak nie, opakuj
00E1 D220            325            setb    UP              ; rychly pohyb hore
00E3 D222            326            setb    FAST            ; 
00E5 C223            327            clr     SLOW            ;
00E7 12051A          328            lcall   WRITEPORTS      ; 
00EA 0200ED          329            jmp     UP1           ;-; prejdi do stavu UP1
00ED                 330    UP1:
                     331 +1                 POLOHA_LED 1  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
00ED C22F            332 +1         clr     LEDU            
00EF C22E            333 +1         clr     LEDD 
00F1 C224            334 +1         clr     FLED1             
00F3 C225            335 +1         clr     FLED2                
00F5 C226            336 +1         clr     FLED3           
00F7 C227            337 +1         clr     FLED4           
00F9 D224            338 +1         setb    FLED1
00FB 12051A          339 +1         lcall   WRITEPORTS
00FE 1204D5          341    UP1A:   lcall   READPORTS       ; nacitanie dat
                     342 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0101 200B02          343 +1         jb      SKRH, $+5
0104 0204A9          344 +1         ljmp    ERR_SKRH
VYTAH/ORIUD*'©42'©4                                                                                          PAGE 7

0107 00              345 +1         nop
0108 200AF3          347            jb      MB2, UP1A     ;-; mame uz 1. spomalovaciu clonku?
010B 1204D5          348            lcall   READPORTS       ; ak ano, sme z nej uz prec?
010E 300AFA          349            jnb     MB2, $-3        ;       
0111 D22E            350            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0113 12051A          351            lcall   WRITEPORTS      ;
0116 020119          352            jmp     UP1_MB2       ;-; a prejdi do stavu UP1_MB2
0119                 353    UP1_MB2:
0119 1204D5          354            lcall   READPORTS       ; nacitanie dat
                     355 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
011C 200B02          356 +1         jb      SKRH, $+5
011F 0204A9          357 +1         ljmp    ERR_SKRH
0122 00              358 +1         nop
0123 200AF3          360            jb      MB2, UP1_MB2  ;-; mame uz aj druhu spomalovaciu clonku?     
0126 D22F            361            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
0128 12051A          362            lcall   WRITEPORTS      ;   
012B E528            363            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
012D 5404            364            anl     A, #00000100b ;-;
012F 600A            365            jz      UP1_MB1       ;-;       Ak nie, chod do stavu UP1_MB1
0131 D223            366            setb    SLOW            ;       Ak ano, spomalme
0133 C222            367            clr     FAST            ; 
0135 12051A          368            lcall   WRITEPORTS      ;         
0138 02013B          369            jmp     UP1_MB1       ;-; a prejdi do stavu UP1_MB1 
013B                 370    UP1_MB1:
013B 1204D5          371            lcall   READPORTS       ; nacitanie dat
                     372 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
013E 200B02          373 +1         jb      SKRH, $+5
0141 0204A9          374 +1         ljmp    ERR_SKRH
0144 00              375 +1         nop
0145 2009F3          377            jb      MB1, UP1_MB1  ;-; Sme na zastavovacej clonke?
0148 E528            378            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
014A 5404            379            anl     A, #00000100b ;-;
014C 606D            380            jz      UP2           ;-; Ak nie, chod do stavu UP2
014E C220            381            clr     UP              ; zastav motor
0150 D23A            382            setb    UPOld           ;       (a zalohuj) 
0152 C23B            383            clr     DOWNOld         ;       (a zalohuj)
0154 C222            384            clr     FAST            ; 
0156 12051A          385            lcall   WRITEPORTS      ; 
0159 02015C          386            jmp     FLOOR2        ;-; a prejdi do stavu FLOOR2
                     387    
                     388    ;------------------------------------------------------------------------------- << 2. posch
                                                                               odie >>
                     389    
015C                 390    FLOOR2:
                     391 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
015C C22F            392 +1         clr     LEDU            
015E C22E            393 +1         clr     LEDD 
0160 C224            394 +1         clr     FLED1             
0162 C225            395 +1         clr     FLED2                
0164 C226            396 +1         clr     FLED3           
0166 C227            397 +1         clr     FLED4           
0168 D225            398 +1         setb    FLED2
016A 12051A          399 +1         lcall   WRITEPORTS
016D 1204C4          401            lcall   WAITFORTIMER    ; simulacia TIMERu
0170 1204D5          402    F2S:    lcall   READPORTS     ;-; nacitanie dat
0173 C21A            403            clr     PKO2          ;-; vynulovanie volby poschodia na ktorom stojim
0175 12051A          404            lcall   WRITEPORTS      ;
VYTAH/ORIED>(©4                                                                                              PAGE 8

                     405            
0178 7418            406            mov     A, #00011000b ;-; Default predpokladam, ze mam namierene hore (na 3. a 4.)
017A 203A01          407            jb      UPOld, F2OK     ;   Je to pravda? Naozaj som doteraz isiel hore?
017D F4              408            cpl     A               ;       Ak nie, znegujeme
017E F5F0            409    F2OK:   mov     B, A            ; Masku dame do Bcka
                     410            
                     411            ; Pohyb v jednom smere (nevieme v ktorom)
0180 53F01A          412            anl     B, #00011010b  ;-; este ju kozmeticky upravime
0183 E528            413            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
0185 55F0            414            anl     A, B            ; tu ju pouzijeme       
0187 7014            415            jnz     F2              ; nasli sme poschodie v tomto smere
                     416            ; Pohyb v opacnom smere (nevieme v ktorom)
0189 B23A            417            cpl     UPOld           ;  Znegujem stary posun
018B B23B            418            cpl     DOWNOld         ;  |
018D E5F0            419            mov     A, B            ;  Znegujeme masku
018F F4              420            cpl     A               ;  |
0190 F5F0            421            mov     B, A            ;  |
0192 53F01A          422            anl     B, #00011010b  ;-; este ju kozmeticky upravime
0195 E528            423            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
0197 55F0            424            anl     A, B            ; tu ju pouzijeme       
0199 7002            425            jnz     F2              ; nasli sme poschodie v tomto smere
                     426            
019B 80D3            427            jmp     F2S           ;-; nemame sa kde hybat, tak opakujeme zistovanie
019D 203A03          428    F2:     jb      UPOld, F2UP     ;   
01A0 0201AF          429            jmp     F2DOWN          ;
01A3 D220            430    F2UP:   setb    UP              ; rychly pohyb hore
01A5 D222            431            setb    FAST            ; 
01A7 C223            432            clr     SLOW            ;
01A9 12051A          433            lcall   WRITEPORTS      ; 
01AC 0201BB          434            jmp     UP2           ;-; prejdi do stavu UP2    
01AF D221            435    F2DOWN: setb    DOWN            ; rychly pohyb hore
01B1 D222            436            setb    FAST            ; 
01B3 C223            437            clr     SLOW            ;
01B5 12051A          438            lcall   WRITEPORTS      ; 
01B8 02022D          439            jmp     DOWN2         ;-; prejdi do stavu UP2    
                     440            
                     441                
01BB                 442    UP2:
                     443 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
01BB C22F            444 +1         clr     LEDU            
01BD C22E            445 +1         clr     LEDD 
01BF C224            446 +1         clr     FLED1             
01C1 C225            447 +1         clr     FLED2                
01C3 C226            448 +1         clr     FLED3           
01C5 C227            449 +1         clr     FLED4           
01C7 D225            450 +1         setb    FLED2
01C9 12051A          451 +1         lcall   WRITEPORTS
01CC 1204D5          453    UP2A:   lcall   READPORTS       ; nacitanie dat
                     454 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
01CF 200B02          455 +1         jb      SKRH, $+5
01D2 0204A9          456 +1         ljmp    ERR_SKRH
01D5 00              457 +1         nop
01D6 200AF3          459            jb      MB2, UP2A     ;-; mame uz 1. spomalovaciu clonku?
01D9 1204D5          460            lcall   READPORTS       ; ak ano, sme z nej uz prec?
01DC 300AFA          461            jnb     MB2, $-3        ;       
VYTAH/ORI .DÖ(©4Þ(©4                                                                                          PAGE 9

01DF D22E            462            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
01E1 12051A          463            lcall   WRITEPORTS      ;
01E4 0201E7          464            jmp     UP2_MB2       ;-; a prejdi do stavu UP2_MB2
01E7                 465    UP2_MB2:
01E7 1204D5          466            lcall   READPORTS       ; nacitanie dat
                     467 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
01EA 200B02          468 +1         jb      SKRH, $+5
01ED 0204A9          469 +1         ljmp    ERR_SKRH
01F0 00              470 +1         nop
01F1 200AF3          472            jb      MB2, UP2_MB2  ;-; mame uz aj druhu spomalovaciu clonku?          
01F4 D22F            473            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
01F6 12051A          474            lcall   WRITEPORTS      ;
01F9 E528            475            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
01FB 5408            476            anl     A, #00001000b ;-;
01FD 600A            477            jz      UP2_MB1       ;-;       Ak nie, chod do stavu UP2_MB1
01FF D223            478            setb    SLOW            ;       Ak ano, spomalme
0201 C222            479            clr     FAST            ; 
0203 12051A          480            lcall   WRITEPORTS      ;
0206 020209          481            jmp     UP2_MB1       ;-; a prejdi do stavu UP2_MB1 
0209                 482    UP2_MB1:
0209 1204D5          483            lcall   READPORTS       ; nacitanie dat
                     484 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
020C 200B02          485 +1         jb      SKRH, $+5
020F 0204A9          486 +1         ljmp    ERR_SKRH
0212 00              487 +1         nop
0213 2009F3          489            jb      MB1, UP2_MB1  ;-; Sme na zastavovacej clonke?
0216 E528            490            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
0218 5408            491            anl     A, #00001000b ;-;
021A 7003            492            jnz     U2_MB1C       ;-; Ak nie, chod do stavu UP3
021C 0202F4          493            ljmp    UP3             ; |
021F C220            494    U2_MB1C:clr     UP              ; zastav motor
0221 D23A            495            setb    UPOld           ;       (a zalohuj)
0223 C23B            496            clr     DOWNOld         ;       (a zalohuj)
0225 C222            497            clr     FAST            ; 
0227 12051A          498            lcall   WRITEPORTS      ; 
022A 020295          499            jmp     FLOOR3        ;-; a prejdi do stavu FLOOR3
022D                 500    DOWN2:
                     501 +1                 POLOHA_LED 2  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
022D C22F            502 +1         clr     LEDU            
022F C22E            503 +1         clr     LEDD 
0231 C224            504 +1         clr     FLED1             
0233 C225            505 +1         clr     FLED2                
0235 C226            506 +1         clr     FLED3           
0237 C227            507 +1         clr     FLED4           
0239 D225            508 +1         setb    FLED2
023B 12051A          509 +1         lcall   WRITEPORTS
023E 1204D5          511            lcall   READPORTS       ; nacitanie dat
                     512 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
0241 200C02          513 +1         jb      SKRD, $+5
0244 02049A          514 +1         ljmp    ERR_SKRD
0247 00              515 +1         nop
0248 200AE2          517            jb      MB2, DOWN2    ;-; mame uz 1. spomalovaciu clonku?
024B 1204D5          518            lcall   READPORTS       ; ak ano, sme z nej uz prec?
024E 300AFA          519            jnb     MB2, $-3        ;       
0251 D22F            520            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0253 12051A          521            lcall   WRITEPORTS      ;
0256 020259          522            jmp     DOWN2_MB2     ;-; a prejdi do stavu DOWN2_MB2
VYTAH/ORI
&D6*©4>*©4                                                                                          PAGE 10

0259                 523    DOWN2_MB2:
0259 1204D5          524            lcall   READPORTS       ; nacitanie dat
                     525 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
025C 200C02          526 +1         jb      SKRD, $+5
025F 02049A          527 +1         ljmp    ERR_SKRD
0262 00              528 +1         nop
0263 200AF3          530            jb      MB2, DOWN2_MB2;-; mame uz aj druhu spomalovaciu clonku?          
0266 D22E            531            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
0268 12051A          532            lcall   WRITEPORTS      ;
026B E528            533            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
026D 5402            534            anl     A, #00000010b ;-;
026F 600A            535            jz      DOWN2_MB1     ;-;       Ak nie, chod do stavu DOWN2_MB1
0271 D223            536            setb    SLOW            ;       Ak ano, spomalme
0273 C222            537            clr     FAST            ; 
0275 12051A          538            lcall   WRITEPORTS      ;
0278 02027B          539            jmp     DOWN2_MB1     ;-; a prejdi do stavu DOWN2_MB1
027B                 540    DOWN2_MB1:    
027B 1204D5          541            lcall   READPORTS       ; nacitanie dat
                     542 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
027E 200C02          543 +1         jb      SKRD, $+5
0281 02049A          544 +1         ljmp    ERR_SKRD
0284 00              545 +1         nop
0285 2009F3          547            jb      MB1, DOWN2_MB1;-; Sme na zastavovacej clonke?
0288 C221            548            clr     DOWN            ; zastav motor
028A D23B            549            setb    DOWNOld         ;       (a zalohuj)
028C C23A            550            clr     UPOld           ;       (a zalohuj)
028E C222            551            clr     FAST            ; 
0290 12051A          552            lcall   WRITEPORTS      ; 
0293 01BF            553            jmp     FLOOR1        ;-; a prejdi do stavu FLOOR2      
                     554    
                     555    
                     556    ;------------------------------------------------------------------------------- << 3. posch
                                                                               odie >>
                     557    
0295                 558    FLOOR3:
                     559 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
0295 C22F            560 +1         clr     LEDU            
0297 C22E            561 +1         clr     LEDD 
0299 C224            562 +1         clr     FLED1             
029B C225            563 +1         clr     FLED2                
029D C226            564 +1         clr     FLED3           
029F C227            565 +1         clr     FLED4           
02A1 D226            566 +1         setb    FLED3
02A3 12051A          567 +1         lcall   WRITEPORTS
02A6 1204C4          569            lcall   WAITFORTIMER    ; simulacia TIMERu
02A9 1204D5          570    F3S:    lcall   READPORTS     ;-; nacitanie dat
02AC C21B            571            clr     PKO3          ;-; vynulovanie volby poschodia na ktorom stojim
02AE 12051A          572            lcall   WRITEPORTS      ;
                     573    
02B1 7410            574            mov     A, #00010000b ;-; Default predpokladam, ze idem hore (na 4.)
02B3 203A01          575            jb      UPOld, F3OK   ;-;   Je to pravda? Naozaj idem hore?
02B6 F4              576            cpl     A               ;       Ak nie, znegujeme
02B7 F5F0            577    F3OK:   mov     B, A            ; Masku dame do Bcka
                     578            
                     579            ; Pohyb v jednom smere (nevieme v ktorom)
02B9 53F016          580            anl     B, #00010110b  ;-; este ju kozmeticky upravime
02BC E528            581            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
VYTAH/ORI DJ+©4                                                                                              PAGE 11

                                                                               om stojim
02BE 55F0            582            anl     A, B            ; tu ju pouzijeme       
02C0 7014            583            jnz     F3              ; nasli sme poschodie v tomto smere
                     584            ; Pohyb v opacnom smere (nevieme v ktorom)
02C2 B23A            585            cpl     UPOld           ;  Znegujem stary posun
02C4 B23B            586            cpl     DOWNOld         ;  |
02C6 E5F0            587            mov     A, B            ;  Znegujeme masku
02C8 F4              588            cpl     A               ;  |
02C9 F5F0            589            mov     B, A            ;  |
02CB 53F016          590            anl     B, #00010110b  ;-; este ju kozmeticky upravime
02CE E528            591            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na ktor
                                                                               om stojim
02D0 55F0            592            anl     A, B            ; tu ju pouzijeme       
02D2 7002            593            jnz     F3              ; nasli sme poschodie v tomto smere
                     594            
02D4 80D3            595            jmp     F3S           ;-; nemame sa kde hybat, tak opakujeme zistovanie
02D6 203A03          596    F3:     jb      UPOld, F3UP     ;   
02D9 0202E8          597            jmp     F3DOWN          ;
02DC D220            598    F3UP:   setb    UP              ; rychly pohyb hore
02DE D222            599            setb    FAST            ; 
02E0 C223            600            clr     SLOW            ;
02E2 12051A          601            lcall   WRITEPORTS      ; 
02E5 0202F4          602            jmp     UP3           ;-; prejdi do stavu UP2    
02E8 D221            603    F3DOWN: setb    DOWN            ; rychly pohyb hore
02EA D222            604            setb    FAST            ; 
02EC C223            605            clr     SLOW            ;
02EE 12051A          606            lcall   WRITEPORTS      ; 
02F1 02035D          607            jmp     DOWN3         ;-; prejdi do stavu UP2    
                     608    
                     609            
                     610            
                     611            
                     612    ;        mov     A, INPORTA      ; zistenie, cibolo stlacene nieco viac ako poschodie na kto
                                                                               rom stojim
                     613    ;        anl     A, #00010000b ;-;
                     614    ;        jz      F3S           ;-; ak nie, opakuj
                     615    ;        setb    UP              ; rychly pohyb hore
                     616    ;        setb    FAST            ; 
                     617    ;        lcall   WRITEPORTS      ; 
                     618    ;        jmp     UP3           ;-; prejdi do stavu UP3        
02F4                 619    UP3:
                     620 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
02F4 C22F            621 +1         clr     LEDU            
02F6 C22E            622 +1         clr     LEDD 
02F8 C224            623 +1         clr     FLED1             
02FA C225            624 +1         clr     FLED2                
02FC C226            625 +1         clr     FLED3           
02FE C227            626 +1         clr     FLED4           
0300 D226            627 +1         setb    FLED3
0302 12051A          628 +1         lcall   WRITEPORTS
0305 1204D5          630    UP3A:   lcall   READPORTS       ; nacitanie dat
                     631 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0308 200B02          632 +1         jb      SKRH, $+5
030B 0204A9          633 +1         ljmp    ERR_SKRH
030E 00              634 +1         nop
030F 200AF3          636            jb      MB2, UP3A     ;-; mame uz 1. spomalovaciu clonku?
0312 1204D5          637            lcall   READPORTS       ; ak ano, sme z nej uz prec?
VYTAH/ORI eDâ+©4ê+©4                                                                                          PAGE 12

0315 300AFA          638            jnb     MB2, $-3        ;       
0318 D22E            639            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
031A 12051A          640            lcall   WRITEPORTS      ;
031D 020320          641            jmp     UP3_MB2       ;-; a prejdi do stavu UP3_MB2
0320                 642    UP3_MB2:
0320 1204D5          643            lcall   READPORTS       ; nacitanie dat
                     644 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0323 200B02          645 +1         jb      SKRH, $+5
0326 0204A9          646 +1         ljmp    ERR_SKRH
0329 00              647 +1         nop
032A 200AF3          649            jb      MB2, UP3_MB2  ;-; mame uz aj druhu spomalovaciu clonku?          
032D D22F            650            setb    LEDU            ; Rozsviet LEDku, ze mame druhu MB2
032F 12051A          651            lcall   WRITEPORTS      ;
0332 E528            652            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
0334 5410            653            anl     A, #00010000b ;-;
0336 600A            654            jz      UP3_MB1       ;-;       Ak nie, chod do stavu UP3_MB1
0338 D223            655            setb    SLOW            ;       Ak ano, spomalme
033A C222            656            clr     FAST            ; 
033C 12051A          657            lcall   WRITEPORTS      ;
033F 020342          658            jmp     UP3_MB1       ;-; a prejdi do stavu UP3_MB1 
0342                 659    UP3_MB1:
0342 1204D5          660            lcall   READPORTS       ; nacitanie dat
                     661 +1         ljnb    SKRH, ERR_SKRH  ; >>> CHYBA, Horna porovnavacia clonka <<<
0345 200B02          662 +1         jb      SKRH, $+5
0348 0204A9          663 +1         ljmp    ERR_SKRH
034B 00              664 +1         nop
034C 2009F3          666            jb      MB1, UP3_MB1  ;-; Sme na zastavovacej clonke? (tu zastavujeme v kazdom pripa
                                                                               de)
034F C220            667            clr     UP              ; zastav motor
0351 D23A            668            setb    UPOld           ;       (a zalohuj)
0353 C23B            669            clr     DOWNOld         ;       (a zalohuj)
0355 C222            670            clr     FAST            ; 
0357 12051A          671            lcall   WRITEPORTS      ; 
035A 0203CE          672            jmp     FLOOR4        ;-; a prejdi do stavu FLOOR4   
035D                 673    DOWN3:
                     674 +1                 POLOHA_LED 3  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
035D C22F            675 +1         clr     LEDU            
035F C22E            676 +1         clr     LEDD 
0361 C224            677 +1         clr     FLED1             
0363 C225            678 +1         clr     FLED2                
0365 C226            679 +1         clr     FLED3           
0367 C227            680 +1         clr     FLED4           
0369 D226            681 +1         setb    FLED3
036B 12051A          682 +1         lcall   WRITEPORTS
036E 1204D5          684            lcall   READPORTS       ; nacitanie dat
                     685 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
0371 200C02          686 +1         jb      SKRD, $+5
0374 02049A          687 +1         ljmp    ERR_SKRD
0377 00              688 +1         nop
0378 200AE2          690            jb      MB2, DOWN3    ;-; mame uz 1. spomalovaciu clonku?
037B 1204D5          691            lcall   READPORTS       ; ak ano, sme z nej uz prec?
037E 300AFA          692            jnb     MB2, $-3        ;       
0381 D22F            693            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0383 12051A          694            lcall   WRITEPORTS      ;
0386 020389          695            jmp     DOWN3_MB2     ;-; a prejdi do stavu DOWN3_MB2
0389                 696    DOWN3_MB2:
0389 1204D5          697            lcall   READPORTS       ; nacitanie dat
VYTAH/ORIYDž-©4¦-©4                                                                                          PAGE 13

                     698 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
038C 200C02          699 +1         jb      SKRD, $+5
038F 02049A          700 +1         ljmp    ERR_SKRD
0392 00              701 +1         nop
0393 200AF3          703            jb      MB2, DOWN3_MB2;-; mame uz aj druhu spomalovaciu clonku?          
0396 D22E            704            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
0398 12051A          705            lcall   WRITEPORTS      ;
039B E528            706            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
039D 5404            707            anl     A, #00000100b ;-;
039F 600A            708            jz      DOWN3_MB1     ;-;       Ak nie, chod do stavu DOWN3_MB1
03A1 D223            709            setb    SLOW            ;       Ak ano, spomalme
03A3 C222            710            clr     FAST            ; 
03A5 12051A          711            lcall   WRITEPORTS      ;
03A8 0203AB          712            jmp     DOWN3_MB1     ;-; a prejdi do stavu DOWN3_MB1
03AB                 713    DOWN3_MB1:    
03AB 1204D5          714            lcall   READPORTS       ; nacitanie dat
                     715 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
03AE 200C02          716 +1         jb      SKRD, $+5
03B1 02049A          717 +1         ljmp    ERR_SKRD
03B4 00              718 +1         nop
03B5 2009F3          720            jb      MB1, DOWN3_MB1;-; Sme na zastavovacej clonke?
03B8 E528            721            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
03BA 5404            722            anl     A, #00000100b ;-;
03BC 7003            723            jnz     D3_MB1C         ; Ak nie, chod do stavu DOWN2
03BE 02022D          724            ljmp    DOWN2         ;-; |
03C1 C221            725    D3_MB1C:clr     DOWN            ; zastav motor
03C3 D23B            726            setb    DOWNOld         ;       (a zalohuj)
03C5 C23A            727            clr     UPOld           ;       (a zalohuj)
03C7 C222            728            clr     FAST            ; 
03C9 12051A          729            lcall   WRITEPORTS      ; 
03CC 215C            730            jmp     FLOOR2        ;-; a prejdi do stavu FLOOR2      
                     731          
                     732            
                     733    ;------------------------------------------------------------------------------- << 4. posch
                                                                               odie >>
                     734    
03CE                 735    FLOOR4:
                     736 +1                 POLOHA_LED 4  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
03CE C22F            737 +1         clr     LEDU            
03D0 C22E            738 +1         clr     LEDD 
03D2 C224            739 +1         clr     FLED1             
03D4 C225            740 +1         clr     FLED2                
03D6 C226            741 +1         clr     FLED3           
03D8 C227            742 +1         clr     FLED4           
03DA D227            743 +1         setb    FLED4
03DC 12051A          744 +1         lcall   WRITEPORTS
03DF 1204C4          746            lcall   WAITFORTIMER    ; simulacia TIMERu
03E2 1204D5          747    F4S:    lcall   READPORTS     ;-; nacitanie dat
03E5 C21C            748            clr     PKO4          ;-; vynulovanie volby poschodia na ktorom stojim
03E7 12051A          749            lcall   WRITEPORTS      ;
03EA E528            750            mov     A, INPORTA      ; zistenie, cibolo stlacene nieco menej ako poschodie na kto
                                                                               rom stojim
03EC 540E            751            anl     A, #00001110b ;-;
03EE 60F2            752            jz      F4S           ;-; ak nie, opakuj
03F0 D221            753            setb    DOWN            ; rychly pohyb dole
03F2 D222            754            setb    FAST            ;
03F4 C223            755            clr     SLOW            ; 
VYTAH/ORI FDV.©4                                                                                              PAGE 14

03F6 12051A          756            lcall   WRITEPORTS      ; 
03F9 0203FC          757            jmp     DOWN4         ;-; prejdi do stavu DOWN4 
03FC                 758    DOWN4:
                     759 +1                 POLOHA_LED 4  ;-; Zhasni LEDKY,uz sme na poschodi (aj na paneli "Poloha kabi
                                                                               ny", nechaj len aktualne poschodie)
03FC C22F            760 +1         clr     LEDU            
03FE C22E            761 +1         clr     LEDD 
0400 C224            762 +1         clr     FLED1             
0402 C225            763 +1         clr     FLED2                
0404 C226            764 +1         clr     FLED3           
0406 C227            765 +1         clr     FLED4           
0408 D227            766 +1         setb    FLED4
040A 12051A          767 +1         lcall   WRITEPORTS
040D 1204D5          769            lcall   READPORTS       ; nacitanie dat
                     770 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
0410 200C02          771 +1         jb      SKRD, $+5
0413 02049A          772 +1         ljmp    ERR_SKRD
0416 00              773 +1         nop
0417 200AE2          775            jb      MB2, DOWN4    ;-; mame uz 1. spomalovaciu clonku?
041A 1204D5          776            lcall   READPORTS       ; ak ano, sme z nej uz prec?
041D 300AFA          777            jnb     MB2, $-3        ;       
0420 D22F            778            setb    LEDU            ; Ak ano, rozsviet LEDku, ze mame prvu MB2 mame za sebou
0422 12051A          779            lcall   WRITEPORTS      ;
0425 020428          780            jmp     DOWN4_MB2     ;-; a prejdi do stavu DOWN4_MB2
0428                 781    DOWN4_MB2:
0428 1204D5          782            lcall   READPORTS       ; nacitanie dat
                     783 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
042B 200C02          784 +1         jb      SKRD, $+5
042E 02049A          785 +1         ljmp    ERR_SKRD
0431 00              786 +1         nop
0432 200AF3          788            jb      MB2, DOWN4_MB2;-; mame uz aj druhu spomalovaciu clonku?          
0435 D22E            789            setb    LEDD            ; Ak ano, rozsviet LEDku, ze mame druhu MB2
0437 12051A          790            lcall   WRITEPORTS      ;
043A E528            791            mov     A, INPORTA      ; Chceme tu spomalit? - je najblizsie poschodie zvolene?
043C 5408            792            anl     A, #00001000b ;-;
043E 600A            793            jz      DOWN4_MB1     ;-;       Ak nie, chod do stavu DOWN4_MB1
0440 D223            794            setb    SLOW            ;       Ak ano, spomalme
0442 C222            795            clr     FAST            ; 
0444 12051A          796            lcall   WRITEPORTS      ;
0447 02044A          797            jmp     DOWN4_MB1     ;-; a prejdi do stavu DOWN4_MB1
044A                 798    DOWN4_MB1:    
044A 1204D5          799            lcall   READPORTS       ; nacitanie dat
                     800 +1         ljnb    SKRD, ERR_SKRD  ; >>> CHYBA, Dolna porovnavacia clonka <<<
044D 200C02          801 +1         jb      SKRD, $+5
0450 02049A          802 +1         ljmp    ERR_SKRD
0453 00              803 +1         nop
0454 2009F3          805            jb      MB1, DOWN4_MB1;-; Sme na zastavovacej clonke?
0457 E528            806            mov     A, INPORTA      ; Ak ano, chceme tu zastavit? - je toto poschodie zvolene?
0459 5408            807            anl     A, #00001000b ;-;
045B 7003            808            jnz     D4_MB1C         ; Ak nie, chod do stavu DOWN3
045D 02035D          809            ljmp    DOWN3         ;-; |
0460 C221            810    D4_MB1C:clr     DOWN            ; zastav motor
0462 D23B            811            setb    DOWNOld         ;       (a zalohuj)
0464 C23A            812            clr     UPOld           ;       (a zalohuj)
0466 C222            813            clr     FAST            ; 
0468 12051A          814            lcall   WRITEPORTS      ; 
046B 4195            815            jmp     FLOOR3        ;-; a prejdi do stavu FLOOR3                 
                     816                    
VYTAH/ORI:D¦/©4®/©4                                                                                          PAGE 15

                     817      
046D                 818    ERR_1SPOM_C: 
046D C220            819            clr     UP              ; zastav motor
046F C221            820            clr     DOWN            ; 
0471 12051A          821            lcall   WRITEPORTS      ; 
                     822 +1         _BP_
0474 C2B3            823 +1         clr     P3.3
0476 D2AA            824 +1         setb    EX1
0478 00              825 +1         nop
0479 00              826 +1         nop
047A 00              828            nop
047B 00              829            nop 
                     830            
047C                 831    ERR_2SPOM_C: 
047C C220            832            clr     UP              ; zastav motor
047E C221            833            clr     DOWN            ; 
0480 12051A          834            lcall   WRITEPORTS      ; 
                     835 +1         _BP_
0483 C2B3            836 +1         clr     P3.3
0485 D2AA            837 +1         setb    EX1
0487 00              838 +1         nop
0488 00              839 +1         nop
0489 00              841            nop
048A 00              842            nop 
                     843            
048B                 844    ERR_ZAST_C: 
048B C220            845            clr     UP              ; zastav motor
048D C221            846            clr     DOWN            ; 
048F 12051A          847            lcall   WRITEPORTS      ; 
                     848 +1         _BP_
0492 C2B3            849 +1         clr     P3.3
0494 D2AA            850 +1         setb    EX1
0496 00              851 +1         nop
0497 00              852 +1         nop
0498 00              854            nop
0499 00              855            nop 
                     856            
049A                 857    ERR_SKRD: 
049A C220            858            clr     UP              ; zastav motor
049C C221            859            clr     DOWN            ; 
049E 12051A          860            lcall   WRITEPORTS      ; 
                     861 +1         _BP_
04A1 C2B3            862 +1         clr     P3.3
04A3 D2AA            863 +1         setb    EX1
04A5 00              864 +1         nop
04A6 00              865 +1         nop
04A7 00              867            nop
04A8 00              868            nop    
                     869            
04A9                 870    ERR_SKRH: 
04A9 C220            871            clr     UP              ; zastav motor
04AB C221            872            clr     DOWN            ; 
04AD 12051A          873            lcall   WRITEPORTS      ; 
                     874 +1         _BP_
04B0 C2B3            875 +1         clr     P3.3
04B2 D2AA            876 +1         setb    EX1
04B4 00              877 +1         nop
04B5 00              878 +1         nop
VYTAH/ORID                                                                                                  PAGE 16

04B6 00              880            nop
04B7 00              881            nop             
                     882                    
                     883                    
04B8                 884    ENDPROG:
04B8 D218            885            setb    KS
04BA 12051A          886            call    WRITEPORTS                ; zapis novu informaciu
                     887 +1         _BP_
04BD C2B3            888 +1         clr     P3.3
04BF D2AA            889 +1         setb    EX1
04C1 00              890 +1         nop
04C2 00              891 +1         nop
04C3 22              893            ret
                     894    
                     895    
                     896    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     897    ; WAITFORTIMER
                     898    ; Pocka na stlacenie tlacidla na 1. poschodi  - signal PO1 (v buducnosti to 
                     899    ; bude timer)
                     900    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
04C4                 901    WAITFORTIMER:
04C4 D22C            902            setb    PO3U                        ; rozsvieti indikator cakania (poschodie 4)
04C6 12051A          903            lcall   WRITEPORTS                  ;
04C9 1204D5          904    WAIT:   lcall   READPORTS                   ; 
04CC 3013F5          905            jnb     PI3D, WAITFORTIMER          ; ak nebolo stlacene tlacidlo PO1, cakaj 
04CF C22C            906            clr     PO3U                         ; zhasne indikator cakania (poschodie 4)
04D1 12051A          907            lcall   WRITEPORTS
04D4 22              908            ret
                     909    
                     910    
                     911    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     912    ; READPORTS
                     913    ; precita nove hodnoty na portoch
                     914    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
04D5                 915    READPORTS:
04D5 75A080          916            mov     p2, #i8255INA       ; citaj data z portu A
04D8 75803F          917            mov     p0, #(bmSTOP or bmPKI1 or bmPKI2 or bmPKI3 or bmPKI4 or bmDOORCLSD)
04DB C2B7            918            clr     RDNOT
04DD 00              919            nop
04DE 00              920            nop
04DF 00              921            nop
04E0 00              922            nop
04E1 858028          923            mov     INPORTA, p0         ; uloz informaciu z datovej zbernice 
04E4 D2B7            924            setb    RDNOT
                     925            
04E6 75A081          926            mov     p2, #i8255INB       ; citaj data z portu B
04E9 7580FE          927            mov     p0, #(bmMB1I or bmMB2I or bmSKRHI or bmSKRHD or bmDPI or bmDPKI or bmDPZKI)
                                                                               
04EC C2B7            928            clr     RDNOT
04EE 00              929            nop
04EF 00              930            nop
04F0 00              931            nop
04F1 00              932            nop
04F2 858021          933            mov     INPORTB, p0         ; uloz informaciu z datovej zbernice 
04F5 D2B7            934            setb    RDNOT
                     935    
04F7 75A082          936            mov     p2, #i8255INC       ; citaj data z portu C
04FA 75803F          937            mov     p0, #(bmPI1 or bmPI2D or bmPI2U or bmPI3D or bmPI3U or bmPI4)
VYTAH/ORILD                                                                                                  PAGE 17

04FD C2B7            938            clr     RDNOT
04FF 00              939            nop
0500 00              940            nop
0501 00              941            nop
0502 00              942            nop
0503 858022          943            mov     INPORTC, p0         ; uloz informaciu z datovej zbernice 
0506 D2B7            944            setb    RDNOT
0508 00              945            nop
0509 00              946            nop
050A 00              947            nop
050B 00              948            nop
050C 00              949            nop
050D 00              950            nop
050E 00              951            nop
050F 00              952            nop
0510 E528            953            mov     A, INPORTA
0512 541E            954            anl     A, #00011110b
0514 4223            955            orl     OUTPORTA, A
0516 12051A          956            call    WRITEPORTS              ; aktualizuj signalizaciu na ovladacom paneli
                     957            
0519 22              958            ret
                     959            
                     960    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                     961    ; WRITEPORTS
                     962    ; spravi zalohu vystupnych registrov a posle data von
                     963    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
051A                 964    WRITEPORTS:
051A 852380          965            mov     p0, OUTPORTA        ; teraz postupne posli data najprv na port A,
051D 75A0C0          966            mov     p2, #i8255OUTA
0520 C2B6            967            clr     WRNOT
0522 00              968            nop
0523 00              969            nop
0524 00              970            nop
0525 00              971            nop
0526 D2B6            972            setb    WRNOT
                     973            
0528 852480          974            mov     p0, OUTPORTB        ; potom port B
052B 75A0C1          975            mov     p2, #i8255OUTB
052E C2B6            976            clr     WRNOT
0530 00              977            nop
0531 00              978            nop
0532 00              979            nop
0533 00              980            nop
0534 D2B6            981            setb    WRNOT
                     982    
0536 852580          983            mov     p0, OUTPORTC        ; a nakoniec port C
0539 75A0C2          984            mov     p2, #i8255OUTC
053C C2B6            985            clr     WRNOT
053E 00              986            nop
053F 00              987            nop
0540 00              988            nop
0541 00              989            nop
0542 D2B6            990            setb    WRNOT
0544 00              991            nop
0545 00              992            nop
0546 00              993            nop
0547 00              994            nop
0548 00              995            nop
VYTAH/ORID                                                                                                  PAGE 18

0549 00              996            nop
054A 00              997            nop
054B 00              998            nop
054C 22              999            ret
                    1000    
                    1001    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                    1002    
054D 0D0A5269       1003    STR_INIT:   db  0dh, 0ah, 'Riadiaci system je inicializovany.', 0dh, 0ah, 00h
0551 61646961   
0555 63692073   
0559 79737465   
055D 6D206A65   
0561 20696E69   
0565 6369616C   
0569 697A6F76   
056D 616E792E   
0571 0D0A00     
0574 52696164       1004    STR_STOP:   db  'Riadiaci system je reinicializovany po stlaceni tlacidla STOP.', 0dh, 0ah, 
                                                                               00h
0578 69616369   
057C 20737973   
0580 74656D20   
0584 6A652072   
0588 65696E69   
058C 6369616C   
0590 697A6F76   
0594 616E7920   
0598 706F2073   
059C 746C6163   
05A0 656E6920   
05A4 746C6163   
05A8 69646C61   
05AC 2053544F   
05B0 502E0D0A   
05B4 00         
05B5 4B616C69       1005    STR_CALIB:  db  'Kalibracia vytahu je ukoncena.', 0dh, 0ah, 00h
05B9 62726163   
05BD 69612076   
05C1 79746168   
05C5 75206A65   
05C9 20756B6F   
05CD 6E63656E   
05D1 612E0D0A   
05D5 00         
                    1006    
----                1007            DSEG
0040                1008            org     40h
0040                1009    STACK:  DS      10h
                    1010    
                    1011    end

VERSION 1.2h ASSEMBLY COMPLETE, 0 ERRORS FOUND
VYTAH/ORI                                                                                                     PAGE 19

B. . . . . . . . . . . . . . . .  D ADDR  00F0H  PREDEFINED  
BMDOORCLSD . . . . . . . . . . .    NUMB  0020H  
BMDOWN . . . . . . . . . . . . .    NUMB  0002H  NOT USED  
BMDPI. . . . . . . . . . . . . .    NUMB  0020H  
BMDPKI . . . . . . . . . . . . .    NUMB  0080H  
BMDPZKI. . . . . . . . . . . . .    NUMB  0040H  
BMFAST . . . . . . . . . . . . .    NUMB  0004H  NOT USED  
BMFLED1. . . . . . . . . . . . .    NUMB  0010H  
BMFLED2. . . . . . . . . . . . .    NUMB  0020H  
BMFLED3. . . . . . . . . . . . .    NUMB  0040H  
BMFLED4. . . . . . . . . . . . .    NUMB  0080H  
BMKS . . . . . . . . . . . . . .    NUMB  0001H  NOT USED  
BMLEDD . . . . . . . . . . . . .    NUMB  0040H  
BMLEDU . . . . . . . . . . . . .    NUMB  0080H  
BMMB1I . . . . . . . . . . . . .    NUMB  0002H  
BMMB2I . . . . . . . . . . . . .    NUMB  0004H  
BMPI1. . . . . . . . . . . . . .    NUMB  0001H  
BMPI2D . . . . . . . . . . . . .    NUMB  0002H  
BMPI2U . . . . . . . . . . . . .    NUMB  0004H  
BMPI3D . . . . . . . . . . . . .    NUMB  0008H  
BMPI3U . . . . . . . . . . . . .    NUMB  0010H  
BMPI4. . . . . . . . . . . . . .    NUMB  0020H  
BMPKI1 . . . . . . . . . . . . .    NUMB  0002H  
BMPKI2 . . . . . . . . . . . . .    NUMB  0004H  
BMPKI3 . . . . . . . . . . . . .    NUMB  0008H  
BMPKI4 . . . . . . . . . . . . .    NUMB  0010H  
BMPKO1 . . . . . . . . . . . . .    NUMB  0002H  
BMPKO2 . . . . . . . . . . . . .    NUMB  0004H  
BMPKO3 . . . . . . . . . . . . .    NUMB  0008H  
BMPKO4 . . . . . . . . . . . . .    NUMB  0010H  
BMPO1. . . . . . . . . . . . . .    NUMB  0001H  
BMPO2D . . . . . . . . . . . . .    NUMB  0002H  
BMPO2U . . . . . . . . . . . . .    NUMB  0004H  
BMPO3D . . . . . . . . . . . . .    NUMB  0008H  
BMPO3U . . . . . . . . . . . . .    NUMB  0010H  
BMPO4. . . . . . . . . . . . . .    NUMB  0020H  
BMSKRHD. . . . . . . . . . . . .    NUMB  0010H  
BMSKRHI. . . . . . . . . . . . .    NUMB  0008H  
BMSLOW . . . . . . . . . . . . .    NUMB  0008H  NOT USED  
BMSTOP . . . . . . . . . . . . .    NUMB  0001H  
BMUP . . . . . . . . . . . . . .    NUMB  0001H  NOT USED  
CALIB. . . . . . . . . . . . . .  C ADDR  0096H  NOT USED  
CALIBEND . . . . . . . . . . . .  C ADDR  00ADH  
CALIBLOOP. . . . . . . . . . . .  C ADDR  00A5H  
CANGO. . . . . . . . . . . . . .  B ADDR  0038H  NOT USED  
CTRLREG. . . . . . . . . . . . .  D ADDR  0027H  
D3_MB1C. . . . . . . . . . . . .  C ADDR  03C1H  
D4_MB1C. . . . . . . . . . . . .  C ADDR  0460H  
DOORCLSD . . . . . . . . . . . .  B ADDR  0045H  NOT USED  
DOORCLSDOLD. . . . . . . . . . .  B ADDR  0039H  NOT USED  
DOWN . . . . . . . . . . . . . .  B ADDR  0021H  
DOWN2. . . . . . . . . . . . . .  C ADDR  022DH  
DOWN2_MB1. . . . . . . . . . . .  C ADDR  027BH  
DOWN2_MB2. . . . . . . . . . . .  C ADDR  0259H  
DOWN3. . . . . . . . . . . . . .  C ADDR  035DH  
DOWN3_MB1. . . . . . . . . . . .  C ADDR  03ABH  
DOWN3_MB2. . . . . . . . . . . .  C ADDR  0389H  
DOWN4. . . . . . . . . . . . . .  C ADDR  03FCH  
VYTAH/ORI                                                                                                     PAGE 20

DOWN4_MB1. . . . . . . . . . . .  C ADDR  044AH  
DOWN4_MB2. . . . . . . . . . . .  C ADDR  0428H  
DOWNOLD. . . . . . . . . . . . .  B ADDR  003BH  
DP . . . . . . . . . . . . . . .  B ADDR  000DH  NOT USED  
DPK. . . . . . . . . . . . . . .  B ADDR  000FH  NOT USED  
DPZK . . . . . . . . . . . . . .  B ADDR  000EH  NOT USED  
ENDPROG. . . . . . . . . . . . .  C ADDR  04B8H  NOT USED  
ERR_1SPOM_C. . . . . . . . . . .  C ADDR  046DH  NOT USED  
ERR_2SPOM_C. . . . . . . . . . .  C ADDR  047CH  NOT USED  
ERR_SKRD . . . . . . . . . . . .  C ADDR  049AH  
ERR_SKRH . . . . . . . . . . . .  C ADDR  04A9H  
ERR_ZAST_C . . . . . . . . . . .  C ADDR  048BH  NOT USED  
EX1. . . . . . . . . . . . . . .  B ADDR  00AAH  PREDEFINED  
F1S. . . . . . . . . . . . . . .  C ADDR  00D3H  
F2 . . . . . . . . . . . . . . .  C ADDR  019DH  
F2DOWN . . . . . . . . . . . . .  C ADDR  01AFH  
F2OK . . . . . . . . . . . . . .  C ADDR  017EH  
F2S. . . . . . . . . . . . . . .  C ADDR  0170H  
F2UP . . . . . . . . . . . . . .  C ADDR  01A3H  
F3 . . . . . . . . . . . . . . .  C ADDR  02D6H  
F3DOWN . . . . . . . . . . . . .  C ADDR  02E8H  
F3OK . . . . . . . . . . . . . .  C ADDR  02B7H  
F3S. . . . . . . . . . . . . . .  C ADDR  02A9H  
F3UP . . . . . . . . . . . . . .  C ADDR  02DCH  
F4S. . . . . . . . . . . . . . .  C ADDR  03E2H  
FAST . . . . . . . . . . . . . .  B ADDR  0022H  
FASTOLD. . . . . . . . . . . . .  B ADDR  003CH  NOT USED  
FLED1. . . . . . . . . . . . . .  B ADDR  0024H  
FLED2. . . . . . . . . . . . . .  B ADDR  0025H  
FLED3. . . . . . . . . . . . . .  B ADDR  0026H  
FLED4. . . . . . . . . . . . . .  B ADDR  0027H  
FLOOR1 . . . . . . . . . . . . .  C ADDR  00BFH  
FLOOR2 . . . . . . . . . . . . .  C ADDR  015CH  
FLOOR3 . . . . . . . . . . . . .  C ADDR  0295H  
FLOOR4 . . . . . . . . . . . . .  C ADDR  03CEH  
FLOORREQ . . . . . . . . . . . .  D ADDR  0036H  
HIGHEST. . . . . . . . . . . . .  D ADDR  0032H  NOT USED  
I8255INA . . . . . . . . . . . .    NUMB  0080H  
I8255INB . . . . . . . . . . . .    NUMB  0081H  
I8255INC . . . . . . . . . . . .    NUMB  0082H  
I8255INCW. . . . . . . . . . . .    NUMB  0083H  
I8255OUTA. . . . . . . . . . . .    NUMB  00C0H  
I8255OUTB. . . . . . . . . . . .    NUMB  00C1H  
I8255OUTC. . . . . . . . . . . .    NUMB  00C2H  
I8255OUTCW . . . . . . . . . . .    NUMB  00C3H  
INPORTA. . . . . . . . . . . . .  D ADDR  0028H  
INPORTB. . . . . . . . . . . . .  D ADDR  0021H  
INPORTBOLD . . . . . . . . . . .  D ADDR  0026H  
INPORTC. . . . . . . . . . . . .  D ADDR  0022H  
KS . . . . . . . . . . . . . . .  B ADDR  0018H  
LEDD . . . . . . . . . . . . . .  B ADDR  002EH  
LEDU . . . . . . . . . . . . . .  B ADDR  002FH  
LOWEST . . . . . . . . . . . . .  D ADDR  0031H  NOT USED  
MAIN . . . . . . . . . . . . . .  C ADDR  00BFH  NOT USED  
MB1. . . . . . . . . . . . . . .  B ADDR  0009H  
MB1OLD . . . . . . . . . . . . .  B ADDR  0031H  NOT USED  
MB2. . . . . . . . . . . . . . .  B ADDR  000AH  
MB2OLD . . . . . . . . . . . . .  B ADDR  0032H  NOT USED  
VYTAH/ORI                                                                                                     PAGE 21

OUTPORTA . . . . . . . . . . . .  D ADDR  0023H  
OUTPORTB . . . . . . . . . . . .  D ADDR  0024H  
OUTPORTBOLD. . . . . . . . . . .  D ADDR  0034H  NOT USED  
OUTPORTC . . . . . . . . . . . .  D ADDR  0025H  
P0 . . . . . . . . . . . . . . .  D ADDR  0080H  PREDEFINED  
P2 . . . . . . . . . . . . . . .  D ADDR  00A0H  PREDEFINED  
P3 . . . . . . . . . . . . . . .  D ADDR  00B0H  PREDEFINED  
PI1. . . . . . . . . . . . . . .  B ADDR  0010H  NOT USED  
PI2D . . . . . . . . . . . . . .  B ADDR  0011H  NOT USED  
PI2U . . . . . . . . . . . . . .  B ADDR  0012H  NOT USED  
PI3D . . . . . . . . . . . . . .  B ADDR  0013H  
PI3U . . . . . . . . . . . . . .  B ADDR  0014H  NOT USED  
PI4. . . . . . . . . . . . . . .  B ADDR  0015H  NOT USED  
PKI1 . . . . . . . . . . . . . .  B ADDR  0041H  NOT USED  
PKI2 . . . . . . . . . . . . . .  B ADDR  0042H  NOT USED  
PKI3 . . . . . . . . . . . . . .  B ADDR  0043H  NOT USED  
PKI4 . . . . . . . . . . . . . .  B ADDR  0044H  NOT USED  
PKO1 . . . . . . . . . . . . . .  B ADDR  0019H  
PKO2 . . . . . . . . . . . . . .  B ADDR  001AH  
PKO3 . . . . . . . . . . . . . .  B ADDR  001BH  
PKO4 . . . . . . . . . . . . . .  B ADDR  001CH  
PO1. . . . . . . . . . . . . . .  B ADDR  0028H  NOT USED  
PO2D . . . . . . . . . . . . . .  B ADDR  0029H  NOT USED  
PO2U . . . . . . . . . . . . . .  B ADDR  002AH  NOT USED  
PO3D . . . . . . . . . . . . . .  B ADDR  002BH  NOT USED  
PO3U . . . . . . . . . . . . . .  B ADDR  002CH  
PO4. . . . . . . . . . . . . . .  B ADDR  002DH  NOT USED  
POSITION . . . . . . . . . . . .  D ADDR  0030H  NOT USED  
RDNOT. . . . . . . . . . . . . .  B ADDR  00B7H  
READPORTS. . . . . . . . . . . .  C ADDR  04D5H  
RESET. . . . . . . . . . . . . .  C ADDR  0033H  NOT USED  
SKRD . . . . . . . . . . . . . .  B ADDR  000CH  
SKRDOLD. . . . . . . . . . . . .  B ADDR  0034H  NOT USED  
SKRH . . . . . . . . . . . . . .  B ADDR  000BH  
SKRHOLD. . . . . . . . . . . . .  B ADDR  0033H  NOT USED  
SLOW . . . . . . . . . . . . . .  B ADDR  0023H  
SLOWOLD. . . . . . . . . . . . .  B ADDR  003DH  NOT USED  
SP . . . . . . . . . . . . . . .  D ADDR  0081H  PREDEFINED  
STACK. . . . . . . . . . . . . .  D ADDR  0040H  
START. . . . . . . . . . . . . .  C ADDR  0033H  
STOPNOT. . . . . . . . . . . . .  B ADDR  0040H  NOT USED  
STOPTIMER. . . . . . . . . . . .  D ADDR  0033H  
STR_CALIB. . . . . . . . . . . .  C ADDR  05B5H  NOT USED  
STR_INIT . . . . . . . . . . . .  C ADDR  054DH  NOT USED  
STR_STOP . . . . . . . . . . . .  C ADDR  0574H  NOT USED  
TIMERCONST . . . . . . . . . . .    NUMB  00FAH  NOT USED  
U2_MB1C. . . . . . . . . . . . .  C ADDR  021FH  
UP . . . . . . . . . . . . . . .  B ADDR  0020H  
UP1. . . . . . . . . . . . . . .  C ADDR  00EDH  
UP1A . . . . . . . . . . . . . .  C ADDR  00FEH  
UP1_MB1. . . . . . . . . . . . .  C ADDR  013BH  
UP1_MB2. . . . . . . . . . . . .  C ADDR  0119H  
UP2. . . . . . . . . . . . . . .  C ADDR  01BBH  
UP2A . . . . . . . . . . . . . .  C ADDR  01CCH  
UP2_MB1. . . . . . . . . . . . .  C ADDR  0209H  
UP2_MB2. . . . . . . . . . . . .  C ADDR  01E7H  
UP3. . . . . . . . . . . . . . .  C ADDR  02F4H  
UP3A . . . . . . . . . . . . . .  C ADDR  0305H  
VYTAH/ORI                                                                                                     PAGE 22

UP3_MB1. . . . . . . . . . . . .  C ADDR  0342H  
UP3_MB2. . . . . . . . . . . . .  C ADDR  0320H  
UPOLD. . . . . . . . . . . . . .  B ADDR  003AH  
WAIT . . . . . . . . . . . . . .  C ADDR  04C9H  NOT USED  
WAITFORTIMER . . . . . . . . . .  C ADDR  04C4H  
WRITEPORTS . . . . . . . . . . .  C ADDR  051AH  
WRNOT. . . . . . . . . . . . . .  B ADDR  00B6H  
